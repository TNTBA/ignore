Differences in kiauh.sh:

- Lines with differences: 95 lines in 4 blocks

Detailed Differences:

--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/kiauh/kiauh.sh	2023-12-15 01:08:34.841257048 -0500
+++ /home/mks/firmware_comparison/downloads/kiauh/kiauh.sh	2024-10-08 17:45:33.575241837 -0400
@@ -1,7 +1,7 @@
 #!/usr/bin/env bash
 
 #=======================================================================#
-# Copyright (C) 2020 - 2023 Dominik Willner <th33xitus@gmail.com>       #
+# Copyright (C) 2020 - 2024 Dominik Willner <th33xitus@gmail.com>       #
 #                                                                       #
 # This file is part of KIAUH - Klipper Installation And Update Helper   #
 # https://github.com/dw-0/kiauh                                         #
@@ -12,6 +12,9 @@
 set -e
 clear
 
+# make sure we have the correct permissions while running the script
+umask 022
+
 ### sourcing all additional scripts
 KIAUH_SRCDIR="$(dirname -- "$(readlink -f "${BASH_SOURCE[0]}")")"
 for script in "${KIAUH_SRCDIR}/scripts/"*.sh; do . "${script}"; done
@@ -54,6 +57,15 @@
   fi
 }
 
+function save_startup_version() {
+  local launch_version
+
+  echo "${1}"
+
+  sed -i "/^version_to_launch=/d" "${INI_FILE}"
+  sed -i '$a'"version_to_launch=${1}" "${INI_FILE}"
+}
+
 function kiauh_update_dialog() {
   [[ ! $(kiauh_update_avail) == "true" ]] && return
   top_border
@@ -70,19 +82,96 @@
   read -p "${cyan}###### Do you want to update now? (Y/n):${white} " yn
   while true; do
     case "${yn}" in
-      Y|y|Yes|yes|"")
-        do_action "update_kiauh"
-        break;;
-      N|n|No|no)
-        break;;
-      *)
-        deny_action "kiauh_update_dialog";;
+     Y|y|Yes|yes|"")
+       do_action "update_kiauh"
+       break;;
+     N|n|No|no)
+       break;;
+     *)
+       deny_action "kiauh_update_dialog";;
     esac
   done
 }
 
+function launch_kiauh_v5() {
+    main_menu
+}
+
+function launch_kiauh_v6() {
+  local entrypoint
+
+  if ! command -v python3 &>/dev/null || [[ $(python3 -V | cut -d " " -f2 | cut -d "." -f2) -lt 8 ]]; then
+    echo "Python 3.8 or higher is not installed!"
+    echo "Please install Python 3.8 or higher and try again."
+    exit 1
+  fi
+
+  entrypoint=$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")
+
+  export PYTHONPATH="${entrypoint}"
+
+  clear
+  python3 "${entrypoint}/kiauh.py"
+}
+
+function main() {
+  read_kiauh_ini "${FUNCNAME[0]}"
+
+  if [[ ${version_to_launch} -eq 5 ]]; then
+    launch_kiauh_v5
+  elif [[ ${version_to_launch} -eq 6 ]]; then
+    launch_kiauh_v6
+  else
+    top_border
+    echo -e "|         ${green}KIAUH v6.0.0-alpha1 is available now!${white}         |"
+    hr
+    echo -e "|         View Changelog: ${magenta}https://git.io/JnmlX${white}          |"
+    blank_line
+    echo -e "| KIAUH v6 was completely rewritten from the ground up. |"
+    echo -e "| It's based on Python 3.8 and has many improvements.   |"
+    blank_line
+    echo -e "| ${yellow}NOTE: Version 6 is still in alpha, so bugs may occur!${white} |"
+    echo -e "| ${yellow}Yet, your feedback and bug reports are very much${white}      |"
+    echo -e "| ${yellow}appreciated and will help finalize the release.${white}       |"
+    hr
+    echo -e "| Would you like to try out KIAUH v6?                   |"
+    echo -e "| 1) Yes                                                |"
+    echo -e "| 2) No                                                 |"
+    echo -e "| 3) Yes, remember my choice for next time              |"
+    echo -e "| 4) No, remember my choice for next time               |"
+    quit_footer
+    while true; do
+      read -p "${cyan}###### Select action:${white} " -e input
+      case "${input}" in
+        1)
+          launch_kiauh_v6
+          break;;
+        2)
+          launch_kiauh_v5
+          break;;
+        3)
+          save_startup_version 6
+          launch_kiauh_v6
+          break;;
+        4)
+          save_startup_version 5
+          launch_kiauh_v5
+          break;;
+        Q|q)
+          echo -e "${green}###### Happy printing! ######${white}"; echo
+          exit 0;;
+        *)
+          error_msg "Invalid Input!\n";;
+      esac
+    done && input=""
+  fi
+}
+
+check_if_ratos
 check_euid
 init_logfile
 set_globals
 kiauh_update_dialog
-main_menu
+read_kiauh_ini
+init_ini
+main
