diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.config /home/mks/firmware_comparison/downloads/CanBoot/.config
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.config	2023-08-14 03:02:51.420400081 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.config	1969-12-31 19:00:00.000000000 -0500
@@ -1,41 +0,0 @@
-CONFIG_LOW_LEVEL_OPTIONS=y
-# CONFIG_MACH_LPC176X is not set
-# CONFIG_MACH_STM32 is not set
-CONFIG_MACH_RP2040=y
-CONFIG_BOARD_DIRECTORY="rp2040"
-CONFIG_MCU="rp2040"
-CONFIG_CLOCK_FREQ=12000000
-CONFIG_FLASH_SIZE=0x200000
-CONFIG_FLASH_BOOT_ADDRESS=0x10000100
-CONFIG_RAM_START=0x20000000
-CONFIG_RAM_SIZE=0x42000
-CONFIG_STACK_SIZE=512
-CONFIG_FLASH_APPLICATION_ADDRESS=0x10000100
-CONFIG_FLASH_START=0x10000000
-CONFIG_LAUNCH_APP_ADDRESS=0x10004000
-CONFIG_BLOCK_SIZE=64
-CONFIG_RP2040_SELECT=y
-CONFIG_RP2040_ADD_BOOT_SIGNATURE=y
-CONFIG_RP2040_FLASH_W25Q080=y
-# CONFIG_RP2040_FLASH_GENERIC_03 is not set
-CONFIG_RP2040_STAGE2_FILE="boot2_w25q080.S"
-CONFIG_RP2040_STAGE2_CLKDIV=2
-CONFIG_RP2040_FLASH_START_0000=y
-# CONFIG_RP2040_FLASH_START_4000 is not set
-# CONFIG_RP2040_USB is not set
-# CONFIG_RP2040_SERIAL_UART0 is not set
-CONFIG_RP2040_CANBUS=y
-CONFIG_RP2040_CANBUS_GPIO_RX=8
-CONFIG_RP2040_CANBUS_GPIO_TX=9
-CONFIG_USB_VENDOR_ID=0x1d50
-CONFIG_USB_DEVICE_ID=0x6177
-CONFIG_USB_SERIAL_NUMBER="12345"
-CONFIG_CANSERIAL=y
-CONFIG_CANBUS=y
-CONFIG_CANBUS_FREQUENCY=500000
-CONFIG_CANBUS_FILTER=y
-CONFIG_INITIAL_PINS=""
-CONFIG_ENABLE_DOUBLE_RESET=y
-# CONFIG_ENABLE_BUTTON is not set
-# CONFIG_ENABLE_LED is not set
-CONFIG_HAVE_CHIPID=y
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.config.old /home/mks/firmware_comparison/downloads/CanBoot/.config.old
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.config.old	2023-08-14 02:07:13.153879875 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.config.old	1969-12-31 19:00:00.000000000 -0500
@@ -1,76 +0,0 @@
-CONFIG_LOW_LEVEL_OPTIONS=y
-# CONFIG_MACH_LPC176X is not set
-CONFIG_MACH_STM32=y
-# CONFIG_MACH_RP2040 is not set
-CONFIG_BOARD_DIRECTORY="stm32"
-CONFIG_MCU="stm32g0b1xx"
-CONFIG_CLOCK_FREQ=64000000
-CONFIG_FLASH_SIZE=0x20000
-CONFIG_FLASH_BOOT_ADDRESS=0x8000000
-CONFIG_RAM_START=0x20000000
-CONFIG_RAM_SIZE=0x24000
-CONFIG_STACK_SIZE=512
-CONFIG_FLASH_APPLICATION_ADDRESS=0x8000000
-CONFIG_FLASH_START=0x8000000
-CONFIG_LAUNCH_APP_ADDRESS=0x8002000
-CONFIG_BLOCK_SIZE=64
-CONFIG_STM32_SELECT=y
-# CONFIG_MACH_STM32F103 is not set
-# CONFIG_MACH_STM32F207 is not set
-# CONFIG_MACH_STM32F401 is not set
-# CONFIG_MACH_STM32F405 is not set
-# CONFIG_MACH_STM32F407 is not set
-# CONFIG_MACH_STM32F429 is not set
-# CONFIG_MACH_STM32F446 is not set
-# CONFIG_MACH_STM32F031 is not set
-# CONFIG_MACH_STM32F042 is not set
-# CONFIG_MACH_STM32F070 is not set
-# CONFIG_MACH_STM32F072 is not set
-# CONFIG_MACH_STM32G0B0 is not set
-CONFIG_MACH_STM32G0B1=y
-# CONFIG_MACH_STM32H723 is not set
-# CONFIG_MACH_STM32H743 is not set
-CONFIG_MACH_STM32G0=y
-CONFIG_MACH_STM32G0Bx=y
-CONFIG_HAVE_STM32_USBFS=y
-CONFIG_HAVE_STM32_FDCANBUS=y
-CONFIG_STM32_DFU_ROM_ADDRESS=0
-CONFIG_STM32_FLASH_START_0000=y
-# CONFIG_STM32_FLASH_START_2000 is not set
-CONFIG_STM32_CLOCK_REF_8M=y
-# CONFIG_STM32_CLOCK_REF_12M is not set
-# CONFIG_STM32_CLOCK_REF_16M is not set
-# CONFIG_STM32_CLOCK_REF_20M is not set
-# CONFIG_STM32_CLOCK_REF_25M is not set
-# CONFIG_STM32_CLOCK_REF_INTERNAL is not set
-CONFIG_CLOCK_REF_FREQ=8000000
-CONFIG_STM32F0_TRIM=16
-# CONFIG_STM32_USB_PA11_PA12 is not set
-# CONFIG_STM32_SERIAL_USART1 is not set
-# CONFIG_STM32_SERIAL_USART1_ALT_PB7_PB6 is not set
-# CONFIG_STM32_SERIAL_USART2 is not set
-# CONFIG_STM32_SERIAL_USART2_ALT_PD6_PD5 is not set
-# CONFIG_STM32_SERIAL_USART3 is not set
-# CONFIG_STM32_SERIAL_USART3_ALT_PD9_PD8 is not set
-# CONFIG_STM32_CANBUS_PA11_PA12 is not set
-# CONFIG_STM32_CANBUS_PA11_PB9 is not set
-CONFIG_STM32_MMENU_CANBUS_PB8_PB9=y
-# CONFIG_STM32_MMENU_CANBUS_PD0_PD1 is not set
-# CONFIG_STM32_MMENU_CANBUS_PB0_PB1 is not set
-# CONFIG_STM32_MMENU_CANBUS_PD12_PD13 is not set
-# CONFIG_STM32_MMENU_CANBUS_PC2_PC3 is not set
-CONFIG_STM32_CANBUS_PB8_PB9=y
-CONFIG_STM32_APP_START_2000=y
-# CONFIG_STM32_APP_START_1000 is not set
-CONFIG_USB_VENDOR_ID=0x1d50
-CONFIG_USB_DEVICE_ID=0x6177
-CONFIG_USB_SERIAL_NUMBER="12345"
-CONFIG_CANSERIAL=y
-CONFIG_CANBUS=y
-CONFIG_CANBUS_FREQUENCY=500000
-CONFIG_CANBUS_FILTER=y
-CONFIG_INITIAL_PINS=""
-CONFIG_ENABLE_DOUBLE_RESET=y
-# CONFIG_ENABLE_BUTTON is not set
-# CONFIG_ENABLE_LED is not set
-CONFIG_HAVE_CHIPID=y
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/config /home/mks/firmware_comparison/downloads/CanBoot/.git/config
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/config	2023-08-12 06:18:50.824709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/config	2024-10-08 17:45:28.433223126 -0400
@@ -4,7 +4,7 @@
 	bare = false
 	logallrefupdates = true
 [remote "origin"]
-	url = https://github.com/Arksine/CanBoot
+	url = https://github.com/Arksine/CanBoot.git
 	fetch = +refs/heads/*:refs/remotes/origin/*
 [branch "master"]
 	remote = origin
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/fsmonitor-watchman.sample /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/fsmonitor-watchman.sample
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/fsmonitor-watchman.sample	2023-08-12 06:18:34.884709102 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/fsmonitor-watchman.sample	2024-10-08 17:45:27.195218593 -0400
@@ -8,107 +8,166 @@
 # (https://facebook.github.io/watchman/) with git to speed up detecting
 # new and modified files.
 #
-# The hook is passed a version (currently 1) and a time in nanoseconds
-# formatted as a string and outputs to stdout all files that have been
-# modified since the given time. Paths must be relative to the root of
-# the working tree and separated by a single NUL.
+# The hook is passed a version (currently 2) and last update token
+# formatted as a string and outputs to stdout a new update token and
+# all files that have been modified since the update token. Paths must
+# be relative to the root of the working tree and separated by a single NUL.
 #
 # To enable this hook, rename this file to "query-watchman" and set
 # 'git config core.fsmonitor .git/hooks/query-watchman'
 #
-my ($version, $time) = @ARGV;
+my ($version, $last_update_token) = @ARGV;
 
-# Check the hook interface version
+# Uncomment for debugging
+# print STDERR "$0 $version $last_update_token\n";
 
-if ($version == 1) {
-	# convert nanoseconds to seconds
-	$time = int $time / 1000000000;
-} else {
+# Check the hook interface version
+if ($version ne 2) {
 	die "Unsupported query-fsmonitor hook version '$version'.\n" .
 	    "Falling back to scanning...\n";
 }
 
-my $git_work_tree;
-if ($^O =~ 'msys' || $^O =~ 'cygwin') {
-	$git_work_tree = Win32::GetCwd();
-	$git_work_tree =~ tr/\\/\//;
-} else {
-	require Cwd;
-	$git_work_tree = Cwd::cwd();
-}
+my $git_work_tree = get_working_dir();
 
 my $retry = 1;
 
+my $json_pkg;
+eval {
+	require JSON::XS;
+	$json_pkg = "JSON::XS";
+	1;
+} or do {
+	require JSON::PP;
+	$json_pkg = "JSON::PP";
+};
+
 launch_watchman();
 
 sub launch_watchman {
+	my $o = watchman_query();
+	if (is_work_tree_watched($o)) {
+		output_result($o->{clock}, @{$o->{files}});
+	}
+}
+
+sub output_result {
+	my ($clockid, @files) = @_;
+
+	# Uncomment for debugging watchman output
+	# open (my $fh, ">", ".git/watchman-output.out");
+	# binmode $fh, ":utf8";
+	# print $fh "$clockid\n@files\n";
+	# close $fh;
 
+	binmode STDOUT, ":utf8";
+	print $clockid;
+	print "\0";
+	local $, = "\0";
+	print @files;
+}
+
+sub watchman_clock {
+	my $response = qx/watchman clock "$git_work_tree"/;
+	die "Failed to get clock id on '$git_work_tree'.\n" .
+		"Falling back to scanning...\n" if $? != 0;
+
+	return $json_pkg->new->utf8->decode($response);
+}
+
+sub watchman_query {
 	my $pid = open2(\*CHLD_OUT, \*CHLD_IN, 'watchman -j --no-pretty')
-	    or die "open2() failed: $!\n" .
-	    "Falling back to scanning...\n";
+	or die "open2() failed: $!\n" .
+	"Falling back to scanning...\n";
 
 	# In the query expression below we're asking for names of files that
-	# changed since $time but were not transient (ie created after
-	# $time but no longer exist).
+	# changed since $last_update_token but not from the .git folder.
 	#
 	# To accomplish this, we're using the "since" generator to use the
 	# recency index to select candidate nodes and "fields" to limit the
 	# output to file names only. Then we're using the "expression" term to
 	# further constrain the results.
-	#
-	# The category of transient files that we want to ignore will have a
-	# creation clock (cclock) newer than $time_t value and will also not
-	# currently exist.
-
+	if (substr($last_update_token, 0, 1) eq "c") {
+		$last_update_token = "\"$last_update_token\"";
+	}
 	my $query = <<"	END";
 		["query", "$git_work_tree", {
-			"since": $time,
+			"since": $last_update_token,
 			"fields": ["name"],
-			"expression": ["not", ["allof", ["since", $time, "cclock"], ["not", "exists"]]]
+			"expression": ["not", ["dirname", ".git"]]
 		}]
 	END
 
+	# Uncomment for debugging the watchman query
+	# open (my $fh, ">", ".git/watchman-query.json");
+	# print $fh $query;
+	# close $fh;
+
 	print CHLD_IN $query;
 	close CHLD_IN;
 	my $response = do {local $/; <CHLD_OUT>};
 
+	# Uncomment for debugging the watch response
+	# open ($fh, ">", ".git/watchman-response.json");
+	# print $fh $response;
+	# close $fh;
+
 	die "Watchman: command returned no output.\n" .
-	    "Falling back to scanning...\n" if $response eq "";
+	"Falling back to scanning...\n" if $response eq "";
 	die "Watchman: command returned invalid output: $response\n" .
-	    "Falling back to scanning...\n" unless $response =~ /^\{/;
-
-	my $json_pkg;
-	eval {
-		require JSON::XS;
-		$json_pkg = "JSON::XS";
-		1;
-	} or do {
-		require JSON::PP;
-		$json_pkg = "JSON::PP";
-	};
+	"Falling back to scanning...\n" unless $response =~ /^\{/;
 
-	my $o = $json_pkg->new->utf8->decode($response);
+	return $json_pkg->new->utf8->decode($response);
+}
 
-	if ($retry > 0 and $o->{error} and $o->{error} =~ m/unable to resolve root .* directory (.*) is not watched/) {
-		print STDERR "Adding '$git_work_tree' to watchman's watch list.\n";
+sub is_work_tree_watched {
+	my ($output) = @_;
+	my $error = $output->{error};
+	if ($retry > 0 and $error and $error =~ m/unable to resolve root .* directory (.*) is not watched/) {
 		$retry--;
-		qx/watchman watch "$git_work_tree"/;
+		my $response = qx/watchman watch "$git_work_tree"/;
 		die "Failed to make watchman watch '$git_work_tree'.\n" .
 		    "Falling back to scanning...\n" if $? != 0;
+		$output = $json_pkg->new->utf8->decode($response);
+		$error = $output->{error};
+		die "Watchman: $error.\n" .
+		"Falling back to scanning...\n" if $error;
+
+		# Uncomment for debugging watchman output
+		# open (my $fh, ">", ".git/watchman-output.out");
+		# close $fh;
 
 		# Watchman will always return all files on the first query so
 		# return the fast "everything is dirty" flag to git and do the
 		# Watchman query just to get it over with now so we won't pay
 		# the cost in git to look up each individual file.
-		print "/\0";
+		my $o = watchman_clock();
+		$error = $output->{error};
+
+		die "Watchman: $error.\n" .
+		"Falling back to scanning...\n" if $error;
+
+		output_result($o->{clock}, ("/"));
+		$last_update_token = $o->{clock};
+
 		eval { launch_watchman() };
-		exit 0;
+		return 0;
 	}
 
-	die "Watchman: $o->{error}.\n" .
-	    "Falling back to scanning...\n" if $o->{error};
+	die "Watchman: $error.\n" .
+	"Falling back to scanning...\n" if $error;
 
-	binmode STDOUT, ":utf8";
-	local $, = "\0";
-	print @{$o->{files}};
+	return 1;
+}
+
+sub get_working_dir {
+	my $working_dir;
+	if ($^O =~ 'msys' || $^O =~ 'cygwin') {
+		$working_dir = Win32::GetCwd();
+		$working_dir =~ tr/\\/\//;
+	} else {
+		require Cwd;
+		$working_dir = Cwd::cwd();
+	}
+
+	return $working_dir;
 }
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/pre-commit.sample /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/pre-commit.sample
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/pre-commit.sample	2023-08-12 06:18:34.880709102 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/pre-commit.sample	2024-10-08 17:45:27.195218593 -0400
@@ -16,7 +16,7 @@
 fi
 
 # If you want to allow non-ASCII filenames set this variable to true.
-allownonascii=$(git config --bool hooks.allownonascii)
+allownonascii=$(git config --type=bool hooks.allownonascii)
 
 # Redirect output to stderr.
 exec 1>&2
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/pre-merge-commit.sample /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/pre-merge-commit.sample
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/pre-merge-commit.sample	1969-12-31 19:00:00.000000000 -0500
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/pre-merge-commit.sample	2024-10-08 17:45:27.195218593 -0400
@@ -0,0 +1,13 @@
+#!/bin/sh
+#
+# An example hook script to verify what is about to be committed.
+# Called by "git merge" with no arguments.  The hook should
+# exit with non-zero status after issuing an appropriate message to
+# stderr if it wants to stop the merge commit.
+#
+# To enable this hook, rename this file to "pre-merge-commit".
+
+. git-sh-setup
+test -x "$GIT_DIR/hooks/pre-commit" &&
+        exec "$GIT_DIR/hooks/pre-commit"
+:
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/pre-push.sample /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/pre-push.sample
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/pre-push.sample	2023-08-12 06:18:34.880709102 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/pre-push.sample	2024-10-08 17:45:27.195218593 -0400
@@ -14,7 +14,7 @@
 # Information about the commits which are being pushed is supplied as lines to
 # the standard input in the form:
 #
-#   <local ref> <local sha1> <remote ref> <remote sha1>
+#   <local ref> <local oid> <remote ref> <remote oid>
 #
 # This sample shows how to prevent push of commits where the log message starts
 # with "WIP" (work in progress).
@@ -22,27 +22,27 @@
 remote="$1"
 url="$2"
 
-z40=0000000000000000000000000000000000000000
+zero=$(git hash-object --stdin </dev/null | tr '[0-9a-f]' '0')
 
-while read local_ref local_sha remote_ref remote_sha
+while read local_ref local_oid remote_ref remote_oid
 do
-	if [ "$local_sha" = $z40 ]
+	if test "$local_oid" = "$zero"
 	then
 		# Handle delete
 		:
 	else
-		if [ "$remote_sha" = $z40 ]
+		if test "$remote_oid" = "$zero"
 		then
 			# New branch, examine all commits
-			range="$local_sha"
+			range="$local_oid"
 		else
 			# Update to existing branch, examine new commits
-			range="$remote_sha..$local_sha"
+			range="$remote_oid..$local_oid"
 		fi
 
 		# Check for WIP commit
-		commit=`git rev-list -n 1 --grep '^WIP' "$range"`
-		if [ -n "$commit" ]
+		commit=$(git rev-list -n 1 --grep '^WIP' "$range")
+		if test -n "$commit"
 		then
 			echo >&2 "Found WIP commit in $local_ref, not pushing"
 			exit 1
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/push-to-checkout.sample /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/push-to-checkout.sample
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/push-to-checkout.sample	1969-12-31 19:00:00.000000000 -0500
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/push-to-checkout.sample	2024-10-08 17:45:27.192218582 -0400
@@ -0,0 +1,78 @@
+#!/bin/sh
+
+# An example hook script to update a checked-out tree on a git push.
+#
+# This hook is invoked by git-receive-pack(1) when it reacts to git
+# push and updates reference(s) in its repository, and when the push
+# tries to update the branch that is currently checked out and the
+# receive.denyCurrentBranch configuration variable is set to
+# updateInstead.
+#
+# By default, such a push is refused if the working tree and the index
+# of the remote repository has any difference from the currently
+# checked out commit; when both the working tree and the index match
+# the current commit, they are updated to match the newly pushed tip
+# of the branch. This hook is to be used to override the default
+# behaviour; however the code below reimplements the default behaviour
+# as a starting point for convenient modification.
+#
+# The hook receives the commit with which the tip of the current
+# branch is going to be updated:
+commit=$1
+
+# It can exit with a non-zero status to refuse the push (when it does
+# so, it must not modify the index or the working tree).
+die () {
+	echo >&2 "$*"
+	exit 1
+}
+
+# Or it can make any necessary changes to the working tree and to the
+# index to bring them to the desired state when the tip of the current
+# branch is updated to the new commit, and exit with a zero status.
+#
+# For example, the hook can simply run git read-tree -u -m HEAD "$1"
+# in order to emulate git fetch that is run in the reverse direction
+# with git push, as the two-tree form of git read-tree -u -m is
+# essentially the same as git switch or git checkout that switches
+# branches while keeping the local changes in the working tree that do
+# not interfere with the difference between the branches.
+
+# The below is a more-or-less exact translation to shell of the C code
+# for the default behaviour for git's push-to-checkout hook defined in
+# the push_to_deploy() function in builtin/receive-pack.c.
+#
+# Note that the hook will be executed from the repository directory,
+# not from the working tree, so if you want to perform operations on
+# the working tree, you will have to adapt your code accordingly, e.g.
+# by adding "cd .." or using relative paths.
+
+if ! git update-index -q --ignore-submodules --refresh
+then
+	die "Up-to-date check failed"
+fi
+
+if ! git diff-files --quiet --ignore-submodules --
+then
+	die "Working directory has unstaged changes"
+fi
+
+# This is a rough translation of:
+#
+#   head_has_history() ? "HEAD" : EMPTY_TREE_SHA1_HEX
+if git cat-file -e HEAD 2>/dev/null
+then
+	head=HEAD
+else
+	head=$(git hash-object -t tree --stdin </dev/null)
+fi
+
+if ! git diff-index --quiet --cached --ignore-submodules $head --
+then
+	die "Working directory has staged changes"
+fi
+
+if ! git read-tree -u -m "$commit"
+then
+	die "Could not update working tree to new HEAD"
+fi
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/update.sample /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/update.sample
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/hooks/update.sample	2023-08-12 06:18:34.884709102 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/hooks/update.sample	2024-10-08 17:45:27.195218593 -0400
@@ -43,11 +43,11 @@
 fi
 
 # --- Config
-allowunannotated=$(git config --bool hooks.allowunannotated)
-allowdeletebranch=$(git config --bool hooks.allowdeletebranch)
-denycreatebranch=$(git config --bool hooks.denycreatebranch)
-allowdeletetag=$(git config --bool hooks.allowdeletetag)
-allowmodifytag=$(git config --bool hooks.allowmodifytag)
+allowunannotated=$(git config --type=bool hooks.allowunannotated)
+allowdeletebranch=$(git config --type=bool hooks.allowdeletebranch)
+denycreatebranch=$(git config --type=bool hooks.denycreatebranch)
+allowdeletetag=$(git config --type=bool hooks.allowdeletetag)
+allowmodifytag=$(git config --type=bool hooks.allowmodifytag)
 
 # check for no description
 projectdesc=$(sed -e '1q' "$GIT_DIR/description")
@@ -60,7 +60,7 @@
 
 # --- Check types
 # if $newrev is 0000...0000, it's a commit to delete a ref.
-zero="0000000000000000000000000000000000000000"
+zero=$(git hash-object --stdin </dev/null | tr '[0-9a-f]' '0')
 if [ "$newrev" = "$zero" ]; then
 	newrev_type=delete
 else
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/index and /home/mks/firmware_comparison/downloads/CanBoot/.git/index differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/logs/HEAD /home/mks/firmware_comparison/downloads/CanBoot/.git/logs/HEAD
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/logs/HEAD	2023-08-12 06:18:50.824709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/logs/HEAD	2024-10-08 17:45:28.431223118 -0400
@@ -1 +1 @@
-0000000000000000000000000000000000000000 abd154526ded2f895028b2fd06ccf79476b9bc22 Mks <mks@mkspi.(none)> 1691835530 +0800	clone: from https://github.com/Arksine/CanBoot
+0000000000000000000000000000000000000000 90eb71b610669aaaab5ed3705c5b6361ac50dbb6 mks <mks@arm2.myguest.virtualbox.org> 1728423928 -0400	clone: from https://github.com/Arksine/CanBoot.git
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/logs/refs/heads/master /home/mks/firmware_comparison/downloads/CanBoot/.git/logs/refs/heads/master
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/logs/refs/heads/master	2023-08-12 06:18:50.824709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/logs/refs/heads/master	2024-10-08 17:45:28.431223118 -0400
@@ -1 +1 @@
-0000000000000000000000000000000000000000 abd154526ded2f895028b2fd06ccf79476b9bc22 Mks <mks@mkspi.(none)> 1691835530 +0800	clone: from https://github.com/Arksine/CanBoot
+0000000000000000000000000000000000000000 90eb71b610669aaaab5ed3705c5b6361ac50dbb6 mks <mks@arm2.myguest.virtualbox.org> 1728423928 -0400	clone: from https://github.com/Arksine/CanBoot.git
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/logs/refs/remotes/origin/HEAD /home/mks/firmware_comparison/downloads/CanBoot/.git/logs/refs/remotes/origin/HEAD
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/logs/refs/remotes/origin/HEAD	2023-08-12 06:18:50.820709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/logs/refs/remotes/origin/HEAD	2024-10-08 17:45:28.431223118 -0400
@@ -1 +1 @@
-0000000000000000000000000000000000000000 abd154526ded2f895028b2fd06ccf79476b9bc22 Mks <mks@mkspi.(none)> 1691835530 +0800	clone: from https://github.com/Arksine/CanBoot
+0000000000000000000000000000000000000000 90eb71b610669aaaab5ed3705c5b6361ac50dbb6 mks <mks@arm2.myguest.virtualbox.org> 1728423928 -0400	clone: from https://github.com/Arksine/CanBoot.git
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/objects/pack/pack-28b2ffa603ed501f797998839bb1cee6e10ff239.idx and /home/mks/firmware_comparison/downloads/CanBoot/.git/objects/pack/pack-28b2ffa603ed501f797998839bb1cee6e10ff239.idx differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/objects/pack/pack-28b2ffa603ed501f797998839bb1cee6e10ff239.pack and /home/mks/firmware_comparison/downloads/CanBoot/.git/objects/pack/pack-28b2ffa603ed501f797998839bb1cee6e10ff239.pack differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/objects/pack/pack-3ce652779705ebb3e829349d3c65c29dc91f1104.idx and /home/mks/firmware_comparison/downloads/CanBoot/.git/objects/pack/pack-3ce652779705ebb3e829349d3c65c29dc91f1104.idx differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/objects/pack/pack-3ce652779705ebb3e829349d3c65c29dc91f1104.pack and /home/mks/firmware_comparison/downloads/CanBoot/.git/objects/pack/pack-3ce652779705ebb3e829349d3c65c29dc91f1104.pack differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/packed-refs /home/mks/firmware_comparison/downloads/CanBoot/.git/packed-refs
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/packed-refs	2023-08-12 06:18:50.816709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/packed-refs	2024-10-08 17:45:28.431223118 -0400
@@ -1,6 +1,6 @@
 # pack-refs with: peeled fully-peeled sorted 
 af17448539a2f3667473a8e957f9c7d46350c812 refs/remotes/origin/dev-canbus-updates-20220629
-2df22db77beeb2ddbc99d0f7627901a9b3ee1996 refs/remotes/origin/dev-sdcard-20220519
-abd154526ded2f895028b2fd06ccf79476b9bc22 refs/remotes/origin/master
+eaeb783e65b1cf2268c26d55d2aeee9c2b589f86 refs/remotes/origin/dev-sdcard-20220519
+90eb71b610669aaaab5ed3705c5b6361ac50dbb6 refs/remotes/origin/master
 d2545b00f16ba6c6a7a169c4bdb44d1a8a6163b4 refs/tags/v0.0.1
 ^555e0e5631851a98da6b1b174c46488790e594fc
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/refs/heads/master /home/mks/firmware_comparison/downloads/CanBoot/.git/refs/heads/master
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/.git/refs/heads/master	2023-08-12 06:18:50.824709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/.git/refs/heads/master	2024-10-08 17:45:28.431223118 -0400
@@ -1 +1 @@
-abd154526ded2f895028b2fd06ccf79476b9bc22
+90eb71b610669aaaab5ed3705c5b6361ac50dbb6
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/Makefile /home/mks/firmware_comparison/downloads/CanBoot/Makefile
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/Makefile	2023-08-12 06:18:50.848709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/Makefile	2024-10-08 17:45:28.434223129 -0400
@@ -30,10 +30,10 @@
 cc-option=$(shell if test -z "`$(1) $(2) -S -o /dev/null -xc /dev/null 2>&1`" \
     ; then echo "$(2)"; else echo "$(3)"; fi ;)
 
-CFLAGS := -I$(OUT) -Isrc -I$(OUT)board-generic/ -std=gnu11 -Os -MD \
+CFLAGS := -iquote $(OUT) -iquote src -iquote $(OUT)board-generic/ -std=gnu11 -Os -MD \
     -Wall -Wold-style-definition $(call cc-option,$(CC),-Wtype-limits,) \
     -ffunction-sections -fdata-sections -fno-delete-null-pointer-checks
-CFLAGS += -flto -fwhole-program -fno-use-linker-plugin -ggdb3
+CFLAGS += -flto=auto -fwhole-program -fno-use-linker-plugin -ggdb3
 
 OBJS_katapult.elf = $(patsubst %.c, $(OUT)src/%.o,$(src-y))
 OBJS_katapult.elf += $(OUT)compile_time_request.o
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/autoconf.h /home/mks/firmware_comparison/downloads/CanBoot/out/autoconf.h
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/autoconf.h	2023-08-14 03:03:06.004400088 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/autoconf.h	1969-12-31 19:00:00.000000000 -0500
@@ -1,164 +0,0 @@
-#define CONFIG_LOW_LEVEL_OPTIONS 1
-#define CONFIG_MACH_LPC176X 0
-#define CONFIG_MACH_STM32 0
-#define CONFIG_MACH_RP2040 1
-#define CONFIG_LPC_SELECT 0
-#define CONFIG_BOARD_DIRECTORY "rp2040"
-#define CONFIG_MACH_LPC1768 0
-#define CONFIG_MACH_LPC1769 0
-#define CONFIG_MCU "rp2040"
-#define CONFIG_CLOCK_FREQ 12000000
-#define CONFIG_FLASH_SIZE 0x200000
-#define CONFIG_FLASH_BOOT_ADDRESS 0x10000100
-#define CONFIG_RAM_START 0x20000000
-#define CONFIG_RAM_SIZE 0x42000
-#define CONFIG_STACK_SIZE 512
-#define CONFIG_LPC_FLASH_START_0000 0
-#define CONFIG_LPC_FLASH_START_4000 0
-#define CONFIG_FLASH_APPLICATION_ADDRESS 0x10000100
-#define CONFIG_LPC_USB 0
-#define CONFIG_LPC_SERIAL_UART0_P03_P02 0
-#define CONFIG_LPC_SERIAL_UART3_P429_P428 0
-#define CONFIG_FLASH_START 0x10000000
-#define CONFIG_LAUNCH_APP_ADDRESS 0x10004000
-#define CONFIG_BLOCK_SIZE 64
-#define CONFIG_STM32_SELECT 0
-#define CONFIG_MACH_STM32F103 0
-#define CONFIG_MACH_STM32F207 0
-#define CONFIG_MACH_STM32F401 0
-#define CONFIG_MACH_STM32F405 0
-#define CONFIG_MACH_STM32F407 0
-#define CONFIG_MACH_STM32F429 0
-#define CONFIG_MACH_STM32F446 0
-#define CONFIG_MACH_STM32F031 0
-#define CONFIG_MACH_STM32F042 0
-#define CONFIG_MACH_STM32F070 0
-#define CONFIG_MACH_STM32F072 0
-#define CONFIG_MACH_STM32G0B0 0
-#define CONFIG_MACH_STM32G0B1 0
-#define CONFIG_MACH_STM32G431 0
-#define CONFIG_MACH_STM32H723 0
-#define CONFIG_MACH_STM32H743 0
-#define CONFIG_MACH_STM32H750 0
-#define CONFIG_MACH_STM32L412 0
-#define CONFIG_MACH_STM32F103x6 0
-#define CONFIG_MACH_STM32F0 0
-#define CONFIG_MACH_STM32F1 0
-#define CONFIG_MACH_STM32F2 0
-#define CONFIG_MACH_STM32F4 0
-#define CONFIG_MACH_STM32G0 0
-#define CONFIG_MACH_STM32G0Bx 0
-#define CONFIG_MACH_STM32G4 0
-#define CONFIG_MACH_STM32H7 0
-#define CONFIG_MACH_STM32F0x2 0
-#define CONFIG_MACH_STM32F4x5 0
-#define CONFIG_MACH_STM32L4 0
-#define CONFIG_HAVE_STM32_USBFS 0
-#define CONFIG_HAVE_STM32_USBOTG 0
-#define CONFIG_HAVE_STM32_CANBUS 0
-#define CONFIG_HAVE_STM32_FDCANBUS 0
-#define CONFIG_HAVE_STM32_USBCANBUS 0
-#define CONFIG_STM32F103GD_DISABLE_SWD 0
-#define CONFIG_STM32_DFU_ROM_ADDRESS 0x
-#define CONFIG_STM32_FLASH_START_0000 0
-#define CONFIG_STM32_FLASH_START_2000 0
-#define CONFIG_STM32_FLASH_START_5000 0
-#define CONFIG_STM32_FLASH_START_7000 0
-#define CONFIG_STM32_FLASH_START_8000 0
-#define CONFIG_STM32_FLASH_START_8800 0
-#define CONFIG_STM32_FLASH_START_20200 0
-#define CONFIG_STM32_FLASH_START_C000 0
-#define CONFIG_STM32_FLASH_START_10000 0
-#define CONFIG_STM32_FLASH_START_800 0
-#define CONFIG_STM32_FLASH_START_1000 0
-#define CONFIG_STM32_FLASH_START_4000 0
-#define CONFIG_STM32_FLASH_START_20000 0
-#define CONFIG_ARMCM_RAM_VECTORTABLE 0
-#define CONFIG_STM32_CLOCK_REF_8M 0
-#define CONFIG_STM32_CLOCK_REF_12M 0
-#define CONFIG_STM32_CLOCK_REF_16M 0
-#define CONFIG_STM32_CLOCK_REF_20M 0
-#define CONFIG_STM32_CLOCK_REF_25M 0
-#define CONFIG_STM32_CLOCK_REF_INTERNAL 0
-#define CONFIG_CLOCK_REF_FREQ 0
-#define CONFIG_STM32F0_TRIM 0
-#define CONFIG_STM32_USB_PA11_PA12 0
-#define CONFIG_STM32_USB_PA11_PA12_REMAP 0
-#define CONFIG_STM32_USB_PB14_PB15 0
-#define CONFIG_STM32_SERIAL_USART1 0
-#define CONFIG_STM32_SERIAL_USART1_ALT_PB7_PB6 0
-#define CONFIG_STM32_SERIAL_USART2 0
-#define CONFIG_STM32_SERIAL_USART2_ALT_PA15_PA14 0
-#define CONFIG_STM32_SERIAL_USART2_ALT_PB4_PB3 0
-#define CONFIG_STM32_SERIAL_USART2_ALT_PD6_PD5 0
-#define CONFIG_STM32_SERIAL_USART3 0
-#define CONFIG_STM32_SERIAL_USART3_ALT_PD9_PD8 0
-#define CONFIG_STM32_SERIAL_UART4 0
-#define CONFIG_STM32_CANBUS_PA11_PA12 0
-#define CONFIG_STM32_CANBUS_PA11_PA12_REMAP 0
-#define CONFIG_STM32_CANBUS_PA11_PB9 0
-#define CONFIG_STM32_MMENU_CANBUS_PB8_PB9 0
-#define CONFIG_STM32_MMENU_CANBUS_PI9_PH13 0
-#define CONFIG_STM32_MMENU_CANBUS_PB5_PB6 0
-#define CONFIG_STM32_MMENU_CANBUS_PB12_PB13 0
-#define CONFIG_STM32_MMENU_CANBUS_PD0_PD1 0
-#define CONFIG_STM32_MMENU_CANBUS_PB0_PB1 0
-#define CONFIG_STM32_MMENU_CANBUS_PD12_PD13 0
-#define CONFIG_STM32_MMENU_CANBUS_PC2_PC3 0
-#define CONFIG_STM32_USBCANBUS_PA11_PA12 0
-#define CONFIG_STM32_CMENU_CANBUS_PB8_PB9 0
-#define CONFIG_STM32_CMENU_CANBUS_PI9_PH13 0
-#define CONFIG_STM32_CMENU_CANBUS_PB5_PB6 0
-#define CONFIG_STM32_CMENU_CANBUS_PB12_PB13 0
-#define CONFIG_STM32_CMENU_CANBUS_PD0_PD1 0
-#define CONFIG_STM32_CMENU_CANBUS_PB0_PB1 0
-#define CONFIG_STM32_CMENU_CANBUS_PD12_PD13 0
-#define CONFIG_STM32_CMENU_CANBUS_PC2_PC3 0
-#define CONFIG_STM32_CANBUS_PB8_PB9 0
-#define CONFIG_STM32_CANBUS_PI9_PH13 0
-#define CONFIG_STM32_CANBUS_PB5_PB6 0
-#define CONFIG_STM32_CANBUS_PB12_PB13 0
-#define CONFIG_STM32_CANBUS_PD0_PD1 0
-#define CONFIG_STM32_CANBUS_PB0_PB1 0
-#define CONFIG_STM32_CANBUS_PD12_PD13 0
-#define CONFIG_STM32_CANBUS_PC2_PC3 0
-#define CONFIG_STM32_APP_START_20000 0
-#define CONFIG_STM32_APP_START_8000 0
-#define CONFIG_STM32_APP_START_4000 0
-#define CONFIG_STM32_APP_START_2000 0
-#define CONFIG_STM32_APP_START_1000 0
-#define CONFIG_RP2040_SELECT 1
-#define CONFIG_RP2040_ADD_BOOT_SIGNATURE 1
-#define CONFIG_RP2040_FLASH_W25Q080 1
-#define CONFIG_RP2040_FLASH_GENERIC_03 0
-#define CONFIG_RP2040_STAGE2_FILE "boot2_w25q080.S"
-#define CONFIG_RP2040_STAGE2_CLKDIV 2
-#define CONFIG_RP2040_FLASH_START_0000 1
-#define CONFIG_RP2040_FLASH_START_4000 0
-#define CONFIG_RP2040_USB 0
-#define CONFIG_RP2040_SERIAL_UART0 0
-#define CONFIG_RP2040_CANBUS 1
-#define CONFIG_RP2040_CANBUS_GPIO_RX 8
-#define CONFIG_RP2040_CANBUS_GPIO_TX 9
-#define CONFIG_SERIAL 0
-#define CONFIG_SERIAL_BOOTLOADER_SIDECHANNEL 0
-#define CONFIG_SERIAL_BAUD 0
-#define CONFIG_USBSERIAL 0
-#define CONFIG_USBCANBUS 0
-#define CONFIG_USB 0
-#define CONFIG_USB_VENDOR_ID 0x1d50
-#define CONFIG_USB_DEVICE_ID 0x6177
-#define CONFIG_USB_SERIAL_NUMBER_CHIPID 0
-#define CONFIG_USB_SERIAL_NUMBER "12345"
-#define CONFIG_CANSERIAL 1
-#define CONFIG_CANBUS 1
-#define CONFIG_CANBUS_FREQUENCY 500000
-#define CONFIG_CANBUS_FILTER 1
-#define CONFIG_INITIAL_PINS ""
-#define CONFIG_ENABLE_DOUBLE_RESET 1
-#define CONFIG_ENABLE_BUTTON 0
-#define CONFIG_BUTTON_PIN ""
-#define CONFIG_ENABLE_LED 0
-#define CONFIG_STATUS_LED_PIN ""
-#define CONFIG_BUILD_DEPLOYER 0
-#define CONFIG_HAVE_CHIPID 1
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/board-link /home/mks/firmware_comparison/downloads/CanBoot/out/board-link
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/board-link	2023-08-14 03:03:05.492400088 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/board-link	1969-12-31 19:00:00.000000000 -0500
@@ -1 +0,0 @@
-# Makefile board-link rule
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/canboot.bin and /home/mks/firmware_comparison/downloads/CanBoot/out/canboot.bin differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/canboot.uf2 and /home/mks/firmware_comparison/downloads/CanBoot/out/canboot.uf2 differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.c /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.c	2023-08-14 03:03:14.252400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,83 +0,0 @@
-
-/* DO NOT EDIT! This is an autogenerated file. See scripts/buildcommands.py. */
-
-#include <stdint.h>
-#include "board/irq.h"
-#include "board/pgm.h"
-#include "compiler.h"
-#include "initial_pins.h"
-
-void
-ctr_run_initfuncs(void)
-{
-    extern void initial_pins_setup(void);
-    initial_pins_setup();
-    extern void can_init(void);
-    can_init();
-    extern void chipid_init(void);
-    chipid_init();
-}
-
-void
-ctr_run_taskfuncs(void)
-{
-    irq_poll();
-    extern void complete_task(void);
-    complete_task();
-    irq_poll();
-    extern void canserial_rx_task(void);
-    canserial_rx_task();
-    irq_poll();
-    extern void canserial_tx_task(void);
-    canserial_tx_task();
-    irq_poll();
-}
-
-void
-ctr_run_shutdownfuncs(void)
-{
-    extern void clear_active_irq(void);
-    clear_active_irq();
-    extern void canserial_shutdown(void);
-    canserial_shutdown();
-}
-
-const struct initial_pin_s initial_pins[] PROGMEM = {
-};
-const int initial_pins_size PROGMEM = ARRAY_SIZE(initial_pins);
-
-extern void DefaultHandler(void);
-extern uint32_t _stack_end;
-extern void ResetHandler(void);
-extern void PIOx_IRQHandler(void);
-
-const void *VectorTable[] __visible __section(".vector_table") = {
-    &_stack_end,
-    ResetHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    DefaultHandler,
-    PIOx_IRQHandler,
-};
-
-uint32_t led_gpio = 0, led_gpio_high = 0; // "None"
-
-int32_t button_gpio = 0, button_high = 0, button_pullup = 0; // ""
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.d /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.d	2023-08-14 03:03:14.392400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,8 +0,0 @@
-out/compile_time_request.o: out/compile_time_request.c \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- out/board-generic/board/irq.h out/board-generic/board/pgm.h \
- src/compiler.h src/initial_pins.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.o and /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.txt /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.txt
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/compile_time_request.txt	2023-08-14 03:03:14.032400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/compile_time_request.txt	1969-12-31 19:00:00.000000000 -0500
@@ -1,17 +0,0 @@
-DECL_BUTTON ""
-_DECL_CALLLIST ctr_run_taskfuncs complete_task
-_DECL_CALLLIST ctr_run_initfuncs initial_pins_setup
-DECL_INITIAL_PINS ""
-DECL_ARMCM_IRQ ResetHandler -0x0000000F
-DECL_CONSTANT_STR MCU rp2040
-DECL_ENUMERATION_RANGE pin gpio0 +0x00000000 +0x0000001E
-_DECL_CALLLIST ctr_run_shutdownfuncs clear_active_irq
-_DECL_CALLLIST ctr_run_initfuncs can_init
-DECL_ARMCM_IRQ PIOx_IRQHandler +0x00000007
-DECL_CONSTANT_STR RESERVE_PINS_CAN gpio8,gpio9
-_DECL_CALLLIST ctr_run_initfuncs chipid_init
-_DECL_CALLLIST ctr_run_shutdownfuncs canserial_shutdown
-_DECL_CALLLIST ctr_run_taskfuncs canserial_rx_task
-DECL_CONSTANT RECEIVE_WINDOW +0x000000C0
-_DECL_CALLLIST ctr_run_taskfuncs canserial_tx_task
-DECL_CONSTANT CANBUS_FREQUENCY +0x0007A120
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/katapult.bin and /home/mks/firmware_comparison/downloads/CanBoot/out/katapult.bin differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/katapult.elf and /home/mks/firmware_comparison/downloads/CanBoot/out/katapult.elf differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/katapult_payload.c /home/mks/firmware_comparison/downloads/CanBoot/out/katapult_payload.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/katapult_payload.c	2023-08-14 03:03:17.772400093 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/katapult_payload.c	1969-12-31 19:00:00.000000000 -0500
@@ -1,546 +0,0 @@
-
-/* DO NOT EDIT! This is an autogenerated file. See scripts/buildbinary.py. */
-
-#include <stdint.h>
-#include "deployer.h"
-
-const uint8_t deployer_canboot_binary[] = {
-    0x00,0xb5,0x32,0x4b,0x21,0x20,0x58,0x60,0x98,0x68,0x02,0x21,0x88,0x43,
-    0x98,0x60,0xd8,0x60,0x18,0x61,0x58,0x61,0x2e,0x4b,0x00,0x21,0x99,0x60,
-    0x02,0x21,0x59,0x61,0x01,0x21,0xf0,0x22,0x99,0x50,0x2b,0x49,0x19,0x60,
-    0x01,0x21,0x99,0x60,0x35,0x20,0x00,0xf0,0x44,0xf8,0x02,0x22,0x90,0x42,
-    0x14,0xd0,0x06,0x21,0x19,0x66,0x00,0xf0,0x34,0xf8,0x19,0x6e,0x01,0x21,
-    0x19,0x66,0x00,0x20,0x18,0x66,0x1a,0x66,0x00,0xf0,0x2c,0xf8,0x19,0x6e,
-    0x19,0x6e,0x19,0x6e,0x05,0x20,0x00,0xf0,0x2f,0xf8,0x01,0x21,0x08,0x42,
-    0xf9,0xd1,0x00,0x21,0x99,0x60,0x1b,0x49,0x19,0x60,0x00,0x21,0x59,0x60,
-    0x1a,0x49,0x1b,0x48,0x01,0x60,0x01,0x21,0x99,0x60,0xeb,0x21,0x19,0x66,
-    0xa0,0x21,0x19,0x66,0x00,0xf0,0x12,0xf8,0x00,0x21,0x99,0x60,0x16,0x49,
-    0x14,0x48,0x01,0x60,0x01,0x21,0x99,0x60,0x01,0xbc,0x00,0x28,0x00,0xd0,
-    0x00,0x47,0x12,0x48,0x13,0x49,0x08,0x60,0x03,0xc8,0x80,0xf3,0x08,0x88,
-    0x08,0x47,0x03,0xb5,0x99,0x6a,0x04,0x20,0x01,0x42,0xfb,0xd0,0x01,0x20,
-    0x01,0x42,0xf8,0xd1,0x03,0xbd,0x02,0xb5,0x18,0x66,0x18,0x66,0xff,0xf7,
-    0xf2,0xff,0x18,0x6e,0x18,0x6e,0x02,0xbd,0x00,0x00,0x02,0x40,0x00,0x00,
-    0x00,0x18,0x00,0x00,0x07,0x00,0x00,0x03,0x5f,0x00,0x21,0x22,0x00,0x00,
-    0xf4,0x00,0x00,0x18,0x22,0x20,0x00,0xa0,0x00,0x01,0x00,0x10,0x08,0xed,
-    0x00,0xe0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x74,0xb2,0x4e,0x7a,0x00,0x1c,0x04,0x20,0x89,0x01,0x00,0x10,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
-    0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x61,0x6e,0x42,0x6f,0x6f,0x74,0x21,
-    0x00,0xe0,0x00,0x00,0x00,0x22,0x19,0x49,0x19,0x4b,0x70,0xb5,0x5b,0x1a,
-    0x19,0x4c,0x9b,0x10,0x93,0x42,0x20,0xd1,0x00,0x23,0x1c,0x00,0x17,0x48,
-    0x17,0x4a,0x12,0x1a,0x92,0x10,0x9a,0x42,0x1d,0xd1,0x16,0x4a,0x16,0x4b,
-    0x93,0x60,0x16,0x4b,0x17,0x49,0x1c,0x68,0x58,0x68,0x8c,0x42,0x0d,0xd1,
-    0x15,0x49,0x88,0x42,0x0a,0xd1,0x00,0x21,0x19,0x60,0x59,0x60,0x13,0x4b,
-    0x93,0x60,0x13,0x4a,0x1b,0x68,0x12,0x68,0x83,0xf3,0x08,0x88,0x10,0x47,
-    0x00,0xf0,0x24,0xf8,0x90,0x00,0x25,0x58,0x0d,0x50,0x01,0x32,0xd7,0xe7,
-    0x99,0x00,0x41,0x18,0x0c,0x60,0x01,0x33,0xda,0xe7,0x00,0x00,0x00,0x20,
-    0x0c,0x1b,0x00,0x20,0x38,0x02,0x00,0x10,0x0c,0x1b,0x00,0x20,0xe8,0x1f,
-    0x00,0x20,0x00,0xed,0x00,0xe0,0x00,0x00,0x00,0x20,0x00,0x1c,0x04,0x20,
-    0x3d,0x24,0xa8,0xa9,0x45,0xec,0x06,0x7b,0x00,0x40,0x00,0x10,0x04,0x40,
-    0x00,0x10,0x00,0x00,0x00,0x00,0x01,0xb4,0x02,0x48,0x84,0x46,0x01,0xbc,
-    0x60,0x47,0x00,0xbf,0xdd,0x0c,0x00,0x20,0x00,0x1c,0x04,0x20,0x89,0x01,
-    0x00,0x10,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,
-    0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,
-    0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,
-    0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,
-    0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,
-    0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,0x00,0x20,0xbd,0x04,
-    0x00,0x20,0x05,0x08,0x00,0x20,0xff,0x22,0x2d,0x48,0x12,0x01,0x43,0x68,
-    0x70,0xb5,0x1a,0x60,0x01,0x22,0x52,0x42,0x9a,0x60,0x01,0x32,0xff,0x32,
-    0x1a,0x63,0xfd,0x3a,0x5a,0x63,0x00,0x22,0x27,0x4d,0x51,0x00,0x4c,0x5b,
-    0x11,0x00,0x12,0x31,0x89,0x00,0x01,0x32,0xcc,0x50,0x20,0x2a,0xf6,0xd1,
-    0xc2,0x24,0x19,0x00,0x82,0x68,0x24,0x02,0x15,0x06,0xc8,0x31,0x2c,0x43,
-    0x4c,0x60,0x80,0x24,0x56,0x01,0xe4,0x04,0x34,0x43,0x4c,0x61,0x1c,0x4c,
-    0x69,0x26,0x0c,0x61,0x00,0x24,0x4c,0x61,0x1e,0x61,0x1a,0x4e,0xc0,0x68,
-    0x0e,0x61,0x06,0x26,0x0e,0x61,0x19,0x4e,0xce,0x61,0xd6,0x03,0x18,0x4a,
-    0xce,0x62,0x0c,0x62,0x0a,0x62,0x0d,0x22,0x8a,0x62,0x1a,0x00,0x16,0x49,
-    0xf8,0x32,0x51,0x60,0x15,0x49,0x56,0x61,0x94,0x60,0x11,0x61,0x14,0x49,
-    0x11,0x61,0x14,0x49,0x11,0x61,0x12,0x21,0x11,0x61,0xc6,0x21,0x49,0x02,
-    0x29,0x43,0xd1,0x61,0x11,0x49,0x11,0x62,0x82,0x21,0xc9,0x04,0x01,0x43,
-    0x40,0x01,0x01,0x43,0xd1,0x62,0x0e,0x49,0x91,0x62,0x0e,0x49,0x91,0x62,
-    0x07,0x22,0x1a,0x60,0x70,0xbd,0xc0,0x46,0xd0,0x1e,0x00,0x20,0x30,0x17,
-    0x00,0x20,0x80,0xe0,0x00,0x00,0xa0,0x80,0x00,0x00,0x80,0xe6,0x00,0x00,
-    0x00,0x00,0xa1,0x80,0x80,0x86,0x01,0x00,0x40,0xe0,0x00,0x00,0xe2,0xa0,
-    0x00,0x00,0x2a,0xa0,0x00,0x00,0x00,0x00,0x02,0x40,0x01,0xe0,0x00,0x00,
-    0x81,0xe0,0x00,0x00,0x30,0xb5,0x15,0x4c,0x85,0xb0,0xa2,0x6c,0x63,0x68,
-    0x00,0x2a,0x02,0xd0,0x00,0x22,0xa2,0x64,0x9a,0x61,0x11,0x4a,0x12,0x49,
-    0x1a,0x65,0x1a,0x00,0xfc,0x32,0x11,0x63,0x9b,0x68,0x9b,0x07,0x0f,0xd5,
-    0x00,0x25,0xa5,0x61,0x65,0x62,0xff,0xf7,0x72,0xff,0x10,0x22,0x29,0x00,
-    0x68,0x46,0x01,0xf0,0x83,0xfa,0x80,0x21,0x6a,0x46,0x09,0x04,0x20,0x00,
-    0x23,0x69,0x98,0x47,0x09,0x23,0xa3,0x62,0x00,0x23,0xe3,0x61,0x20,0x33,
-    0x23,0x62,0x05,0xb0,0x30,0xbd,0xc0,0x46,0xd0,0x1e,0x00,0x20,0x27,0xa1,
-    0x00,0x00,0x02,0x03,0x00,0x00,0x10,0xb5,0x0d,0x4c,0xa3,0x6c,0x5a,0x07,
-    0x0d,0xd5,0x62,0x68,0x0b,0x49,0x11,0x65,0x0b,0x4a,0x06,0x2b,0x0c,0xd1,
-    0x23,0x6d,0x01,0x33,0x80,0x21,0x23,0x65,0x89,0x03,0x20,0x00,0x23,0x69,
-    0x98,0x47,0x00,0x23,0x62,0x68,0xa3,0x64,0x93,0x61,0x10,0xbd,0x80,0x21,
-    0x49,0x03,0xf4,0xe7,0xc0,0x46,0xd0,0x1e,0x00,0x20,0x2a,0xe1,0x00,0x00,
-    0x08,0x1f,0x00,0x20,0x1f,0x23,0xf0,0xb5,0x20,0x24,0x46,0x68,0x85,0x68,
-    0x33,0x40,0xe3,0x1a,0x74,0x09,0xa4,0x00,0x2c,0x19,0x25,0x68,0xac,0x46,
-    0x93,0x42,0x06,0xd3,0x9b,0x1a,0x99,0x40,0x29,0x43,0x21,0x60,0xb6,0x18,
-    0x46,0x60,0xf0,0xbd,0x0d,0x00,0xd7,0x1a,0xfd,0x40,0x2f,0x00,0x65,0x46,
-    0x2f,0x43,0x20,0x25,0xad,0x1a,0xeb,0x18,0x99,0x40,0x63,0x68,0x27,0x60,
-    0x19,0x43,0x61,0x60,0xed,0xe7,0xf7,0xb5,0x05,0x00,0x01,0x24,0x07,0x68,
-    0x01,0x91,0x7a,0x08,0x7a,0x40,0x53,0x08,0x13,0x43,0x9a,0x08,0x13,0x43,
-    0xdb,0x43,0x0a,0x00,0x26,0x00,0x8e,0x40,0x50,0x1a,0x01,0x3e,0x86,0x40,
-    0x84,0x46,0x33,0x42,0x05,0xd1,0x8a,0x42,0x1b,0xd9,0x41,0x1c,0x49,0x08,
-    0x62,0x46,0xf1,0xe7,0x26,0x00,0x50,0x1e,0x86,0x40,0x84,0x46,0x33,0x42,
-    0xf6,0xd0,0x23,0x00,0x93,0x40,0x38,0x00,0x01,0x3b,0x59,0x08,0x88,0x43,
-    0x3b,0x40,0x41,0x00,0x73,0x40,0x4b,0x40,0x1f,0x00,0x01,0x9b,0x01,0x33,
-    0x01,0x93,0x04,0x2a,0x01,0xd9,0x11,0x1f,0xd1,0xe7,0x2f,0x60,0x01,0x98,
-    0xfe,0xbd,0x73,0xb5,0x2b,0x4c,0x10,0x21,0xe3,0x6a,0xa6,0x69,0x5a,0x04,
-    0x63,0x69,0x52,0x0c,0xf3,0x40,0xdb,0x03,0x13,0x43,0x01,0xa8,0xe2,0x62,
-    0x65,0x6a,0x01,0x93,0xff,0xf7,0xb9,0xff,0x01,0x22,0x01,0x9b,0x01,0x3d,
-    0x5b,0x00,0x1a,0x43,0xae,0x1b,0xe3,0x6c,0x30,0x18,0x22,0x63,0x60,0x63,
-    0x01,0x2b,0x2e,0xd1,0x03,0x25,0x21,0x6d,0x2b,0x33,0x29,0x40,0x4b,0x43,
-    0xe3,0x18,0x99,0x6d,0xa6,0x6b,0xb1,0x42,0x24,0xd1,0x99,0x6e,0xe6,0x6a,
-    0xb1,0x42,0x29,0xd1,0xd9,0x6d,0xe6,0x6b,0xb1,0x42,0x25,0xd1,0x19,0x6e,
-    0x26,0x6c,0xb1,0x42,0x21,0xd1,0x5b,0x6e,0x61,0x6c,0x8b,0x42,0x1d,0xd1,
-    0x02,0x23,0x12,0x05,0xa3,0x64,0xd2,0x0a,0xfd,0x33,0x1a,0x43,0x09,0x3b,
-    0xff,0x3b,0x18,0x1a,0x40,0x05,0x63,0x68,0x02,0x43,0xe5,0x64,0x9a,0x61,
-    0x05,0x23,0xa3,0x62,0x00,0x23,0xe3,0x61,0x10,0x33,0x23,0x62,0x73,0xbd,
-    0x01,0x23,0x02,0x22,0xa3,0x64,0x63,0x68,0x5a,0x63,0x04,0x4a,0xfc,0x33,
-    0x1a,0x63,0xef,0xe7,0xff,0xf7,0xfb,0xfe,0xf2,0xe7,0xd0,0x1e,0x00,0x20,
-    0x02,0x03,0x00,0x00,0x10,0xb5,0x30,0x24,0x0c,0x40,0x02,0xd0,0xff,0xf7,
-    0xf0,0xfe,0x10,0xbd,0x0f,0x22,0x0d,0x4b,0x0a,0x40,0x5c,0x64,0x1c,0x64,
-    0xda,0x63,0x49,0x06,0x03,0xd5,0x80,0x22,0xd2,0x05,0x10,0x43,0x22,0x00,
-    0x98,0x63,0x00,0x2a,0x09,0xd0,0x20,0x21,0x03,0x2a,0x00,0xd8,0xd1,0x00,
-    0x03,0x22,0x9a,0x62,0x00,0x22,0x19,0x62,0xda,0x61,0xe5,0xe7,0xff,0xf7,
-    0x82,0xff,0xe2,0xe7,0xc0,0x46,0xd0,0x1e,0x00,0x20,0x13,0xb5,0x04,0x00,
-    0x01,0x20,0x0b,0x00,0x90,0x40,0x21,0x68,0x01,0x38,0x91,0x40,0x03,0x40,
-    0x0b,0x43,0x01,0xa8,0x11,0x00,0x01,0x93,0xff,0xf7,0x39,0xff,0x01,0x99,
-    0x02,0x00,0x20,0x00,0xff,0xf7,0x10,0xff,0x01,0x9b,0x23,0x60,0x13,0xbd,
-    0x00,0x00,0x0b,0x00,0xc1,0x09,0x59,0x40,0xc9,0xb2,0x02,0x4b,0x49,0x00,
-    0xcb,0x5a,0x00,0x02,0x58,0x40,0x70,0x47,0x70,0x17,0x00,0x20,0x10,0xb5,
-    0x0c,0x00,0x02,0x2a,0x09,0xd0,0x03,0x2a,0x04,0xd0,0x01,0x2a,0x08,0xd0,
-    0x09,0x0e,0xff,0xf7,0xe9,0xff,0x21,0x0c,0xff,0xf7,0xe6,0xff,0x21,0x0a,
-    0xff,0xf7,0xe3,0xff,0x21,0x00,0xff,0xf7,0xe0,0xff,0x10,0xbd,0x00,0x00,
-    0x10,0xb5,0x41,0x18,0x04,0x00,0x0a,0x48,0x8c,0x42,0x00,0xd1,0x10,0xbd,
-    0x22,0x78,0x01,0x34,0x42,0x40,0x53,0xb2,0xda,0xb2,0x12,0x01,0x53,0x40,
-    0xdb,0xb2,0x1a,0x02,0x00,0x0a,0x02,0x43,0x18,0x09,0xdb,0x00,0x58,0x40,
-    0x50,0x40,0xec,0xe7,0xc0,0x46,0xff,0xff,0x00,0x00,0x14,0x23,0x10,0xb5,
-    0x01,0x00,0x18,0x88,0x04,0x33,0x1b,0x88,0x98,0x47,0x10,0xbd,0x10,0xb5,
-    0x0b,0x4c,0x20,0x68,0x03,0x05,0x04,0xd1,0xf0,0x23,0x1b,0x06,0xc0,0x18,
-    0x01,0xf0,0xb0,0xfa,0xf0,0x23,0x20,0x68,0x1b,0x06,0xc0,0x18,0x01,0xf0,
-    0xd4,0xfa,0x04,0x4a,0x13,0x68,0x01,0x33,0x13,0x60,0x00,0x22,0x03,0x4b,
-    0x1a,0x60,0x10,0xbd,0xcc,0x1e,0x00,0x20,0xe0,0x1f,0x00,0x20,0xc8,0x1e,
-    0x00,0x20,0x05,0x4b,0x1a,0x68,0x02,0x43,0x1a,0x60,0x1a,0x68,0x82,0x43,
-    0x1a,0x60,0x9a,0x68,0x10,0x42,0xfc,0xd0,0x70,0x47,0xc0,0x46,0x00,0xc0,
-    0x00,0x40,0xfe,0xe7,0x00,0x00,0x72,0xb6,0x06,0x4b,0x06,0x49,0x07,0x4a,
-    0x06,0xc3,0xbf,0xf3,0x4f,0x8f,0x06,0x4b,0x06,0x4a,0xda,0x60,0xbf,0xf3,
-    0x4f,0x8f,0xc0,0x46,0xfd,0xe7,0x00,0x1c,0x04,0x20,0x3d,0x24,0xa8,0xa9,
-    0x45,0xec,0x06,0x7b,0x00,0xed,0x00,0xe0,0x04,0x00,0xfa,0x05,0x0b,0x00,
-    0x70,0xb5,0x11,0x00,0x9a,0x02,0x03,0xd5,0x01,0x22,0x1d,0x4b,0x9a,0x72,
-    0x70,0xbd,0xdb,0x02,0xfc,0xd5,0x1b,0x4c,0x0a,0x68,0x23,0x68,0x00,0x2b,
-    0x16,0xd0,0x9a,0x42,0x28,0xd1,0x4e,0x68,0xa5,0x7b,0x08,0x2e,0x00,0xd9,
-    0x08,0x26,0xc0,0x23,0x5b,0x1b,0x9e,0x42,0xec,0xd8,0x28,0x00,0xf8,0x30,
-    0x20,0x18,0x08,0x31,0x32,0x00,0xad,0x19,0x01,0xf0,0x19,0xf8,0xa5,0x73,
-    0x01,0x23,0x63,0x73,0xe0,0xe7,0xfc,0x23,0x9b,0x00,0x9a,0x42,0xdc,0xd1,
-    0x23,0x69,0x65,0x69,0x08,0x33,0x9d,0x42,0xd7,0xd2,0x07,0x20,0x28,0x40,
-    0x00,0x01,0x18,0x30,0x20,0x18,0x10,0x22,0x01,0x35,0x01,0xf0,0x03,0xf8,
-    0x65,0x61,0xe8,0xe7,0xfc,0x20,0x01,0x33,0x80,0x00,0x82,0x42,0xe8,0xd1,
-    0xe9,0xe7,0xc0,0x46,0x0c,0x1b,0x00,0x20,0xf0,0xb5,0x68,0x4d,0x8b,0xb0,
-    0x2b,0x6d,0x6a,0x6d,0x04,0x92,0xd3,0x1a,0x03,0x2b,0x00,0xd9,0xc3,0xe0,
-    0x03,0x23,0x1a,0x40,0x01,0x92,0x01,0x99,0x29,0x33,0x4b,0x43,0x02,0x68,
-    0xeb,0x18,0x00,0x2a,0x00,0xdb,0x9e,0xe0,0x5f,0x49,0x0a,0x40,0x9a,0x65,
-    0x0f,0x22,0x43,0x68,0x01,0x99,0x1a,0x40,0x2c,0x23,0x4b,0x43,0x00,0x21,
-    0xeb,0x18,0xda,0x65,0x9b,0x6d,0x02,0x91,0x5b,0x00,0x04,0xd4,0x02,0x92,
-    0x08,0x2a,0x01,0xd9,0x08,0x23,0x02,0x93,0x2c,0x26,0x01,0x9b,0x01,0x00,
-    0x73,0x43,0x1c,0x00,0x00,0x26,0x60,0x34,0xef,0x18,0x03,0x93,0x2b,0x19,
-    0x08,0x31,0x02,0x9a,0x18,0x00,0x7e,0x66,0x3e,0x66,0x05,0x93,0x00,0xf0,
-    0xbc,0xff,0x03,0x9b,0x14,0x22,0x70,0x33,0xed,0x18,0x28,0x00,0x31,0x00,
-    0x01,0xf0,0x46,0xf8,0x01,0x23,0x40,0x22,0x07,0x93,0xbb,0x6d,0x09,0x95,
-    0x1c,0x0e,0x14,0x40,0xfa,0x6d,0x08,0x96,0x22,0x43,0x43,0x4d,0xb3,0x42,
-    0x64,0xda,0xdc,0x0a,0x2c,0x40,0x9d,0x03,0xed,0x0e,0x2c,0x43,0x60,0x25,
-    0x25,0x43,0xdc,0x01,0x3f,0x4b,0x29,0x09,0x1c,0x40,0x14,0x43,0x30,0x00,
-    0x02,0x22,0xff,0xf7,0xdd,0xfe,0xf0,0x23,0x29,0x05,0x1b,0x04,0x19,0x40,
-    0x21,0x43,0x03,0x22,0xff,0xf7,0xd5,0xfe,0x13,0x22,0x07,0x00,0x29,0x00,
-    0x07,0xa8,0xff,0xf7,0xab,0xfe,0x14,0x22,0x21,0x00,0x07,0xa8,0xff,0xf7,
-    0xa6,0xfe,0x2e,0x4d,0x03,0x9b,0x2e,0x00,0x60,0x36,0xf6,0x18,0x02,0x9b,
-    0x05,0x9c,0xf3,0x18,0x02,0x93,0x02,0x9b,0x9c,0x42,0x40,0xd1,0x2c,0x23,
-    0x01,0x9a,0x79,0x04,0x53,0x43,0x49,0x0c,0xeb,0x18,0x99,0x66,0x0f,0x22,
-    0x07,0xa8,0xff,0xf7,0x8f,0xfe,0x01,0x22,0x07,0xa8,0x11,0x00,0xff,0xf7,
-    0xae,0xfd,0x08,0x99,0x1f,0x20,0x0b,0x00,0x1f,0x33,0x5a,0x09,0x83,0x43,
-    0x5b,0x1a,0x0b,0xd0,0x20,0x49,0x50,0x18,0x09,0x99,0x80,0x00,0x08,0x18,
-    0x01,0x21,0x99,0x40,0x0b,0x00,0x01,0x68,0x01,0x3b,0x0b,0x43,0x03,0x60,
-    0x2c,0x23,0x01,0x99,0x4b,0x43,0xeb,0x18,0xda,0x66,0x04,0x9b,0x01,0x33,
-    0x6b,0x65,0xbf,0xf3,0x5f,0x8f,0x02,0x22,0x00,0x20,0x6b,0x68,0x5a,0x63,
-    0x0b,0xb0,0xf0,0xbd,0x13,0x49,0x5f,0xe7,0xdc,0x01,0x2c,0x40,0x14,0x43,
-    0x21,0x00,0x03,0x22,0x30,0x00,0xff,0xf7,0x80,0xfe,0x13,0x22,0x07,0x00,
-    0xae,0xe7,0x26,0x78,0x38,0x00,0x31,0x00,0xff,0xf7,0x6c,0xfe,0x08,0x22,
-    0x07,0x00,0x31,0x00,0x07,0xa8,0xff,0xf7,0x4e,0xfe,0x01,0x34,0xae,0xe7,
-    0x01,0x20,0x40,0x42,0xe0,0xe7,0xc0,0x46,0xd0,0x1e,0x00,0x20,0xff,0xff,
-    0xff,0xdf,0x80,0xff,0x03,0x00,0x80,0xff,0x0f,0x00,0xff,0xff,0xff,0x3f,
-    0xff,0x07,0x00,0x40,0x2f,0x4b,0x70,0xb5,0xda,0x6c,0x01,0x2a,0x17,0xd1,
-    0x59,0x68,0x0a,0x00,0xfc,0x32,0x10,0x6a,0x18,0x28,0x04,0xd1,0xd2,0x6a,
-    0x00,0x20,0x92,0x07,0x0d,0xd5,0x70,0xbd,0xcc,0x68,0xf0,0x21,0x09,0x05,
-    0x00,0x20,0x0c,0x42,0xf8,0xd1,0x81,0x21,0xd2,0x6a,0x49,0x00,0x0a,0x40,
-    0x02,0x39,0x8a,0x42,0xf1,0xd1,0x1a,0x6d,0x59,0x6d,0x8a,0x42,0x0d,0xd1,
-    0x00,0x21,0x58,0x68,0xd9,0x64,0x02,0x31,0x01,0x63,0xbf,0xf3,0x5f,0x8f,
-    0x5c,0x6d,0x80,0x20,0x80,0x00,0xa2,0x42,0xe1,0xd0,0x58,0x68,0x41,0x63,
-    0x01,0x21,0xd9,0x64,0x02,0x31,0x11,0x40,0x2c,0x22,0x4a,0x43,0x14,0x00,
-    0x9a,0x18,0xd5,0x6e,0x07,0x22,0x70,0x34,0x1c,0x19,0x5b,0x68,0x12,0x48,
-    0x1a,0x60,0x19,0x00,0x80,0x32,0x1a,0x60,0x7b,0x3a,0x1a,0x63,0x00,0x22,
-    0x1e,0x00,0x11,0x31,0xff,0x31,0x8a,0x60,0x88,0x60,0x0d,0x48,0xac,0x36,
-    0x30,0x60,0x95,0x42,0x0b,0xd1,0x0b,0x4a,0x0a,0x61,0x1b,0x22,0x08,0x61,
-    0x0a,0x61,0x83,0x22,0x92,0x01,0x0a,0x61,0x0f,0x22,0x00,0x20,0x1a,0x60,
-    0xb4,0xe7,0x96,0x00,0xa6,0x59,0x01,0x32,0xde,0x61,0xec,0xe7,0xc0,0x46,
-    0xd0,0x1e,0x00,0x20,0x00,0x00,0x02,0x40,0x21,0x60,0x00,0x00,0x01,0xe0,
-    0x00,0x00,0xf0,0xb5,0xcb,0x4b,0x87,0xb0,0x5b,0x68,0x01,0x93,0xfc,0x33,
-    0x9b,0x6b,0x02,0x22,0x13,0x42,0x18,0xd1,0x1a,0x05,0x00,0xd4,0x70,0xe1,
-    0x08,0x22,0xc4,0x4c,0x52,0x42,0x23,0x6b,0x61,0x6b,0xdb,0x04,0x52,0x1a,
-    0x52,0x05,0xdb,0x0a,0x13,0x43,0x7f,0x22,0x13,0x43,0x62,0x68,0x93,0x61,
-    0xff,0xf7,0x7b,0xff,0x63,0x68,0xbd,0x4a,0x10,0x43,0xfc,0x33,0x18,0x63,
-    0x50,0xe0,0x01,0x9b,0x01,0x27,0x59,0x6a,0xb8,0x4b,0x89,0x05,0x5a,0x69,
-    0x89,0x0d,0x92,0x02,0x0a,0x43,0x5a,0x61,0x0a,0x22,0x9a,0x61,0x5a,0x6a,
-    0x0a,0x32,0x5a,0x62,0xb2,0x48,0x82,0x69,0x00,0x2a,0x38,0xd0,0x43,0x69,
-    0xc5,0x69,0x5c,0x08,0x5c,0x40,0x61,0x08,0x21,0x43,0x8c,0x08,0x21,0x43,
-    0xc9,0x43,0x02,0x91,0x01,0x6a,0x00,0x20,0x84,0x46,0x16,0x00,0x8a,0x42,
-    0x00,0xd9,0x0e,0x00,0x10,0x00,0x8a,0x1a,0x05,0x92,0x3c,0x00,0xb4,0x40,
-    0x05,0x9a,0x82,0x18,0x03,0x92,0x62,0x1e,0x04,0x92,0x82,0x1b,0x51,0x1c,
-    0x0c,0x00,0x04,0x99,0xa1,0x40,0x0c,0x00,0x02,0x99,0x21,0x42,0x1b,0xd1,
-    0x18,0x00,0xd0,0x40,0x03,0x99,0x04,0x9c,0x89,0x1b,0x04,0x40,0x8c,0x40,
-    0x25,0x43,0x00,0x29,0x00,0xd1,0x7e,0xe1,0xbc,0x46,0x00,0x2a,0xda,0xd1,
-    0x97,0x4b,0x9a,0x61,0x62,0x46,0x00,0x2a,0x01,0xd0,0x19,0x62,0xdd,0x61,
-    0x01,0x9b,0xfc,0x33,0x9b,0x6b,0x00,0x2b,0x92,0xd1,0x07,0xb0,0xf0,0xbd,
-    0x39,0x00,0x81,0x40,0x42,0x1e,0x08,0x00,0x02,0x99,0x01,0x42,0x11,0xd0,
-    0x3c,0x00,0x94,0x40,0x0c,0x42,0x18,0xd0,0x61,0x46,0x8a,0x48,0x82,0x61,
-    0x00,0x29,0x02,0xd0,0x03,0x99,0xc5,0x61,0x01,0x62,0x1c,0x42,0x00,0xd0,
-    0x6b,0xe1,0xff,0xf7,0x16,0xfc,0xa2,0xe7,0x19,0x00,0xd1,0x40,0x05,0x98,
-    0x39,0x40,0x10,0x18,0x81,0x40,0x76,0x08,0x0d,0x43,0xbc,0x46,0x10,0x00,
-    0xaf,0xe7,0x03,0x99,0xc9,0xe7,0x81,0x22,0x63,0x68,0x52,0x00,0xfc,0x33,
-    0x1a,0x63,0x00,0x23,0xa5,0x63,0xe3,0x61,0xa7,0x62,0x11,0x33,0x23,0x62,
-    0x89,0xe7,0xa3,0x6b,0x5b,0x04,0x1d,0x43,0x60,0x23,0x2b,0x40,0x60,0x2b,
-    0x06,0xd1,0x5e,0x3b,0xa3,0x62,0x00,0x23,0xa5,0x63,0xe3,0x61,0x14,0x33,
-    0xef,0xe7,0x03,0x22,0x29,0x00,0x00,0x20,0xff,0xf7,0x3d,0xfd,0xe0,0x62,
-    0xa8,0x03,0x40,0x0d,0x29,0x00,0xff,0xf7,0xed,0xfc,0x6f,0xe7,0x6a,0x4b,
-    0x02,0x22,0x9c,0x6b,0x00,0x20,0x21,0x09,0xff,0xf7,0x2f,0xfd,0xf0,0x23,
-    0x21,0x05,0x1b,0x04,0x19,0x40,0x03,0x22,0x29,0x43,0xff,0xf7,0x27,0xfd,
-    0x63,0x4b,0x64,0x4a,0xd8,0x62,0x80,0x20,0xeb,0x09,0x00,0x06,0x18,0x43,
-    0xe3,0x02,0x13,0x40,0x18,0x43,0xf8,0x23,0x64,0x03,0x9b,0x02,0x1c,0x40,
-    0x20,0x43,0xdc,0xe7,0x20,0x23,0xe6,0x6b,0x02,0x93,0x03,0x2e,0x01,0xd8,
-    0xf3,0x00,0x02,0x93,0x32,0x00,0x29,0x00,0xe0,0x6a,0xff,0xf7,0x0b,0xfd,
-    0x20,0x23,0x02,0x9a,0xe0,0x62,0x9a,0x1a,0x95,0x40,0x2d,0xba,0x25,0x64,
-    0x04,0x2e,0x1d,0xd9,0x07,0x2e,0x02,0xd8,0x52,0x4b,0xf6,0x18,0xf3,0x00,
-    0x04,0x21,0x4d,0x4a,0x91,0x62,0x00,0x21,0x13,0x62,0xd1,0x61,0x2f,0xe7,
-    0xe2,0x6b,0x20,0x26,0x07,0x2a,0x02,0xd8,0x4b,0x4b,0xd6,0x18,0xf6,0x00,
-    0x29,0x00,0xe0,0x6a,0x04,0x3a,0xff,0xf7,0xea,0xfc,0x20,0x23,0x9e,0x1b,
-    0xb5,0x40,0x2d,0xba,0xe0,0x62,0x65,0x64,0xff,0xf7,0x3c,0xfc,0x1a,0xe7,
-    0xe1,0x6a,0x49,0x00,0x39,0x43,0x8d,0x42,0x00,0xd0,0x6e,0xe7,0xa1,0x6c,
-    0x02,0x29,0x03,0xd1,0x61,0x68,0x3c,0x48,0xfc,0x31,0x08,0x63,0x39,0x00,
-    0x91,0x40,0x4d,0x1e,0x2b,0x40,0x4a,0x00,0x13,0x43,0x63,0x61,0x06,0x23,
-    0xa3,0x62,0x00,0x23,0xe3,0x61,0x02,0x33,0x74,0xe7,0x01,0x2d,0x0b,0xd0,
-    0x21,0x6b,0x89,0x00,0x0d,0x43,0x39,0x00,0x91,0x40,0x95,0x40,0x0a,0x00,
-    0x01,0x3a,0x13,0x40,0x2b,0x43,0x63,0x61,0x4c,0xe7,0xa2,0x6c,0x00,0x2a,
-    0x02,0xd0,0x04,0x23,0x13,0x43,0xa3,0x64,0x07,0x23,0xa3,0x62,0x00,0x23,
-    0xe3,0x61,0x04,0x33,0x5a,0xe7,0x0f,0x2d,0x00,0xd0,0x3d,0xe7,0x02,0x20,
-    0x61,0x68,0x89,0x68,0x01,0x40,0x00,0xd0,0x37,0xe7,0x38,0x00,0x90,0x40,
-    0x45,0x1e,0x2b,0x40,0x42,0x00,0x13,0x43,0x63,0x61,0x08,0x23,0xe1,0x61,
-    0xa3,0x62,0x03,0x3b,0x45,0xe7,0x1b,0x2d,0x06,0xd8,0x17,0x2d,0x00,0xd8,
-    0x26,0xe7,0xa3,0x6c,0x05,0x2b,0x00,0xd0,0x22,0xe7,0xa3,0x6c,0x00,0x2b,
-    0x05,0xd0,0xff,0xf7,0x68,0xfb,0x63,0x68,0x18,0x4a,0xfc,0x33,0x1a,0x63,
-    0x1f,0x2d,0x00,0xd0,0x16,0xe7,0x00,0x22,0x10,0x4b,0x9a,0x62,0xda,0x61,
-    0x1f,0x62,0xb6,0xe6,0x9b,0x05,0xf7,0xd0,0x0d,0xe7,0x5a,0x05,0x09,0xd5,
-    0x0b,0x4c,0xa2,0x6c,0x00,0x2a,0x0d,0xd0,0x04,0x23,0x13,0x43,0xa3,0x64,
-    0xff,0xf7,0x4d,0xfb,0x07,0xe0,0x80,0x20,0x40,0x00,0x18,0x40,0x13,0xd0,
-    0x04,0x4c,0xa3,0x6c,0x00,0x2b,0xf4,0xd1,0xff,0xf7,0x04,0xfe,0x63,0x68,
-    0x02,0x22,0x87,0xe6,0xc0,0x46,0xd0,0x1e,0x00,0x20,0x02,0x05,0x00,0x00,
-    0x00,0x00,0xfc,0x1f,0xfc,0xff,0xff,0x1f,0x02,0x02,0x00,0x00,0x9b,0x05,
-    0x00,0xd4,0xce,0xe6,0x32,0x4c,0x32,0x4a,0x63,0x68,0x1e,0x00,0xfc,0x36,
-    0x35,0x6b,0x95,0x42,0x2b,0xd1,0xa2,0x6c,0x01,0x2a,0x28,0xd1,0x62,0x6b,
-    0x51,0x42,0x22,0x6b,0x49,0x05,0xd2,0x02,0xd2,0x0a,0x0a,0x43,0x02,0x21,
-    0xe1,0x64,0x05,0x31,0x19,0x60,0x80,0x31,0x19,0x60,0x7b,0x39,0x19,0x63,
-    0x19,0x00,0x11,0x31,0xff,0x31,0x88,0x60,0x25,0x48,0x25,0x4c,0x88,0x60,
-    0x18,0x00,0xac,0x30,0x04,0x60,0x24,0x48,0xd8,0x61,0x24,0x48,0x08,0x61,
-    0x24,0x48,0x08,0x61,0x1b,0x20,0x08,0x61,0x23,0x48,0x08,0x61,0x0f,0x21,
-    0x19,0x60,0x9a,0x61,0x21,0x4b,0x33,0x63,0x9a,0xe6,0xff,0xf7,0xbd,0xfd,
-    0x20,0x4b,0x62,0x68,0x1d,0x40,0x02,0x23,0x2b,0x43,0x18,0x43,0xfc,0x32,
-    0x10,0x63,0x8f,0xe6,0x12,0x4c,0xa0,0x6a,0xa2,0x61,0x21,0x62,0xe5,0x61,
-    0x09,0x28,0x00,0xd9,0x45,0xe6,0x00,0xf0,0x2a,0xfc,0xae,0xfe,0xba,0xfe,
-    0xd4,0xfe,0xf3,0xfe,0x14,0xff,0x29,0xff,0x43,0xff,0x5d,0xff,0x72,0xff,
-    0x9e,0xfe,0x81,0x6a,0x09,0x29,0x02,0xd0,0x00,0x29,0x00,0xd0,0x8d,0xe6,
-    0xd3,0x40,0xdb,0x43,0x00,0x2b,0x00,0xd0,0x77,0xe7,0x43,0x61,0x83,0x61,
-    0x43,0x62,0xff,0xf7,0x26,0xfa,0x82,0xe6,0xc0,0x46,0xd0,0x1e,0x00,0x20,
-    0x02,0x03,0x00,0x00,0x00,0x00,0x02,0x40,0x23,0xc0,0x00,0x00,0xff,0xff,
-    0xff,0x7f,0x01,0xe0,0x00,0x00,0x21,0x60,0x00,0x00,0xc2,0x20,0x00,0x00,
-    0x02,0x09,0x00,0x00,0xff,0xfd,0xff,0xff,0xf8,0xb5,0x07,0x00,0x08,0x04,
-    0x1c,0x49,0x93,0x1e,0x1b,0x06,0x01,0x43,0x19,0x43,0x1a,0x4b,0x39,0x60,
-    0xd4,0x18,0xa4,0x00,0xa1,0x1c,0xb8,0x1c,0xff,0xf7,0xe0,0xfb,0x17,0x4b,
-    0x3a,0x19,0x17,0x4e,0x18,0x43,0x50,0x60,0x08,0x34,0x25,0x00,0xf1,0x7a,
-    0x34,0x7b,0xa1,0x42,0x03,0xd3,0x00,0x24,0x21,0x00,0x34,0x73,0xf4,0x72,
-    0x2b,0x19,0x60,0x2b,0x0c,0xd9,0x5b,0x1a,0x60,0x2b,0x14,0xd8,0x64,0x1a,
-    0x98,0x31,0x71,0x18,0x22,0x00,0x0d,0x48,0x00,0xf0,0xac,0xfc,0x00,0x23,
-    0x34,0x73,0xf3,0x72,0x20,0x00,0x98,0x30,0x30,0x18,0x2a,0x00,0x39,0x00,
-    0x64,0x19,0x00,0xf0,0x5d,0xfc,0x34,0x73,0x01,0x23,0xb3,0x72,0xf8,0xbd,
-    0xc0,0x46,0x01,0x88,0x00,0x00,0xfe,0xff,0xff,0x3f,0x00,0x00,0x99,0x03,
-    0x0c,0x1b,0x00,0x20,0xa4,0x1b,0x00,0x20,0x07,0xb5,0x02,0x22,0xf2,0x21,
-    0x68,0x46,0xff,0xf7,0xb4,0xff,0x07,0xbd,0x00,0x00,0x01,0x22,0xf0,0xb5,
-    0xd9,0x4c,0xbb,0xb0,0x23,0x68,0x00,0xaf,0x93,0x43,0x23,0x60,0xa3,0x68,
-    0x01,0x2b,0xfc,0xd1,0x03,0x22,0xd5,0x4e,0x33,0x68,0x93,0x43,0x33,0x60,
-    0xb3,0x68,0x01,0x2b,0xfc,0xd1,0x2f,0x22,0xd2,0x4b,0xd3,0x4d,0x2b,0x60,
-    0xd3,0x4b,0xda,0x60,0xd3,0x4a,0x1a,0x60,0x5a,0x68,0x00,0x2a,0xfc,0xda,
-    0x80,0x20,0x40,0x01,0xff,0xf7,0xc0,0xfb,0x01,0x22,0xcf,0x4b,0x1a,0x60,
-    0x7c,0x32,0x9a,0x60,0x71,0x3a,0x5a,0x60,0x1a,0x68,0x00,0x2a,0xfc,0xda,
-    0xc4,0x22,0xd2,0x02,0xda,0x60,0x04,0x22,0x5a,0x60,0x00,0x23,0x23,0x60,
-    0x01,0x33,0xff,0x33,0x63,0x60,0xff,0x3b,0x23,0x60,0x01,0x33,0xa2,0x68,
-    0x1a,0x42,0xfc,0xd0,0x80,0x20,0x80,0x01,0xff,0xf7,0xa2,0xfb,0x01,0x22,
-    0xc1,0x4b,0x1a,0x60,0x27,0x32,0x9a,0x60,0x1c,0x3a,0x5a,0x60,0x1a,0x68,
-    0x00,0x2a,0xfc,0xda,0xa4,0x22,0xd2,0x02,0xda,0x60,0x04,0x22,0x5a,0x60,
-    0x80,0x23,0x00,0x21,0xba,0x48,0x1b,0x01,0x01,0x60,0x03,0x60,0xb9,0x48,
-    0x01,0x60,0x03,0x60,0xb8,0x48,0x01,0x60,0x03,0x60,0x80,0x23,0x5b,0x00,
-    0x73,0x60,0xfe,0x3b,0x33,0x60,0xb3,0x68,0x13,0x42,0xfc,0xd0,0x90,0x20,
-    0xb3,0x4b,0xb4,0x4a,0x40,0x00,0xda,0x62,0xff,0xf7,0x78,0xfb,0x72,0xb6,
-    0x80,0x20,0x80,0x03,0xff,0xf7,0x73,0xfb,0x00,0x23,0xaf,0x4a,0x53,0x60,
-    0x13,0x60,0x62,0xb6,0xae,0x4b,0xaf,0x48,0x59,0x68,0xba,0x60,0x1a,0x68,
-    0x82,0x42,0x02,0xd1,0xad,0x4a,0x91,0x42,0x05,0xd0,0xac,0x4a,0x12,0x68,
-    0x01,0x3a,0x03,0x32,0x00,0xd8,0xc9,0xe0,0x00,0x21,0x19,0x60,0x59,0x60,
-    0x84,0x22,0xa8,0x4c,0x52,0x00,0x20,0x00,0x00,0xf0,0x4b,0xfc,0xc1,0x21,
-    0x80,0x20,0xa6,0x4b,0xa6,0x4a,0x63,0x60,0xa6,0x4b,0x89,0x00,0x23,0x61,
-    0x53,0x58,0xc0,0x05,0x1b,0x02,0x1b,0x0a,0x03,0x43,0x53,0x50,0x80,0x23,
-    0x13,0x60,0x78,0x3b,0xa3,0x60,0x01,0x33,0xe3,0x60,0x23,0x68,0x5a,0x42,
-    0x53,0x41,0x80,0x22,0x5b,0x42,0x12,0x01,0x9b,0x02,0x9b,0x18,0x2a,0x68,
-    0x1a,0x42,0x00,0xd0,0xb8,0xe0,0x63,0x68,0xfa,0x22,0x19,0x00,0xd2,0x02,
-    0xc8,0x31,0xfc,0x33,0x0a,0x60,0x8a,0x61,0x0a,0x63,0x5a,0x61,0xff,0xf7,
-    0x09,0xf9,0x22,0x68,0x68,0x20,0x53,0x1e,0x9a,0x41,0xa3,0x68,0x91,0x4d,
-    0x92,0x4e,0x99,0x00,0xdb,0x00,0x06,0x32,0x49,0x19,0x9b,0x19,0x48,0x60,
-    0x5a,0x60,0xe3,0x68,0x08,0x24,0x99,0x00,0xdb,0x00,0x9b,0x19,0x10,0x26,
-    0x49,0x19,0x58,0x25,0x08,0x38,0x48,0x60,0x5a,0x60,0xff,0xf7,0x64,0xf9,
-    0x08,0x22,0x00,0x21,0xb8,0x19,0x00,0xf0,0xff,0xfb,0xbb,0x19,0x0d,0x22,
-    0x00,0x21,0x18,0x19,0x00,0xf0,0xf9,0xfb,0xbb,0x19,0x0d,0x22,0x00,0x21,
-    0x58,0x19,0x00,0xf0,0xf3,0xfb,0x4b,0x23,0x3b,0x76,0xbb,0x19,0x59,0x19,
-    0x18,0x19,0x00,0xf0,0xe6,0xfd,0x00,0x23,0x10,0x21,0x58,0x22,0x78,0x18,
-    0x82,0x18,0xd2,0x18,0x52,0x79,0xc2,0x54,0x01,0x33,0x08,0x2b,0xf5,0xd1,
-    0x79,0x69,0x38,0x69,0x4a,0x02,0xc3,0x0d,0x13,0x43,0xca,0x0d,0x58,0x40,
-    0x51,0x40,0x73,0x4b,0x73,0x4a,0x00,0xf0,0xb3,0xfa,0x02,0x00,0x72,0x48,
-    0xcb,0x0b,0x50,0x40,0x72,0x4a,0x58,0x40,0x51,0x40,0x71,0x4b,0x72,0x4a,
-    0x00,0xf0,0xa8,0xfa,0x4a,0x02,0xc3,0x0d,0x13,0x43,0xca,0x0d,0x58,0x40,
-    0x51,0x40,0x68,0x4b,0x69,0x4a,0x00,0xf0,0x9e,0xfa,0xcb,0x0b,0x58,0x40,
-    0x6b,0x4b,0xb8,0x66,0xf9,0x66,0x58,0x60,0x19,0x81,0x01,0x22,0x5a,0x73,
-    0x69,0x4b,0x1b,0x78,0x00,0x2b,0x05,0xd0,0xbb,0x68,0x9a,0x6a,0x67,0x4b,
-    0x1b,0x68,0x9b,0x1a,0x38,0xd4,0x63,0x4a,0x53,0x7b,0xdb,0xb2,0x00,0x2b,
-    0x00,0xd1,0x12,0xe2,0x00,0x23,0x53,0x73,0x5f,0x4c,0x63,0x69,0x22,0x69,
-    0xfa,0x60,0x93,0x42,0x00,0xd1,0xca,0xe0,0x13,0x00,0x07,0x22,0x13,0x40,
-    0x18,0x01,0x26,0x68,0x22,0x18,0x92,0x69,0x00,0x2e,0x28,0xd0,0x71,0x1c,
-    0x8a,0x42,0x25,0xd1,0x00,0x22,0x55,0x4b,0x1a,0x60,0xfb,0x68,0x53,0x4a,
-    0x01,0x33,0x13,0x61,0xe4,0xe7,0xba,0x68,0x91,0x6a,0x53,0x4a,0x89,0x18,
-    0xba,0x68,0x92,0x6a,0x52,0x1a,0xfb,0xd4,0x3f,0x4a,0x18,0x60,0x5a,0x60,
-    0xba,0x68,0x91,0x6a,0x4f,0x4a,0x89,0x18,0xba,0x68,0x92,0x6a,0x52,0x1a,
-    0xfb,0xd4,0x00,0x22,0x1a,0x60,0x5a,0x60,0xff,0xf7,0x8c,0xfa,0x4a,0x4a,
-    0x13,0x60,0xaa,0x68,0x1a,0x42,0xfc,0xd0,0x40,0xe7,0xfc,0x21,0x89,0x00,
-    0x8a,0x42,0xd8,0xd1,0x22,0x18,0xd1,0x69,0x00,0x29,0xd4,0xd0,0x02,0x33,
-    0x1b,0x01,0xe3,0x5c,0x11,0x2b,0x26,0xd0,0x12,0x2b,0x00,0xd1,0x85,0xe0,
-    0x00,0x2b,0xca,0xd1,0x00,0x2e,0xc8,0xd1,0x3e,0x4b,0x10,0x20,0xbb,0x66,
-    0x60,0x22,0x08,0x23,0x39,0x18,0x8a,0x18,0xfb,0x66,0x18,0x33,0x13,0x70,
-    0x21,0x1d,0x41,0x33,0x04,0x00,0x38,0x18,0x06,0x22,0xc0,0x18,0x00,0xf0,
-    0xb4,0xfa,0x67,0x22,0x11,0x23,0x39,0x19,0x8a,0x18,0x13,0x70,0x10,0x22,
-    0x58,0x23,0xba,0x18,0xd0,0x18,0xff,0xf7,0xb1,0xfa,0x00,0x28,0xa9,0xda,
-    0xf6,0xe7,0x07,0x29,0xa6,0xd9,0x08,0x32,0xd5,0x7f,0x21,0x30,0x6d,0x00,
-    0x01,0x35,0x20,0x18,0x06,0x22,0x2b,0x49,0xff,0x35,0x00,0xf0,0x73,0xfa,
-    0x00,0x28,0x02,0xd0,0xae,0x42,0x97,0xd1,0x93,0xe7,0xae,0x42,0x94,0xd0,
-    0x25,0x60,0x92,0xe7,0x3c,0x80,0x00,0x40,0x30,0x80,0x00,0x40,0xbf,0xfd,
-    0xff,0xff,0x00,0xc0,0x00,0x40,0x00,0x40,0x02,0x40,0xa0,0xba,0xfa,0x00,
-    0x00,0x80,0x02,0x40,0x00,0xc0,0x02,0x40,0x48,0x80,0x00,0x40,0x60,0x80,
-    0x00,0x40,0x54,0x80,0x00,0x40,0x00,0x80,0x05,0x40,0x01,0x02,0x00,0x00,
-    0x00,0x40,0x05,0x40,0x00,0x1c,0x04,0x20,0x9b,0x58,0xa1,0x6c,0xfa,0xe3,
-    0x84,0x59,0x00,0x40,0x00,0x10,0xd0,0x1e,0x00,0x20,0x00,0x00,0x20,0x50,
-    0x00,0xe1,0x00,0xe0,0xf1,0x04,0x00,0x20,0x00,0xc0,0x01,0x40,0x00,0x40,
-    0x01,0x40,0x9b,0x59,0x27,0x21,0x37,0x5c,0x32,0xf4,0x8f,0xfa,0x0a,0x52,
-    0x90,0xaf,0x1a,0x40,0xf2,0x55,0x03,0x88,0x65,0x19,0x6d,0x1e,0x0c,0x1b,
-    0x00,0x20,0xd8,0x1f,0x00,0x20,0xdc,0x1f,0x00,0x20,0xc0,0xd4,0x01,0x00,
-    0xc0,0xb8,0x59,0x00,0x00,0xf0,0x00,0x40,0xf1,0x03,0x00,0x00,0x10,0x1b,
-    0x00,0x20,0x00,0x23,0x23,0x60,0x43,0xe7,0xa5,0x7b,0xed,0xb2,0x7d,0x60,
-    0x00,0x2d,0x00,0xd1,0x38,0xe1,0xb9,0x4b,0x1e,0x78,0xf3,0x07,0x4c,0xd4,
-    0x07,0x2d,0x00,0xd8,0x31,0xe1,0x23,0x00,0xf8,0x33,0x1b,0x78,0x01,0x2b,
-    0x40,0xd1,0x23,0x00,0xf9,0x33,0x1b,0x78,0x88,0x2b,0x3b,0xd1,0x23,0x00,
-    0xfb,0x33,0x1b,0x78,0x02,0x33,0x9b,0x00,0xfb,0x60,0x08,0x3b,0x78,0x2b,
-    0x32,0xd8,0xfb,0x68,0x9d,0x42,0x00,0xd2,0x1a,0xe1,0xab,0x4b,0xfa,0x68,
-    0x9b,0x5c,0x99,0x2b,0x29,0xd1,0xa9,0x4b,0x9b,0x5c,0x03,0x2b,0x25,0xd1,
-    0x91,0x1f,0xa8,0x48,0xff,0xf7,0x6c,0xf9,0xa7,0x4b,0xfa,0x68,0xf9,0x68,
-    0x9a,0x5c,0xa6,0x4b,0x12,0x02,0x5b,0x5c,0x13,0x43,0x83,0x42,0x17,0xd1,
-    0x02,0x23,0x9e,0x43,0x9d,0x4b,0x10,0x20,0x1e,0x70,0x58,0x23,0x38,0x18,
-    0x0a,0x00,0xc0,0x18,0xa0,0x49,0x00,0xf0,0xfa,0xf9,0xbb,0x6e,0x18,0x0c,
-    0xc0,0xb2,0x11,0x38,0x05,0x28,0x00,0xd9,0xaa,0xe0,0x00,0xf0,0x4d,0xf9,
-    0x41,0x61,0x9f,0xb5,0xc5,0xd9,0x01,0x23,0x1e,0x43,0x91,0x4b,0x1e,0x70,
-    0x96,0x4c,0x2a,0x00,0x01,0x21,0x20,0x00,0x00,0xf0,0x7e,0xf9,0x8d,0x4b,
-    0x00,0x28,0x05,0xd0,0x01,0x21,0x1a,0x78,0x8a,0x43,0x1a,0x70,0x02,0x1b,
-    0x7a,0x60,0x02,0x22,0x19,0x78,0x11,0x42,0x08,0xd1,0x11,0x43,0x10,0x20,
-    0x19,0x70,0x58,0x23,0x38,0x18,0xf1,0x21,0xc0,0x18,0xff,0xf7,0x3a,0xfd,
-    0x00,0x20,0x89,0x4d,0xae,0x7b,0xf6,0xb2,0x7b,0x68,0xf4,0x1a,0x0a,0xd0,
-    0x19,0x18,0x22,0x1a,0xf8,0x31,0xf8,0x30,0x49,0x19,0x40,0x19,0x00,0xf0,
-    0x03,0xfa,0x01,0x23,0x20,0x00,0x6b,0x73,0xef,0xf3,0x10,0x82,0x72,0xb6,
-    0x7f,0x49,0x8b,0x7b,0xdb,0xb2,0x9e,0x42,0x00,0xd1,0xad,0xe0,0x82,0xf3,
-    0x10,0x88,0xe2,0xe7,0x6d,0x46,0x8a,0xb0,0x6c,0x46,0x20,0x22,0x00,0x21,
-    0x20,0x00,0x00,0xf0,0x3a,0xfa,0x80,0x23,0x5b,0x02,0xa3,0x60,0x76,0x4b,
-    0x20,0x00,0xe3,0x60,0x40,0x23,0x06,0x22,0x23,0x61,0x74,0x49,0x14,0x30,
-    0x00,0xf0,0x9b,0xf9,0x11,0x23,0x08,0x22,0x63,0x60,0xa0,0x21,0x20,0x00,
-    0xff,0xf7,0x00,0xfd,0xad,0x46,0xfb,0x68,0x7b,0x60,0xc1,0xe7,0x1b,0x0e,
-    0x11,0x2b,0x44,0xd1,0xfc,0x6e,0x6b,0x4b,0x9c,0x42,0x40,0xd9,0xa3,0x06,
-    0x3e,0xd1,0x22,0x00,0x81,0x23,0x40,0x32,0x5b,0x05,0x9a,0x42,0x38,0xd8,
-    0x67,0x4e,0x67,0x4d,0x33,0x68,0x00,0x2b,0x08,0xd0,0x2b,0x68,0x9c,0x42,
-    0x03,0xd3,0x01,0x33,0xff,0x33,0x9a,0x42,0x0c,0xd9,0xff,0xf7,0xf1,0xf8,
-    0x01,0x23,0xff,0x21,0x33,0x60,0x80,0x22,0x23,0x00,0x52,0x00,0x8b,0x43,
-    0x5e,0x48,0x2b,0x60,0x00,0xf0,0xfa,0xf9,0x28,0x68,0x5c,0x4b,0x10,0x25,
-    0x20,0x1a,0xc0,0x18,0x60,0x23,0x79,0x19,0xc9,0x18,0x40,0x22,0x00,0xf0,
-    0x5d,0xf9,0x12,0x23,0x04,0x22,0xa0,0x21,0xfb,0x61,0x3c,0x62,0x0a,0x3b,
-    0x78,0x19,0xc0,0x18,0xff,0xf7,0xbf,0xfc,0xbe,0xe7,0x4f,0x4b,0x1b,0x68,
-    0x00,0x2b,0x01,0xd0,0xff,0xf7,0xca,0xf8,0x4f,0x4b,0x1b,0x68,0x00,0x2b,
-    0x02,0xda,0xff,0xf7,0xf8,0xfc,0xb1,0xe7,0x3b,0x62,0x10,0x20,0x13,0x23,
-    0x04,0x22,0xfb,0x61,0xa0,0x21,0x0b,0x3b,0x38,0x18,0xe5,0xe7,0xfb,0x6e,
-    0x10,0x24,0x19,0x00,0x3b,0x62,0x14,0x23,0x38,0x19,0x40,0x22,0xc0,0x18,
-    0x00,0xf0,0x32,0xf9,0x14,0x22,0xa0,0x21,0xfa,0x61,0x08,0x23,0x38,0x19,
-    0xd5,0xe7,0x15,0x23,0x10,0x20,0xfb,0x61,0x38,0x18,0x0d,0x3b,0x03,0x22,
-    0xc0,0x18,0xa0,0x21,0xff,0xf7,0x8e,0xfc,0x01,0x22,0x3b,0x4b,0x1a,0x70,
-    0xbb,0x68,0x3a,0x4a,0x9b,0x6a,0x9b,0x18,0x3a,0x4a,0x13,0x60,0x84,0xe7,
-    0x10,0x26,0x08,0x25,0xbb,0x19,0x14,0x22,0x00,0x21,0x58,0x19,0x00,0xf0,
-    0xa2,0xf9,0x63,0x68,0x05,0x22,0x3b,0x62,0x23,0x89,0xa0,0x21,0xbb,0x84,
-    0x16,0x23,0xfb,0x61,0xbb,0x19,0x58,0x19,0xaf,0xe7,0x8c,0x73,0x82,0xf3,
-    0x10,0x88,0x23,0x4b,0x9a,0x7a,0xd2,0xb2,0x00,0x2a,0x00,0xd1,0xd6,0xe5,
-    0x00,0x22,0x9a,0x72,0x1a,0x68,0x00,0x2a,0x02,0xd1,0x1a,0x73,0xda,0x72,
-    0xce,0xe5,0x08,0x26,0x01,0x32,0xba,0x66,0xdc,0x7a,0x1b,0x7b,0xfb,0x60,
-    0xfb,0x68,0x1b,0x1b,0x1d,0x00,0x08,0x2b,0x00,0xdd,0x35,0x00,0x00,0x2b,
-    0x19,0xdd,0x21,0x00,0x15,0x4b,0x98,0x31,0x10,0x20,0xc9,0x18,0x60,0x23,
-    0x38,0x18,0x2a,0x00,0xc0,0x18,0xfd,0x66,0x00,0xf0,0xda,0xf8,0x10,0x22,
-    0x58,0x23,0xba,0x18,0xd0,0x18,0xff,0xf7,0xdc,0xf8,0x00,0x28,0x05,0xdb,
-    0xfb,0x6e,0x7b,0x60,0x00,0x2b,0x01,0xd0,0x64,0x19,0xdd,0xe7,0x08,0x4b,
-    0xdc,0x72,0xa3,0xe5,0xc0,0x46,0xe4,0x1f,0x00,0x20,0x02,0x1c,0x00,0x20,
-    0x03,0x1c,0x00,0x20,0x06,0x1c,0x00,0x20,0x01,0x1c,0x00,0x20,0x00,0x1c,
-    0x00,0x20,0x04,0x1c,0x00,0x20,0x0c,0x1b,0x00,0x20,0x00,0x40,0x00,0x10,
-    0x28,0x17,0x00,0x20,0xff,0x3f,0x00,0x10,0xc8,0x1e,0x00,0x20,0xcc,0x1e,
-    0x00,0x20,0xc8,0x1d,0x00,0x20,0xe0,0x1f,0x00,0x20,0xd8,0x1f,0x00,0x20,
-    0x80,0x4f,0x12,0x00,0xdc,0x1f,0x00,0x20,0x02,0xb4,0x71,0x46,0x49,0x08,
-    0x49,0x00,0x09,0x5c,0x49,0x00,0x8e,0x44,0x02,0xbc,0x70,0x47,0xc0,0x46,
-    0x03,0xb4,0x71,0x46,0x49,0x08,0x40,0x00,0x49,0x00,0x09,0x5e,0x49,0x00,
-    0x8e,0x44,0x03,0xbc,0x70,0x47,0xf0,0xb5,0xce,0x46,0x47,0x46,0x15,0x04,
-    0x2d,0x0c,0x2e,0x00,0x80,0xb5,0x07,0x04,0x14,0x0c,0x3f,0x0c,0x99,0x46,
-    0x03,0x0c,0x7e,0x43,0x5d,0x43,0x67,0x43,0x63,0x43,0x7f,0x19,0x34,0x0c,
-    0xe4,0x19,0x9c,0x46,0xa5,0x42,0x03,0xd9,0x80,0x23,0x5b,0x02,0x98,0x46,
-    0xc4,0x44,0x4b,0x46,0x43,0x43,0x51,0x43,0x25,0x0c,0x36,0x04,0x65,0x44,
-    0x36,0x0c,0x24,0x04,0xa4,0x19,0x5b,0x19,0x59,0x18,0x20,0x00,0x0c,0xbc,
-    0x90,0x46,0x99,0x46,0xf0,0xbd,0x70,0xb5,0xcc,0xb2,0x83,0x07,0x34,0xd0,
-    0x53,0x1e,0x00,0x2a,0x1b,0xd0,0x02,0x78,0xa2,0x42,0x19,0xd0,0x03,0x25,
-    0x04,0xe0,0x01,0x3b,0x14,0xd3,0x02,0x78,0xa2,0x42,0x12,0xd0,0x01,0x30,
-    0x28,0x42,0xf7,0xd1,0x03,0x2b,0x0e,0xd8,0x00,0x2b,0x0a,0xd0,0x02,0x78,
-    0xa2,0x42,0x08,0xd0,0xc3,0x18,0x02,0xe0,0x02,0x78,0xa2,0x42,0x03,0xd0,
-    0x01,0x30,0x83,0x42,0xf9,0xd1,0x00,0x20,0x70,0xbd,0xff,0x22,0x0d,0x06,
-    0x2d,0x0c,0x11,0x40,0x29,0x43,0x0d,0x04,0x08,0x4e,0x0d,0x43,0x02,0x68,
-    0x07,0x49,0x6a,0x40,0x51,0x18,0x91,0x43,0x31,0x42,0xe3,0xd1,0x04,0x3b,
-    0x04,0x30,0x03,0x2b,0xf4,0xd8,0xdc,0xe7,0x13,0x00,0xd8,0xe7,0xc0,0x46,
-    0x80,0x80,0x80,0x80,0xff,0xfe,0xfe,0xfe,0x30,0xb5,0x03,0x2a,0x1c,0xd9,
-    0x03,0x00,0x0b,0x43,0x9b,0x07,0x0f,0xd0,0x04,0x78,0x0b,0x78,0x9c,0x42,
-    0x17,0xd1,0x01,0x23,0x05,0xe0,0xc4,0x5c,0x5d,0x1c,0xcb,0x5c,0x9c,0x42,
-    0x10,0xd1,0x2b,0x00,0x93,0x42,0xf7,0xd1,0x00,0x20,0x30,0xbd,0x03,0x68,
-    0x0c,0x68,0xa3,0x42,0xeb,0xd1,0x04,0x3a,0x04,0x30,0x04,0x31,0x03,0x2a,
-    0xf6,0xd8,0x00,0x2a,0xe4,0xd1,0xf1,0xe7,0xe0,0x1a,0xf0,0xe7,0xc0,0x46,
-    0xf0,0xb5,0x0f,0x2a,0x38,0xd9,0x0d,0x00,0x05,0x43,0x0c,0x00,0x03,0x00,
-    0xad,0x07,0x36,0xd1,0x10,0x27,0x15,0x00,0xbc,0x46,0x10,0x3d,0x2d,0x09,
-    0x2e,0x01,0x36,0x18,0xb4,0x44,0x27,0x68,0x66,0x68,0x1f,0x60,0x5e,0x60,
-    0xa7,0x68,0xe6,0x68,0x9f,0x60,0xde,0x60,0x10,0x33,0x10,0x34,0x63,0x45,
-    0xf3,0xd1,0x0f,0x24,0x01,0x35,0x2d,0x01,0x49,0x19,0x14,0x40,0x45,0x19,
-    0x03,0x2c,0x1c,0xd9,0x00,0x23,0xce,0x58,0xee,0x50,0x04,0x33,0xe6,0x1a,
-    0x03,0x2e,0xf9,0xd8,0x03,0x23,0x04,0x3c,0xa4,0x08,0x01,0x34,0xa4,0x00,
-    0x2d,0x19,0x09,0x19,0x1a,0x40,0x05,0xd0,0x00,0x23,0xcc,0x5c,0xec,0x54,
-    0x01,0x33,0x93,0x42,0xfa,0xd1,0xf0,0xbd,0x05,0x00,0x00,0x2a,0xf5,0xd1,
-    0xfa,0xe7,0x05,0x00,0xf2,0xe7,0x22,0x00,0xf8,0xe7,0xf0,0xb5,0x88,0x42,
-    0x0a,0xd9,0x8b,0x18,0x98,0x42,0x07,0xd2,0x53,0x1e,0x00,0x2a,0x03,0xd0,
-    0xca,0x5c,0xc2,0x54,0x01,0x3b,0xfb,0xd2,0xf0,0xbd,0x0f,0x2a,0x09,0xd8,
-    0x05,0x00,0x00,0x2a,0xf9,0xd0,0x00,0x23,0xcc,0x5c,0xec,0x54,0x01,0x33,
-    0x93,0x42,0xfa,0xd1,0xf2,0xe7,0x0d,0x00,0x05,0x43,0x0c,0x00,0x03,0x00,
-    0xad,0x07,0x29,0xd1,0x15,0x00,0x10,0x3d,0x2d,0x09,0x2f,0x01,0x3f,0x18,
-    0x10,0x37,0x26,0x68,0x1e,0x60,0x66,0x68,0x5e,0x60,0xa6,0x68,0x9e,0x60,
-    0xe6,0x68,0x10,0x34,0xde,0x60,0x10,0x33,0xbb,0x42,0xf3,0xd1,0x0f,0x24,
-    0x01,0x35,0x2d,0x01,0x49,0x19,0x14,0x40,0x45,0x19,0x03,0x2c,0x11,0xd9,
-    0x00,0x23,0xce,0x58,0xee,0x50,0x04,0x33,0xe6,0x1a,0x03,0x2e,0xf9,0xd8,
-    0x03,0x23,0x04,0x3c,0xa4,0x08,0x01,0x34,0xa4,0x00,0x2d,0x19,0x09,0x19,
-    0x1a,0x40,0xc6,0xe7,0x05,0x00,0xc6,0xe7,0x22,0x00,0xc2,0xe7,0xf0,0xb5,
-    0x83,0x07,0x46,0xd0,0x54,0x1e,0x00,0x2a,0x42,0xd0,0xce,0xb2,0x02,0x00,
-    0x03,0x25,0x02,0xe0,0x1a,0x00,0x01,0x3c,0x3b,0xd3,0x53,0x1c,0x16,0x70,
-    0x2b,0x42,0xf8,0xd1,0x03,0x2c,0x2d,0xd9,0xff,0x22,0x0a,0x40,0x15,0x02,
-    0x15,0x43,0x2a,0x04,0x15,0x43,0x0f,0x2c,0x16,0xd9,0x27,0x00,0x10,0x3f,
-    0x3f,0x09,0x3e,0x01,0xb4,0x46,0x1e,0x00,0x1a,0x00,0x10,0x36,0x66,0x44,
-    0x15,0x60,0x55,0x60,0x95,0x60,0xd5,0x60,0x10,0x32,0xb2,0x42,0xf8,0xd1,
-    0x0f,0x22,0x01,0x37,0x3f,0x01,0xdb,0x19,0x14,0x40,0x03,0x2c,0x0e,0xd9,
-    0x26,0x1f,0xb6,0x08,0xb7,0x00,0xbc,0x46,0x1a,0x00,0x1f,0x1d,0x67,0x44,
-    0x20,0xc2,0xba,0x42,0xfc,0xd1,0x03,0x22,0x01,0x36,0xb6,0x00,0x9b,0x19,
-    0x14,0x40,0x00,0x2c,0x05,0xd0,0xc9,0xb2,0x1c,0x19,0x19,0x70,0x01,0x33,
-    0x9c,0x42,0xfb,0xd1,0xf0,0xbd,0x14,0x00,0x03,0x00,0xc3,0xe7,0xc0,0x46,
-    0x72,0x70,0x32,0x30,0x34,0x30,0x00,0x00,0x85,0x00,0x48,0x00,0x29,0xe0,
-    0xcc,0x00,0x00,0xc0,0xc0,0x00,0x40,0xc0,0x29,0xe4,0x43,0xf0,0x04,0xc1,
-    0xc5,0x03,0x07,0x03,0x43,0x00,0xc4,0x20,0x01,0x40,0x46,0xa0,0xb2,0x01,
-    0x02,0xc0,0xeb,0x40,0x54,0x40,0x47,0xa0,0x80,0x80,0x27,0xa0,0x98,0x00,
-    0xe2,0xa0,0x21,0x60,0xdf,0x00,0x01,0xb8,0xd9,0x02,0x58,0x00,0x21,0x60,
-    0x1b,0x01,0x00,0x00,0x99,0x45,0xab,0x4e,0x32,0x0b,0xcf,0x58,0x56,0x1d,
-    0x64,0x16,0xfd,0x53,0x07,0x74,0x9e,0x31,0xac,0x3a,0x35,0x7f,0xc8,0x2c,
-    0x51,0x69,0x63,0x62,0xfa,0x27,0x97,0x2d,0x0e,0x68,0x3c,0x63,0xa5,0x26,
-    0x58,0x75,0xc1,0x30,0xf3,0x3b,0x6a,0x7e,0x90,0x59,0x09,0x1c,0x3b,0x17,
-    0xa2,0x52,0x5f,0x01,0xc6,0x44,0xf4,0x4f,0x6d,0x0a,0x2e,0x5b,0xb7,0x1e,
-    0x85,0x15,0x1c,0x50,0xe1,0x03,0x78,0x46,0x4a,0x4d,0xd3,0x08,0x29,0x2f,
-    0xb0,0x6a,0x82,0x61,0x1b,0x24,0xe6,0x77,0x7f,0x32,0x4d,0x39,0xd4,0x7c,
-    0xb9,0x76,0x20,0x33,0x12,0x38,0x8b,0x7d,0x76,0x2e,0xef,0x6b,0xdd,0x60,
-    0x44,0x25,0xbe,0x02,0x27,0x47,0x15,0x4c,0x8c,0x09,0x71,0x5a,0xe8,0x1f,
-    0xda,0x14,0x43,0x51,0xc5,0x73,0x5c,0x36,0x6e,0x3d,0xf7,0x78,0x0a,0x2b,
-    0x93,0x6e,0xa1,0x65,0x38,0x20,0xc2,0x07,0x5b,0x42,0x69,0x49,0xf0,0x0c,
-    0x0d,0x5f,0x94,0x1a,0xa6,0x11,0x3f,0x54,0x52,0x5e,0xcb,0x1b,0xf9,0x10,
-    0x60,0x55,0x9d,0x06,0x04,0x43,0x36,0x48,0xaf,0x0d,0x55,0x2a,0xcc,0x6f,
-    0xfe,0x64,0x67,0x21,0x9a,0x72,0x03,0x37,0x31,0x3c,0xa8,0x79,0xeb,0x28,
-    0x72,0x6d,0x40,0x66,0xd9,0x23,0x24,0x70,0xbd,0x35,0x8f,0x3e,0x16,0x7b,
-    0xec,0x5c,0x75,0x19,0x47,0x12,0xde,0x57,0x23,0x04,0xba,0x41,0x88,0x4a,
-    0x11,0x0f,0x7c,0x05,0xe5,0x40,0xd7,0x4b,0x4e,0x0e,0xb3,0x5d,0x2a,0x18,
-    0x18,0x13,0x81,0x56,0x7b,0x71,0xe2,0x34,0xd0,0x3f,0x49,0x7a,0xb4,0x29,
-    0x2d,0x6c,0x1f,0x67,0x86,0x22,0x13,0x22,0x8a,0x67,0xb8,0x6c,0x21,0x29,
-    0xdc,0x7a,0x45,0x3f,0x77,0x34,0xee,0x71,0x14,0x56,0x8d,0x13,0xbf,0x18,
-    0x26,0x5d,0xdb,0x0e,0x42,0x4b,0x70,0x40,0xe9,0x05,0x84,0x0f,0x1d,0x4a,
-    0x2f,0x41,0xb6,0x04,0x4b,0x57,0xd2,0x12,0xe0,0x19,0x79,0x5c,0x83,0x7b,
-    0x1a,0x3e,0x28,0x35,0xb1,0x70,0x4c,0x23,0xd5,0x66,0xe7,0x6d,0x7e,0x28,
-    0x3d,0x79,0xa4,0x3c,0x96,0x37,0x0f,0x72,0xf2,0x21,0x6b,0x64,0x59,0x6f,
-    0xc0,0x2a,0x3a,0x0d,0xa3,0x48,0x91,0x43,0x08,0x06,0xf5,0x55,0x6c,0x10,
-    0x5e,0x1b,0xc7,0x5e,0xaa,0x54,0x33,0x11,0x01,0x1a,0x98,0x5f,0x65,0x0c,
-    0xfc,0x49,0xce,0x42,0x57,0x07,0xad,0x20,0x34,0x65,0x06,0x6e,0x9f,0x2b,
-    0x62,0x78,0xfb,0x3d,0xc9,0x36,0x50,0x73,0xd6,0x51,0x4f,0x14,0x7d,0x1f,
-    0xe4,0x5a,0x19,0x09,0x80,0x4c,0xb2,0x47,0x2b,0x02,0xd1,0x25,0x48,0x60,
-    0x7a,0x6b,0xe3,0x2e,0x1e,0x7d,0x87,0x38,0xb5,0x33,0x2c,0x76,0x41,0x7c,
-    0xd8,0x39,0xea,0x32,0x73,0x77,0x8e,0x24,0x17,0x61,0x25,0x6a,0xbc,0x2f,
-    0x46,0x08,0xdf,0x4d,0xed,0x46,0x74,0x03,0x89,0x50,0x10,0x15,0x22,0x1e,
-    0xbb,0x5b,0xf8,0x0a,0x61,0x4f,0x53,0x44,0xca,0x01,0x37,0x52,0xae,0x17,
-    0x9c,0x1c,0x05,0x59,0xff,0x7e,0x66,0x3b,0x54,0x30,0xcd,0x75,0x30,0x26,
-    0xa9,0x63,0x9b,0x68,0x02,0x2d,0x6f,0x27,0xf6,0x62,0xc4,0x69,0x5d,0x2c,
-    0xa0,0x7f,0x39,0x3a,0x0b,0x31,0x92,0x74,0x68,0x53,0xf1,0x16,0xc3,0x1d,
-    0x5a,0x58,0xa7,0x0b,0x3e,0x4e,0x0c,0x45,0x95,0x00,0x43,0x1e,0x98,0x41,
-    0x05,0x4b,0x02,0x30,0x1b,0x68,0x00,0x02,0x58,0x40,0xc0,0x23,0x9b,0x00,
-    0x18,0x40,0x02,0x4b,0x18,0x60,0x70,0x47,0xc0,0x46,0x0c,0x80,0x01,0x40,
-    0x0c,0x90,0x01,0x40,0x10,0xb5,0x02,0x4b,0x01,0x33,0x98,0x47,0x10,0xbd,
-    0xc0,0x46,0xc4,0x1c,0x00,0x20,0x09,0x4a,0x30,0xb5,0x13,0x78,0x00,0x2b,
-    0x0d,0xd1,0x80,0x23,0x07,0x4c,0x08,0x49,0x5b,0x05,0xf0,0x20,0x1d,0x68,
-    0x00,0x06,0x18,0x18,0x04,0x33,0x25,0x50,0x8b,0x42,0xf7,0xd1,0x01,0x23,
-    0x13,0x70,0x30,0xbd,0xc4,0x1d,0x00,0x20,0xc4,0x1c,0x00,0x20,0x00,0x01,
-    0x00,0x10,0xf7,0xb5,0x05,0x00,0x0f,0x48,0xfe,0xf7,0x39,0xfd,0x07,0x00,
-    0x0e,0x48,0xfe,0xf7,0x35,0xfd,0x06,0x00,0x0d,0x48,0xfe,0xf7,0x31,0xfd,
-    0x04,0x00,0x0c,0x48,0xfe,0xf7,0x2d,0xfd,0x01,0x90,0xff,0xf7,0xd2,0xff,
-    0xb8,0x47,0xb0,0x47,0x80,0x22,0x11,0x00,0x28,0x00,0x52,0x02,0x49,0x01,
-    0xd8,0x23,0xa0,0x47,0x01,0x9b,0x98,0x47,0xff,0xf7,0xbd,0xff,0xf7,0xbd,
-    0x49,0x46,0x00,0x00,0x45,0x58,0x00,0x00,0x52,0x45,0x00,0x00,0x46,0x43,
-    0x00,0x00,0xf7,0xb5,0x05,0x00,0x0e,0x48,0xfe,0xf7,0x0f,0xfd,0x07,0x00,
-    0x0d,0x48,0xfe,0xf7,0x0b,0xfd,0x06,0x00,0x0c,0x48,0xfe,0xf7,0x07,0xfd,
-    0x04,0x00,0x0b,0x48,0xfe,0xf7,0x03,0xfd,0x01,0x90,0xff,0xf7,0xa8,0xff,
-    0xb8,0x47,0xb0,0x47,0x80,0x22,0x28,0x00,0x52,0x00,0x07,0x49,0xa0,0x47,
-    0x01,0x9b,0x98,0x47,0xff,0xf7,0x95,0xff,0xf7,0xbd,0x49,0x46,0x00,0x00,
-    0x45,0x58,0x00,0x00,0x52,0x50,0x00,0x00,0x46,0x43,0x00,0x00,0xc8,0x1d,
-    0x00,0x20,0xf7,0xb5,0x04,0x00,0x1e,0x48,0x0d,0x00,0xfe,0xf7,0xe4,0xfc,
-    0x07,0x00,0x1d,0x48,0xfe,0xf7,0xe0,0xfc,0x06,0x00,0x1c,0x48,0xfe,0xf7,
-    0xdc,0xfc,0x01,0x90,0xff,0xf7,0x81,0xff,0xb8,0x47,0xb0,0x47,0x00,0x20,
-    0xff,0xf7,0x62,0xff,0x0d,0x23,0x08,0x20,0xc0,0x21,0x1a,0x00,0x84,0x46,
-    0x02,0x26,0x49,0x05,0x10,0x00,0x18,0x43,0x07,0xd1,0x01,0x30,0xff,0xf7,
-    0x55,0xff,0x01,0x9b,0x98,0x47,0xff,0xf7,0x63,0xff,0xf7,0xbd,0x67,0x46,
-    0x88,0x6a,0x07,0x40,0x30,0x42,0x08,0xd0,0x00,0x2a,0x06,0xd0,0x98,0x1a,
-    0x0d,0x28,0x03,0xd8,0x20,0x78,0x01,0x3a,0x08,0x66,0x01,0x34,0x00,0x2f,
-    0xe4,0xd0,0x00,0x2b,0xe2,0xd0,0x08,0x6e,0x01,0x3b,0x28,0x70,0x01,0x35,
-    0xdd,0xe7,0xc0,0x46,0x49,0x46,0x00,0x00,0x45,0x58,0x00,0x00,0x46,0x43,
-    0x00,0x00,0xff,0xff,0xff,0xff,
-};
-
-const uint32_t deployer_canboot_binary_size = 7492;
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/katapult.uf2 and /home/mks/firmware_comparison/downloads/CanBoot/out/katapult.uf2 differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/katapult.work and /home/mks/firmware_comparison/downloads/CanBoot/out/katapult.work differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/can2040/can2040.d /home/mks/firmware_comparison/downloads/CanBoot/out/lib/can2040/can2040.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/can2040/can2040.d	2023-08-14 03:03:12.448400091 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/lib/can2040/can2040.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,28 +0,0 @@
-out/src/../lib/can2040/can2040.o: src/../lib/can2040/can2040.c \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- /usr/include/newlib/string.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/newlib.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/reent.h \
- /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h lib/rp2040/cmsis_include/RP2040.h \
- lib/cmsis-core/core_cm0plus.h lib/cmsis-core/cmsis_version.h \
- lib/cmsis-core/cmsis_compiler.h lib/cmsis-core/cmsis_gcc.h \
- lib/cmsis-core/mpu_armv7.h lib/rp2040/cmsis_include/system_RP2040.h \
- src/../lib/can2040/can2040.h lib/rp2040/hardware/regs/dreq.h \
- lib/rp2040/hardware/structs/dma.h lib/rp2040/hardware/address_mapped.h \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/dma.h \
- lib/rp2040/hardware/structs/iobank0.h \
- lib/rp2040/hardware/regs/io_bank0.h \
- lib/rp2040/hardware/structs/padsbank0.h \
- lib/rp2040/hardware/regs/pads_bank0.h lib/rp2040/hardware/structs/pio.h \
- lib/rp2040/hardware/regs/pio.h lib/rp2040/hardware/structs/resets.h \
- lib/rp2040/hardware/regs/resets.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/can2040/can2040.o and /home/mks/firmware_comparison/downloads/CanBoot/out/lib/can2040/can2040.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/fast-hash/fasthash.d /home/mks/firmware_comparison/downloads/CanBoot/out/lib/fast-hash/fasthash.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/fast-hash/fasthash.d	2023-08-14 03:03:13.840400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/lib/fast-hash/fasthash.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,21 +0,0 @@
-out/src/../lib/fast-hash/fasthash.o: src/../lib/fast-hash/fasthash.c \
- src/../lib/fast-hash/fasthash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- /usr/include/newlib/stdio.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/newlib.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/cdefs.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- /usr/include/newlib/sys/reent.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/types.h \
- /usr/include/newlib/machine/endian.h \
- /usr/include/newlib/machine/_endian.h /usr/include/newlib/sys/select.h \
- /usr/include/newlib/sys/_sigset.h /usr/include/newlib/sys/_timeval.h \
- /usr/include/newlib/sys/timespec.h /usr/include/newlib/sys/_timespec.h \
- /usr/include/newlib/sys/_pthreadtypes.h /usr/include/newlib/sys/sched.h \
- /usr/include/newlib/machine/types.h /usr/include/newlib/sys/stdio.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/fast-hash/fasthash.o and /home/mks/firmware_comparison/downloads/CanBoot/out/lib/fast-hash/fasthash.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/rp2040/elf2uf2/elf2uf2 and /home/mks/firmware_comparison/downloads/CanBoot/out/lib/rp2040/elf2uf2/elf2uf2 differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/rp2040/pico/flash/hw_flash.d /home/mks/firmware_comparison/downloads/CanBoot/out/lib/rp2040/pico/flash/hw_flash.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/rp2040/pico/flash/hw_flash.d	2023-08-14 03:03:09.840400090 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/lib/rp2040/pico/flash/hw_flash.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,15 +0,0 @@
-out/src/../lib/rp2040/pico/flash/hw_flash.o: \
- src/../lib/rp2040/pico/flash/hw_flash.c \
- src/../lib/rp2040/pico/flash/hw_flash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdbool.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- lib/rp2040/hardware/structs/ssi.h lib/rp2040/hardware/address_mapped.h \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/ssi.h \
- lib/rp2040/hardware/structs/ioqspi.h lib/rp2040/hardware/regs/io_qspi.h \
- lib/rp2040/pico/bootrom/bootrom.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/lib/rp2040/pico/flash/hw_flash.o and /home/mks/firmware_comparison/downloads/CanBoot/out/lib/rp2040/pico/flash/hw_flash.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/bootentry.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/bootentry.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/bootentry.d	2023-08-14 03:03:06.692400088 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/bootentry.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,17 +0,0 @@
-out/src/bootentry.o: src/bootentry.c /usr/include/newlib/string.h \
- /usr/include/newlib/_ansi.h /usr/include/newlib/newlib.h \
- /usr/include/newlib/_newlib_version.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/features.h \
- /usr/include/newlib/sys/reent.h /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/autoconf.h out/board/flash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h out/board/gpio.h \
- out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h src/bootentry.h \
- src/canboot.h src/ctr.h src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/bootentry.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/bootentry.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/bootentry.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/bootentry.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/command.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/command.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/command.d	2023-08-14 03:03:07.044400088 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/command.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,17 +0,0 @@
-out/src/command.o: src/command.c /usr/include/newlib/string.h \
- /usr/include/newlib/_ansi.h /usr/include/newlib/newlib.h \
- /usr/include/newlib/_newlib_version.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/features.h \
- /usr/include/newlib/sys/reent.h /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/autoconf.h \
- out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h src/byteorder.h src/command.h \
- src/ctr.h src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/command.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/command.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/flashcmd.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/flashcmd.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/flashcmd.d	2023-08-14 03:03:07.340400088 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/flashcmd.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,17 +0,0 @@
-out/src/flashcmd.o: src/flashcmd.c /usr/include/newlib/string.h \
- /usr/include/newlib/_ansi.h /usr/include/newlib/newlib.h \
- /usr/include/newlib/_newlib_version.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/features.h \
- /usr/include/newlib/sys/reent.h /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/autoconf.h out/board/flash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h src/byteorder.h \
- src/canboot.h src/command.h src/ctr.h src/compiler.h src/flashcmd.h \
- src/sched.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/flashcmd.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/flashcmd.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/flashcmd.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/flashcmd.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/armcm_irq.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/armcm_irq.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/armcm_irq.d	2023-08-14 03:03:10.104400090 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/armcm_irq.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,11 +0,0 @@
-out/src/generic/armcm_irq.o: src/generic/armcm_irq.c out/board/internal.h \
- lib/rp2040/cmsis_include/RP2040.h lib/cmsis-core/core_cm0plus.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- lib/cmsis-core/cmsis_version.h lib/cmsis-core/cmsis_compiler.h \
- lib/cmsis-core/cmsis_gcc.h lib/cmsis-core/mpu_armv7.h \
- lib/rp2040/cmsis_include/system_RP2040.h src/generic/irq.h src/sched.h \
- src/ctr.h src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/armcm_irq.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/armcm_irq.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/armcm_irq.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/armcm_irq.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canbus.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canbus.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canbus.d	2023-08-14 03:03:13.568400091 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canbus.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,10 +0,0 @@
-out/src/generic/canbus.o: src/generic/canbus.c out/autoconf.h \
- src/generic/canbus.h /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- src/generic/canserial.h src/command.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h src/ctr.h \
- src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canbus.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canbus.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canbus.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canbus.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canserial.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canserial.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canserial.d	2023-08-14 03:03:13.368400091 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canserial.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,26 +0,0 @@
-out/src/generic/canserial.o: src/generic/canserial.c \
- /usr/include/newlib/string.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/newlib.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/config.h /usr/include/newlib/machine/ieeefp.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/sys/reent.h \
- /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/board-generic/board/io.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h src/compiler.h \
- out/board-generic/board/irq.h out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h src/generic/canbus.h \
- src/generic/canserial.h src/command.h src/ctr.h src/compiler.h \
- lib/fast-hash/fasthash.h /usr/include/newlib/stdio.h \
- /usr/include/newlib/sys/types.h /usr/include/newlib/machine/endian.h \
- /usr/include/newlib/machine/_endian.h /usr/include/newlib/sys/select.h \
- /usr/include/newlib/sys/_sigset.h /usr/include/newlib/sys/_timeval.h \
- /usr/include/newlib/sys/timespec.h /usr/include/newlib/sys/_timespec.h \
- /usr/include/newlib/sys/_pthreadtypes.h /usr/include/newlib/sys/sched.h \
- /usr/include/newlib/machine/types.h /usr/include/newlib/sys/stdio.h \
- src/sched.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canserial.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canserial.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/canserial.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/canserial.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/crc16_ccitt.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/crc16_ccitt.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/crc16_ccitt.d	2023-08-14 03:03:10.264400090 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/crc16_ccitt.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,7 +0,0 @@
-out/src/generic/crc16_ccitt.o: src/generic/crc16_ccitt.c \
- src/generic/misc.h /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/generic/crc16_ccitt.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/generic/crc16_ccitt.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/initial_pins.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/initial_pins.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/initial_pins.d	2023-08-14 03:03:07.496400089 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/initial_pins.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,8 +0,0 @@
-out/src/initial_pins.o: src/initial_pins.c out/autoconf.h \
- out/board/gpio.h /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- out/board-generic/board/pgm.h src/ctr.h src/compiler.h \
- src/initial_pins.h src/sched.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/initial_pins.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/initial_pins.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/initial_pins.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/initial_pins.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/armcm_canboot.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/armcm_canboot.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/armcm_canboot.d	2023-08-14 03:03:07.812400089 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/armcm_canboot.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,22 +0,0 @@
-out/src/rp2040/armcm_canboot.o: src/rp2040/armcm_canboot.c \
- /usr/include/newlib/string.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/newlib.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/config.h /usr/include/newlib/machine/ieeefp.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/sys/reent.h \
- /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h src/generic/armcm_boot.h src/ctr.h \
- src/compiler.h out/autoconf.h out/board/internal.h \
- lib/rp2040/cmsis_include/RP2040.h lib/cmsis-core/core_cm0plus.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h lib/cmsis-core/cmsis_version.h \
- lib/cmsis-core/cmsis_compiler.h lib/cmsis-core/cmsis_gcc.h \
- lib/cmsis-core/mpu_armv7.h lib/rp2040/cmsis_include/system_RP2040.h \
- out/board-generic/board/irq.h out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h src/canboot.h \
- src/command.h src/ctr.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/armcm_canboot.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/armcm_canboot.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/armcm_canboot.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/armcm_canboot.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/can.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/can.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/can.d	2023-08-14 03:03:10.592400090 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/can.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,35 +0,0 @@
-out/src/rp2040/can.o: src/rp2040/can.c \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- /usr/include/newlib/string.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/newlib.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/reent.h \
- /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/autoconf.h \
- out/board-generic/board/armcm_boot.h src/ctr.h src/compiler.h \
- out/board-generic/board/io.h src/compiler.h lib/can2040/can2040.h \
- src/command.h /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- src/ctr.h lib/fast-hash/fasthash.h /usr/include/newlib/stdio.h \
- /usr/include/newlib/sys/types.h /usr/include/newlib/machine/endian.h \
- /usr/include/newlib/machine/_endian.h /usr/include/newlib/sys/select.h \
- /usr/include/newlib/sys/_sigset.h /usr/include/newlib/sys/_timeval.h \
- /usr/include/newlib/sys/timespec.h /usr/include/newlib/sys/_timespec.h \
- /usr/include/newlib/sys/_pthreadtypes.h /usr/include/newlib/sys/sched.h \
- /usr/include/newlib/machine/types.h /usr/include/newlib/sys/stdio.h \
- src/generic/canbus.h src/generic/canserial.h \
- lib/rp2040/hardware/structs/resets.h \
- lib/rp2040/hardware/address_mapped.h \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/resets.h \
- src/rp2040/internal.h lib/rp2040/cmsis_include/RP2040.h \
- lib/cmsis-core/core_cm0plus.h lib/cmsis-core/cmsis_version.h \
- lib/cmsis-core/cmsis_compiler.h lib/cmsis-core/cmsis_gcc.h \
- lib/cmsis-core/mpu_armv7.h lib/rp2040/cmsis_include/system_RP2040.h \
- src/sched.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/can.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/can.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/can.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/can.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/chipid.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/chipid.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/chipid.d	2023-08-14 03:03:10.816400090 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/chipid.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,19 +0,0 @@
-out/src/rp2040/chipid.o: src/rp2040/chipid.c /usr/include/newlib/string.h \
- /usr/include/newlib/_ansi.h /usr/include/newlib/newlib.h \
- /usr/include/newlib/_newlib_version.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/features.h \
- /usr/include/newlib/sys/reent.h /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/autoconf.h \
- lib/rp2040/pico/flash/hw_flash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdbool.h \
- out/board-generic/board/irq.h out/board-generic/board/canserial.h \
- src/generic/usb_cdc.h src/generic/usbstd.h src/compiler.h src/sched.h \
- src/ctr.h src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/chipid.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/chipid.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/chipid.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/chipid.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/flash.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/flash.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/flash.d	2023-08-14 03:03:09.480400089 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/flash.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,17 +0,0 @@
-out/src/rp2040/flash.o: src/rp2040/flash.c src/rp2040/flash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- /usr/include/newlib/string.h /usr/include/newlib/_ansi.h \
- /usr/include/newlib/newlib.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/reent.h \
- /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/autoconf.h src/generic/irq.h \
- lib/rp2040/pico/flash/hw_flash.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdbool.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/flash.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/flash.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/gpio.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/gpio.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/gpio.d	2023-08-14 03:03:08.740400089 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/gpio.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,27 +0,0 @@
-out/src/rp2040/gpio.o: src/rp2040/gpio.c /usr/include/newlib/string.h \
- /usr/include/newlib/_ansi.h /usr/include/newlib/newlib.h \
- /usr/include/newlib/_newlib_version.h /usr/include/newlib/sys/config.h \
- /usr/include/newlib/machine/ieeefp.h /usr/include/newlib/sys/features.h \
- /usr/include/newlib/sys/reent.h /usr/include/newlib/_ansi.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stddef.h \
- /usr/include/newlib/sys/_types.h /usr/include/newlib/machine/_types.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/lock.h /usr/include/newlib/sys/cdefs.h \
- /usr/include/newlib/xlocale.h /usr/include/newlib/strings.h \
- /usr/include/newlib/sys/string.h out/board-generic/board/irq.h \
- src/command.h /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h /usr/include/newlib/sys/_intsup.h \
- /usr/include/newlib/sys/_stdint.h src/ctr.h src/compiler.h \
- src/rp2040/gpio.h lib/rp2040/hardware/structs/iobank0.h \
- lib/rp2040/hardware/address_mapped.h \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/io_bank0.h \
- lib/rp2040/hardware/structs/padsbank0.h \
- lib/rp2040/hardware/regs/pads_bank0.h lib/rp2040/hardware/structs/sio.h \
- lib/rp2040/hardware/regs/sio.h lib/rp2040/hardware/structs/interp.h \
- src/rp2040/internal.h lib/rp2040/cmsis_include/RP2040.h \
- lib/cmsis-core/core_cm0plus.h lib/cmsis-core/cmsis_version.h \
- lib/cmsis-core/cmsis_compiler.h lib/cmsis-core/cmsis_gcc.h \
- lib/cmsis-core/mpu_armv7.h lib/rp2040/cmsis_include/system_RP2040.h \
- src/sched.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/gpio.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/gpio.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/gpio.o.ctr and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/gpio.o.ctr differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/main.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/main.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/main.d	2023-08-14 03:03:08.144400089 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/main.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,22 +0,0 @@
-out/src/rp2040/main.o: src/rp2040/main.c \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- lib/rp2040/hardware/structs/clocks.h \
- lib/rp2040/hardware/address_mapped.h \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/clocks.h \
- lib/rp2040/hardware/structs/pll.h lib/rp2040/hardware/regs/pll.h \
- lib/rp2040/hardware/structs/resets.h lib/rp2040/hardware/regs/resets.h \
- lib/rp2040/hardware/structs/watchdog.h \
- lib/rp2040/hardware/regs/watchdog.h lib/rp2040/hardware/structs/xosc.h \
- lib/rp2040/hardware/regs/xosc.h src/rp2040/internal.h \
- lib/rp2040/cmsis_include/RP2040.h lib/cmsis-core/core_cm0plus.h \
- lib/cmsis-core/cmsis_version.h lib/cmsis-core/cmsis_compiler.h \
- lib/cmsis-core/cmsis_gcc.h lib/cmsis-core/mpu_armv7.h \
- lib/rp2040/cmsis_include/system_RP2040.h src/sched.h src/ctr.h \
- src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/main.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/main.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/rp2040_link.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/rp2040_link.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/rp2040_link.d	2023-08-14 03:03:14.812400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/rp2040_link.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,2 +0,0 @@
-out/src/rp2040/rp2040_link.ld: src/rp2040/rp2040_link.lds.S \
- /usr/include/stdc-predef.h out/autoconf.h
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/rp2040_link.ld /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/rp2040_link.ld
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/rp2040_link.ld	2023-08-14 03:03:14.812400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/rp2040_link.ld	1969-12-31 19:00:00.000000000 -0500
@@ -1,50 +0,0 @@
-OUTPUT_FORMAT("elf32-littlearm", "elf32-littlearm", "elf32-littlearm")
-OUTPUT_ARCH(arm)
-MEMORY
-{
-  rom (rx) : ORIGIN = 0x10000000 , LENGTH = 0x200000
-  ram (rwx) : ORIGIN = 0x20000000 , LENGTH = 0x42000
-}
-SECTIONS
-{
-    .text : {
-        . = ALIGN(4);
-        KEEP(*(.boot2))
-        KEEP(*(.vector_table_flash))
-        KEEP(*(.reset_handler_flash))
-        KEEP(*(.reset_handler_flash.*))
-    } > rom
-    . = ALIGN(4);
-    _data_flash = .;
-    .data : AT (_data_flash)
-    {
-        . = ALIGN(128);
-        _data_start = .;
-        KEEP(*(.vector_table))
-        *(.text .text.*)
-        *(.rodata .rodata*)
-        *(.ramfunc .ramfunc.*);
-        *(.data .data.*);
-        . = ALIGN(4);
-        _data_end = .;
-    } > ram
-    .bss (NOLOAD) :
-    {
-        . = ALIGN(4);
-        _bss_start = .;
-        *(.bss .bss.*)
-        *(COMMON)
-        . = ALIGN(4);
-        _bss_end = .;
-    } > ram
-    _stack_start = 0x20000000 + 0x42000 - 512 - 1024;
-    .stack _stack_start (NOLOAD) :
-    {
-        . = . + 512;
-        _stack_end = .;
-    } > ram
-    /DISCARD/ : {
-        *(.init)
-        *(.fini)
-    }
-}
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/timer.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/timer.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/timer.d	2023-08-14 03:03:09.216400089 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/timer.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,19 +0,0 @@
-out/src/rp2040/timer.o: src/rp2040/timer.c out/autoconf.h \
- out/board-generic/board/armcm_boot.h src/ctr.h src/compiler.h \
- out/board-generic/board/irq.h out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- src/canboot.h lib/rp2040/hardware/structs/resets.h \
- lib/rp2040/hardware/address_mapped.h \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/resets.h \
- lib/rp2040/hardware/structs/timer.h lib/rp2040/hardware/regs/timer.h \
- src/rp2040/internal.h lib/rp2040/cmsis_include/RP2040.h \
- lib/cmsis-core/core_cm0plus.h lib/cmsis-core/cmsis_version.h \
- lib/cmsis-core/cmsis_compiler.h lib/cmsis-core/cmsis_gcc.h \
- lib/cmsis-core/mpu_armv7.h lib/rp2040/cmsis_include/system_RP2040.h \
- src/sched.h src/ctr.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/rp2040/timer.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/rp2040/timer.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/sched.d /home/mks/firmware_comparison/downloads/CanBoot/out/src/sched.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/sched.d	2023-08-14 03:03:06.476400088 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/src/sched.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,9 +0,0 @@
-out/src/sched.o: src/sched.c out/board-generic/board/io.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdint.h \
- /usr/include/newlib/stdint.h \
- /usr/include/newlib/machine/_default_types.h \
- /usr/include/newlib/sys/features.h /usr/include/newlib/_newlib_version.h \
- /usr/include/newlib/sys/_intsup.h /usr/include/newlib/sys/_stdint.h \
- src/compiler.h out/board-generic/board/misc.h \
- /usr/lib/gcc/arm-none-eabi/7.3.1/include/stdarg.h src/bootentry.h \
- src/canboot.h src/deployer.h src/sched.h src/ctr.h src/compiler.h
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/src/sched.o and /home/mks/firmware_comparison/downloads/CanBoot/out/src/sched.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2.d /home/mks/firmware_comparison/downloads/CanBoot/out/stage2.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2.d	2023-08-14 03:03:14.752400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/stage2.d	1969-12-31 19:00:00.000000000 -0500
@@ -1 +0,0 @@
-out/stage2.o: out/stage2.S
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2.o and /home/mks/firmware_comparison/downloads/CanBoot/out/stage2.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2raw1.d /home/mks/firmware_comparison/downloads/CanBoot/out/stage2raw1.d
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2raw1.d	2023-08-14 03:03:14.476400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/stage2raw1.d	1969-12-31 19:00:00.000000000 -0500
@@ -1,8 +0,0 @@
-out/stage2raw1.o: lib/rp2040/boot_stage2/boot2_w25q080.S \
- lib/rp2040/hardware/regs/addressmap.h \
- lib/rp2040/hardware/platform_defs.h lib/rp2040/hardware/regs/ssi.h \
- lib/rp2040/hardware/regs/pads_qspi.h \
- lib/rp2040/boot_stage2/asminclude/boot2_helpers/exit_from_boot2.S \
- lib/rp2040/hardware/regs/m0plus.h \
- lib/rp2040/boot_stage2/asminclude/boot2_helpers/wait_ssi_ready.S \
- lib/rp2040/boot_stage2/asminclude/boot2_helpers/read_flash_sreg.S
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2raw1.o and /home/mks/firmware_comparison/downloads/CanBoot/out/stage2raw1.o differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2raw.bin and /home/mks/firmware_comparison/downloads/CanBoot/out/stage2raw.bin differ
Binary files /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2raw.o and /home/mks/firmware_comparison/downloads/CanBoot/out/stage2raw.o differ
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2.S /home/mks/firmware_comparison/downloads/CanBoot/out/stage2.S
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/out/stage2.S	2023-08-14 03:03:14.708400092 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/out/stage2.S	1969-12-31 19:00:00.000000000 -0500
@@ -1,23 +0,0 @@
-// Padded and checksummed version of: out/stage2raw.bin
-
-.cpu cortex-m0plus
-.thumb
-
-.section .boot2, "ax"
-
-.byte 0x00, 0xb5, 0x32, 0x4b, 0x21, 0x20, 0x58, 0x60, 0x98, 0x68, 0x02, 0x21, 0x88, 0x43, 0x98, 0x60
-.byte 0xd8, 0x60, 0x18, 0x61, 0x58, 0x61, 0x2e, 0x4b, 0x00, 0x21, 0x99, 0x60, 0x02, 0x21, 0x59, 0x61
-.byte 0x01, 0x21, 0xf0, 0x22, 0x99, 0x50, 0x2b, 0x49, 0x19, 0x60, 0x01, 0x21, 0x99, 0x60, 0x35, 0x20
-.byte 0x00, 0xf0, 0x44, 0xf8, 0x02, 0x22, 0x90, 0x42, 0x14, 0xd0, 0x06, 0x21, 0x19, 0x66, 0x00, 0xf0
-.byte 0x34, 0xf8, 0x19, 0x6e, 0x01, 0x21, 0x19, 0x66, 0x00, 0x20, 0x18, 0x66, 0x1a, 0x66, 0x00, 0xf0
-.byte 0x2c, 0xf8, 0x19, 0x6e, 0x19, 0x6e, 0x19, 0x6e, 0x05, 0x20, 0x00, 0xf0, 0x2f, 0xf8, 0x01, 0x21
-.byte 0x08, 0x42, 0xf9, 0xd1, 0x00, 0x21, 0x99, 0x60, 0x1b, 0x49, 0x19, 0x60, 0x00, 0x21, 0x59, 0x60
-.byte 0x1a, 0x49, 0x1b, 0x48, 0x01, 0x60, 0x01, 0x21, 0x99, 0x60, 0xeb, 0x21, 0x19, 0x66, 0xa0, 0x21
-.byte 0x19, 0x66, 0x00, 0xf0, 0x12, 0xf8, 0x00, 0x21, 0x99, 0x60, 0x16, 0x49, 0x14, 0x48, 0x01, 0x60
-.byte 0x01, 0x21, 0x99, 0x60, 0x01, 0xbc, 0x00, 0x28, 0x00, 0xd0, 0x00, 0x47, 0x12, 0x48, 0x13, 0x49
-.byte 0x08, 0x60, 0x03, 0xc8, 0x80, 0xf3, 0x08, 0x88, 0x08, 0x47, 0x03, 0xb5, 0x99, 0x6a, 0x04, 0x20
-.byte 0x01, 0x42, 0xfb, 0xd0, 0x01, 0x20, 0x01, 0x42, 0xf8, 0xd1, 0x03, 0xbd, 0x02, 0xb5, 0x18, 0x66
-.byte 0x18, 0x66, 0xff, 0xf7, 0xf2, 0xff, 0x18, 0x6e, 0x18, 0x6e, 0x02, 0xbd, 0x00, 0x00, 0x02, 0x40
-.byte 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x07, 0x00, 0x00, 0x03, 0x5f, 0x00, 0x21, 0x22, 0x00, 0x00
-.byte 0xf4, 0x00, 0x00, 0x18, 0x22, 0x20, 0x00, 0xa0, 0x00, 0x01, 0x00, 0x10, 0x08, 0xed, 0x00, 0xe0
-.byte 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x74, 0xb2, 0x4e, 0x7a
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/protocol.md /home/mks/firmware_comparison/downloads/CanBoot/protocol.md
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/protocol.md	2023-08-12 06:18:51.896709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/protocol.md	2024-10-08 17:45:28.585223681 -0400
@@ -34,11 +34,11 @@
 <0x01><0x88><0x11><0x00><CRC><0x99><0x03>
 ```
 
-Responds with [acknowledged](#acknowledged-0xa0) containing a 16 byte payload
+Responds with [acknowledged](#acknowledged-0xa0) containing a variable length payload
 in the following format:
 
 ```
-<4 byte orig_command><4 byte protocol_version><4 byte start_address><4 byte block_size><n byte mcu_type_string>
+<4 byte orig_command><4 byte protocol_version><4 byte start_address><4 byte block_size><n byte mcu_type_string><1 null byte><n byte software_version_string>
 ```
 
 - `orig_command` - must be `0x11`
@@ -51,6 +51,8 @@
 - `block_size` - the size of a block (in bytes) expected in the `send block` and
   `request block` commands.  Typically this should be 64 bytes.
 - `mcu_type_string` - The type of micro-controller (eg, "stm32f103xe").
+- `software_version_string` - The software version as reported by
+  `git describe --tags --always --long --dirty`.
 
 
 #### Send Block: `0x12`
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/README.md /home/mks/firmware_comparison/downloads/CanBoot/README.md
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/README.md	2023-08-12 06:18:50.848709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/README.md	2024-10-08 17:45:28.434223129 -0400
@@ -99,6 +99,11 @@
    flashtool.py -i can0 -q
    ```
 
+   **NOTE: A query should only be performed when a single can node is on
+   the network.  Attempting to query multiple nodes may result in transmission
+   errors that can force a node into a "bus off" state.  When a node enters
+   "bus off" it becomes unresponsive.  The node must be reset to recover.**
+
    For USB/UART devices:
    Before flashing, make sure pyserial is installed.  This step only needs to
    be performed once:
@@ -165,6 +170,11 @@
 
 ## Katapult Deployer
 
+**WARNING**: Make absolutely sure your Katapult build configuration is
+correct before uploading the deployer.  Overwriting your existing
+bootloader with an incorrectly configured build will brick your device
+and require a programmer to recover.
+
 The Katapult deployer allows a user to overwrite their existing bootloader
 with Katapult, allowing modification and updates without a programmer.  It
 is *strongly* recommended that an alternate recovery (programmer, DFU, etc)
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/scripts/flash_can.py /home/mks/firmware_comparison/downloads/CanBoot/scripts/flash_can.py
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/scripts/flash_can.py	2023-08-12 06:18:51.900709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/scripts/flash_can.py	2024-10-08 17:45:28.585223681 -0400
@@ -15,7 +15,16 @@
 import argparse
 import hashlib
 import pathlib
+import shutil
+import shlex
+import contextlib
 from typing import Dict, List, Optional, Union
+HAS_SERIAL = True
+try:
+    from serial import Serial, SerialException
+except ModuleNotFoundError:
+    HAS_SERIAL = False
+    SerialException = Exception
 
 def output_line(msg: str) -> None:
     sys.stdout.write(msg + "\n")
@@ -34,6 +43,7 @@
         crc = ((data << 8) | (crc >> 8)) ^ (data >> 4) ^ (data << 3)
     return crc & 0xFFFF
 
+
 logging.basicConfig(level=logging.INFO)
 CAN_FMT = "<IB3x8s"
 CAN_READER_LIMIT = 1024 * 1024
@@ -67,7 +77,7 @@
 CANBUS_RESP_NEED_NODEID = 0x20
 CANBUS_NODEID_OFFSET = 128
 
-class FlashCanError(Exception):
+class FlashError(Exception):
     pass
 
 class CanFlasher:
@@ -84,21 +94,30 @@
         self.block_count = 0
         self.app_start_addr = 0
 
-    async def connect_btl(self):
+    async def connect_btl(self) -> None:
         output_line("Attempting to connect to bootloader")
         ret = await self.send_command('CONNECT')
         pinfo = ret[:12]
-        mcu_type = ret[12:]
+        mcu_info = ret[12:]
+        ver_bytes: bytes
         ver_bytes, start_addr, self.block_size = struct.unpack("<4sII", pinfo)
         self.app_start_addr = start_addr
-        proto_version = ".".join([str(v) for v in reversed(ver_bytes[:3])])
+        self.software_version = "?"
+        self.proto_version = tuple([v for v in reversed(ver_bytes[:3])])
+        proto_version_str = ".".join([str(v) for v in self.proto_version])
         if self.block_size not in [64, 128, 256, 512]:
-            raise FlashCanError("Invalid Block Size: %d" % (self.block_size,))
-        while mcu_type and mcu_type[-1] == 0x00:
-            mcu_type = mcu_type[:-1]
-        mcu_type = mcu_type.decode()
+            raise FlashError("Invalid Block Size: %d" % (self.block_size,))
+        mcu_info.rstrip(b"\x00")
+        if self.proto_version >= (1, 1, 0):
+            mcu_bytes, sv_bytes = mcu_info.split(b"\x00", maxsplit=1)
+            mcu_type = mcu_bytes.decode()
+            self.software_version = sv_bytes.decode()
+        else:
+            mcu_type = mcu_info.decode()
         output_line(
-            f"Katapult Connected\nProtocol Version: {proto_version}\n"
+            f"Katapult Connected\n"
+            f"Software Version: {self.software_version}\n"
+            f"Protocol Version: {proto_version_str}\n"
             f"Block Size: {self.block_size} bytes\n"
             f"Application Start: 0x{self.app_start_addr:4X}\n"
             f"MCU type: {mcu_type}"
@@ -109,7 +128,7 @@
         ret = await self.send_command('GET_CANBUS_ID')
         mcu_uuid = sum([v << ((5 - i) * 8) for i, v in enumerate(ret[:6])])
         if mcu_uuid != uuid:
-            raise FlashCanError("UUID mismatch (%s vs %s)" % (uuid, mcu_uuid))
+            raise FlashError("UUID mismatch (%s vs %s)" % (uuid, mcu_uuid))
 
     async def send_command(
         self,
@@ -127,7 +146,7 @@
         crc = crc16_ccitt(out_cmd[2:])
         out_cmd.extend(struct.pack("<H", crc))
         out_cmd.extend(CMD_TRAILER)
-        err = Exception()
+        last_err = Exception()
         while tries:
             data = bytearray()
             recd_len = 0
@@ -144,15 +163,17 @@
                         recd_len = data[3] * 4
                         read_done = len(data) == recd_len + 8
                         break
+            except asyncio.CancelledError:
+                raise
             except asyncio.TimeoutError:
                 logging.info(
                     f"Response for command {cmdname} timed out, "
                     f"{tries - 1} tries remaining"
                 )
             except Exception as e:
-                if type(e) != type(err) or str(e) != str(err):
-                    err = e
-                    logging.exception("Can Read Error")
+                if type(e) is type(last_err) and e.args == last_err.args:
+                    last_err = e
+                    logging.exception("Device Read Error")
             else:
                 trailer = data[-2:]
                 recd_crc, = struct.unpack("<H", data[-4:-2])
@@ -186,12 +207,13 @@
             tries -= 1
             # clear the read buffer
             try:
-                await self.node.read(1024, timeout=.1)
+                ret = await self.node.read(1024, timeout=.25)
             except asyncio.TimeoutError:
                 pass
+            else:
+                logging.info(f"Read Buffer Contents: {ret!r}")
             await asyncio.sleep(.1)
-        raise FlashCanError("Error sending command [%s] to Can Device"
-                            % (cmdname))
+        raise FlashError("Error sending command [%s] to Device" % (cmdname))
 
     async def send_file(self):
         last_percent = 0
@@ -202,6 +224,7 @@
             self.file_size = f.tell()
             f.seek(0)
             flash_address = self.app_start_addr
+            recd_addr = 0
             while True:
                 buf = f.read(self.block_size)
                 if not buf:
@@ -221,7 +244,7 @@
                     )
                     await asyncio.sleep(.1)
                 else:
-                    raise FlashCanError(
+                    raise FlashError(
                         f"Flash write failed, block address 0x{recd_addr:4X}"
                     )
                 flash_address += self.block_size
@@ -255,7 +278,7 @@
                 await asyncio.sleep(.1)
             else:
                 output_line("Error")
-                raise FlashCanError("Block Request Error, block: %d" % (i,))
+                raise FlashError("Block Request Error, block: %d" % (i,))
             ver_sha.update(resp[4:])
             pct = int(i * self.block_size / float(self.file_size) * 100 + .5)
             if pct >= last_percent + 2:
@@ -264,7 +287,7 @@
         ver_hex = ver_sha.hexdigest().upper()
         fw_hex = self.fw_sha.hexdigest().upper()
         if ver_hex != fw_hex:
-            raise FlashCanError("Checksum mismatch: Expected %s, Received %s"
+            raise FlashError("Checksum mismatch: Expected %s, Received %s"
                                 % (fw_hex, ver_hex))
         output_line("]\n\nVerification Complete: SHA = %s" % (ver_hex))
 
@@ -273,23 +296,23 @@
 
 
 class CanNode:
-    def __init__(self, node_id: int, cansocket: CanSocket) -> None:
+    def __init__(self, node_id: int, cansocket: CanSocket | SerialSocket) -> None:
         self.node_id = node_id
         self._reader = asyncio.StreamReader(CAN_READER_LIMIT)
         self._cansocket = cansocket
 
     async def read(
-        self, n: int = -1, timeout: Optional[float] = 2
+        self, n: int = -1, timeout: Optional[float] = 5.
     ) -> bytes:
         return await asyncio.wait_for(self._reader.read(n), timeout)
 
     async def readexactly(
-        self, n: int, timeout: Optional[float] = 2
+        self, n: int, timeout: Optional[float] = 5.
     ) -> bytes:
         return await asyncio.wait_for(self._reader.readexactly(n), timeout)
 
     async def readuntil(
-        self, sep: bytes = b"\x03", timeout: Optional[float] = 2
+        self, sep: bytes = b"\x03", timeout: Optional[float] = 5.
     ) -> bytes:
         return await asyncio.wait_for(self._reader.readuntil(sep), timeout)
 
@@ -453,27 +476,22 @@
         self, intf: str, uuid: int, fw_path: pathlib.Path, req_only: bool
     ) -> None:
         if not req_only and not fw_path.is_file():
-            raise FlashCanError("Invalid firmware path '%s'" % (fw_path))
+            raise FlashError("Invalid firmware path '%s'" % (fw_path))
         try:
             self.cansock.bind((intf,))
         except Exception:
-            raise FlashCanError("Unable to bind socket to can0")
+            raise FlashError("Unable to bind socket to can0")
         self.closed = False
         self.cansock.setblocking(False)
         self._loop.add_reader(
             self.cansock.fileno(), self._handle_can_response)
         self._jump_to_bootloader(uuid)
+        await asyncio.sleep(.5)
         if req_only:
             output_line("Bootloader request command sent")
             return
-        await asyncio.sleep(.5)
         self._reset_nodes()
-        await asyncio.sleep(.5)
-        id_list = await self._query_uuids()
-        if uuid not in id_list:
-            raise FlashCanError(
-                f"Unable to find node matching UUID: {uuid:012x}"
-            )
+        await asyncio.sleep(1.0)
         node = self._set_node_id(uuid)
         flasher = CanFlasher(node, fw_path)
         await asyncio.sleep(.5)
@@ -492,7 +510,7 @@
         try:
             self.cansock.bind((intf,))
         except Exception:
-            raise FlashCanError("Unable to bind socket to can0")
+            raise FlashError("Unable to bind socket to can0")
         self.closed = False
         self.cansock.setblocking(False)
         self._loop.add_reader(
@@ -513,42 +531,92 @@
 class SerialSocket:
     def __init__(self, loop: asyncio.AbstractEventLoop):
         self._loop = loop
-        self.serial = self.serial_error = None
+        self.serial: Optional[Serial] = None
         self.node = CanNode(0, self)
 
     def _handle_response(self) -> None:
+        assert self.serial is not None
         try:
             data = self.serial.read(4096)
-        except self.serial_error as e:
+        except SerialException:
             logging.exception("Error on serial read")
             self.close()
-        self.node.feed_data(data)
+        else:
+            self.node.feed_data(data)
 
     def send(self, can_id: int, payload: bytes = b"") -> None:
+        assert self.serial is not None
         try:
             self.serial.write(payload)
-        except self.serial_error as e:
+        except SerialException:
             logging.exception("Error on serial write")
             self.close()
 
+    async def _lookup_proc_name(self, process_id: str) -> str:
+        has_sysctl = shutil.which("systemctl") is not None
+        if has_sysctl:
+            cmd = shlex.split(f"systemctl status {process_id}")
+            proc = await asyncio.create_subprocess_exec(
+                *cmd,
+                stdout=asyncio.subprocess.PIPE,
+                stderr=asyncio.subprocess.PIPE
+            )
+            stdout, _ = await proc.communicate()
+            resp = stdout.strip().decode(errors="ignore")
+            if resp:
+                unit = resp.split(maxsplit=2)
+                if len(unit) == 3:
+                    return f"Systemd Unit Name: {unit[1]}"
+        cmdline_file = pathlib.Path(f"/proc/{process_id}/cmdline")
+        if cmdline_file.exists():
+            res = cmdline_file.read_text().replace("\x00", " ").strip()
+            return f"Command Line: {res}"
+        exe_file = pathlib.Path(f"/proc/{process_id}/exe")
+        if exe_file.exists():
+            return f"Executable: {exe_file.resolve()})"
+        return "Name Unknown"
+
+    async def validate_device(self, dev_strpath: str) -> None:
+        dev_path = pathlib.Path(dev_strpath)
+        if not dev_path.exists():
+            raise FlashError(f"No Serial Device found at {dev_path}")
+        try:
+            dev_st = dev_path.stat()
+        except PermissionError as e:
+            raise FlashError(f"No permission to access device {dev_path}") from e
+        dev_id = (dev_st.st_dev, dev_st.st_ino)
+        for fd_dir in pathlib.Path("/proc").glob("*/fd"):
+            pid = fd_dir.parent.name
+            if not pid.isdigit():
+                continue
+            with contextlib.suppress(OSError):
+                for item in fd_dir.iterdir():
+                    try:
+                        item_st = item.stat()
+                    except OSError:
+                        continue
+                    item_id = (item_st.st_dev, item_st.st_ino)
+                    if item_id == dev_id:
+                        proc_name = await self._lookup_proc_name(pid)
+                        output_line(
+                            f"Serial device {dev_path} in use by another program.\n"
+                            f"Process ID: {pid}\n"
+                            f"Process {proc_name}"
+                        )
+                        raise FlashError(f"Serial device {dev_path} in use")
+
     async def run(self, intf: str, baud: int, fw_path: pathlib.Path) -> None:
         if not fw_path.is_file():
-            raise FlashCanError("Invalid firmware path '%s'" % (fw_path))
-        try:
-            import serial
-        except ModuleNotFoundError:
-            raise FlashCanError(
-                "The pyserial python package was not found.  To install "
-                "run the following command in a terminal: \n\n"
-                "   pip3 install pyserial\n\n")
-        self.serial_error = serial.SerialException
+            raise FlashError("Invalid firmware path '%s'" % (fw_path))
+        await self.validate_device(intf)
         try:
-            serial_dev = serial.Serial(baudrate=baud, timeout=0,
-                                       exclusive=True)
+            serial_dev = Serial(                            # type: ignore
+                baudrate=baud, timeout=0, exclusive=True
+            )
             serial_dev.port = intf
             serial_dev.open()
-        except (OSError, IOError, self.serial_error) as e:
-            raise FlashCanError("Unable to open serial port: %s" % (e,))
+        except (OSError, IOError, SerialException) as e:
+            raise FlashError("Unable to open serial port: %s" % (e,))
         self.serial = serial_dev
         self._loop.add_reader(self.serial.fileno(), self._handle_response)
         flasher = CanFlasher(self.node, fw_path)
@@ -569,7 +637,59 @@
         self.serial.close()
         self.serial = None
 
-def main():
+async def main(args: argparse.Namespace) -> int:
+    if not args.verbose:
+        logging.getLogger().setLevel(logging.ERROR)
+    intf = args.interface
+    fpath = pathlib.Path(args.firmware).expanduser().resolve()
+    loop = asyncio.get_running_loop()
+    iscan = args.device is None
+    req_only = args.request_bootloader
+    sock: CanSocket | SerialSocket | None = None
+    try:
+        if iscan:
+            sock = CanSocket(loop)
+            if args.query:
+                await sock.run_query(intf)
+            else:
+                if args.uuid is None:
+                    raise FlashError(
+                        "The 'uuid' option must be specified to flash a device"
+                    )
+                output_line(f"Flashing CAN UUID {args.uuid} on interface {intf}")
+                uuid = int(args.uuid, 16)
+                await sock.run(intf, uuid, fpath, req_only)
+        else:
+            if not HAS_SERIAL:
+                ser_inst_cmd = "pip3 install serial"
+                if shutil.which("apt") is not None:
+                    ser_inst_cmd = "sudo apt install python3-serial"
+                raise FlashError(
+                    "The pyserial python package was not found.  To install "
+                    "run the following command in a terminal: \n\n"
+                    f"   {ser_inst_cmd}\n\n"
+                )
+            if args.device is None:
+                raise FlashError(
+                    "The 'device' option must be specified to flash a device"
+                )
+            output_line(f"Flashing Serial Device {args.device}, baud {args.baud}")
+            sock = SerialSocket(loop)
+            await sock.run(args.device, args.baud, fpath)
+    except Exception:
+        logging.exception("Flash Error")
+        return -1
+    finally:
+        if sock is not None:
+            sock.close()
+    if args.query:
+        output_line("Query Complete")
+    else:
+        output_line("Flash Success")
+    return 0
+
+
+if __name__ == '__main__':
     parser = argparse.ArgumentParser(
         description="Katapult Flash Tool")
     parser.add_argument(
@@ -606,44 +726,4 @@
     )
 
     args = parser.parse_args()
-    if not args.verbose:
-        logging.getLogger().setLevel(logging.ERROR)
-    intf = args.interface
-    fpath = pathlib.Path(args.firmware).expanduser().resolve()
-    loop = asyncio.get_event_loop()
-    iscan = args.device is None
-    req_only = args.request_bootloader
-    sock = None
-    try:
-        if iscan:
-            sock = CanSocket(loop)
-            if args.query:
-                loop.run_until_complete(sock.run_query(intf))
-            else:
-                if args.uuid is None:
-                    raise FlashCanError(
-                        "The 'uuid' option must be specified to flash a device"
-                    )
-                uuid = int(args.uuid, 16)
-                loop.run_until_complete(sock.run(intf, uuid, fpath, req_only))
-        else:
-            if args.device is None:
-                raise FlashCanError(
-                    "The 'device' option must be specified to flash a device"
-                )
-            sock = SerialSocket(loop)
-            loop.run_until_complete(sock.run(args.device, args.baud, fpath))
-    except Exception as e:
-        logging.exception("Flash Error")
-        sys.exit(-1)
-    finally:
-        if sock is not None:
-            sock.close()
-    if args.query:
-        output_line("Query Complete")
-    else:
-        output_line("Flash Success")
-
-
-if __name__ == '__main__':
-    main()
+    exit(asyncio.run(main(args)))
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/scripts/flashtool.py /home/mks/firmware_comparison/downloads/CanBoot/scripts/flashtool.py
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/scripts/flashtool.py	2023-08-12 06:18:51.900709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/scripts/flashtool.py	2024-10-08 17:45:28.585223681 -0400
@@ -15,7 +15,16 @@
 import argparse
 import hashlib
 import pathlib
+import shutil
+import shlex
+import contextlib
 from typing import Dict, List, Optional, Union
+HAS_SERIAL = True
+try:
+    from serial import Serial, SerialException
+except ModuleNotFoundError:
+    HAS_SERIAL = False
+    SerialException = Exception
 
 def output_line(msg: str) -> None:
     sys.stdout.write(msg + "\n")
@@ -34,6 +43,7 @@
         crc = ((data << 8) | (crc >> 8)) ^ (data >> 4) ^ (data << 3)
     return crc & 0xFFFF
 
+
 logging.basicConfig(level=logging.INFO)
 CAN_FMT = "<IB3x8s"
 CAN_READER_LIMIT = 1024 * 1024
@@ -67,7 +77,7 @@
 CANBUS_RESP_NEED_NODEID = 0x20
 CANBUS_NODEID_OFFSET = 128
 
-class FlashCanError(Exception):
+class FlashError(Exception):
     pass
 
 class CanFlasher:
@@ -84,21 +94,30 @@
         self.block_count = 0
         self.app_start_addr = 0
 
-    async def connect_btl(self):
+    async def connect_btl(self) -> None:
         output_line("Attempting to connect to bootloader")
         ret = await self.send_command('CONNECT')
         pinfo = ret[:12]
-        mcu_type = ret[12:]
+        mcu_info = ret[12:]
+        ver_bytes: bytes
         ver_bytes, start_addr, self.block_size = struct.unpack("<4sII", pinfo)
         self.app_start_addr = start_addr
-        proto_version = ".".join([str(v) for v in reversed(ver_bytes[:3])])
+        self.software_version = "?"
+        self.proto_version = tuple([v for v in reversed(ver_bytes[:3])])
+        proto_version_str = ".".join([str(v) for v in self.proto_version])
         if self.block_size not in [64, 128, 256, 512]:
-            raise FlashCanError("Invalid Block Size: %d" % (self.block_size,))
-        while mcu_type and mcu_type[-1] == 0x00:
-            mcu_type = mcu_type[:-1]
-        mcu_type = mcu_type.decode()
+            raise FlashError("Invalid Block Size: %d" % (self.block_size,))
+        mcu_info.rstrip(b"\x00")
+        if self.proto_version >= (1, 1, 0):
+            mcu_bytes, sv_bytes = mcu_info.split(b"\x00", maxsplit=1)
+            mcu_type = mcu_bytes.decode()
+            self.software_version = sv_bytes.decode()
+        else:
+            mcu_type = mcu_info.decode()
         output_line(
-            f"Katapult Connected\nProtocol Version: {proto_version}\n"
+            f"Katapult Connected\n"
+            f"Software Version: {self.software_version}\n"
+            f"Protocol Version: {proto_version_str}\n"
             f"Block Size: {self.block_size} bytes\n"
             f"Application Start: 0x{self.app_start_addr:4X}\n"
             f"MCU type: {mcu_type}"
@@ -109,7 +128,7 @@
         ret = await self.send_command('GET_CANBUS_ID')
         mcu_uuid = sum([v << ((5 - i) * 8) for i, v in enumerate(ret[:6])])
         if mcu_uuid != uuid:
-            raise FlashCanError("UUID mismatch (%s vs %s)" % (uuid, mcu_uuid))
+            raise FlashError("UUID mismatch (%s vs %s)" % (uuid, mcu_uuid))
 
     async def send_command(
         self,
@@ -127,7 +146,7 @@
         crc = crc16_ccitt(out_cmd[2:])
         out_cmd.extend(struct.pack("<H", crc))
         out_cmd.extend(CMD_TRAILER)
-        err = Exception()
+        last_err = Exception()
         while tries:
             data = bytearray()
             recd_len = 0
@@ -144,15 +163,17 @@
                         recd_len = data[3] * 4
                         read_done = len(data) == recd_len + 8
                         break
+            except asyncio.CancelledError:
+                raise
             except asyncio.TimeoutError:
                 logging.info(
                     f"Response for command {cmdname} timed out, "
                     f"{tries - 1} tries remaining"
                 )
             except Exception as e:
-                if type(e) != type(err) or str(e) != str(err):
-                    err = e
-                    logging.exception("Can Read Error")
+                if type(e) is type(last_err) and e.args == last_err.args:
+                    last_err = e
+                    logging.exception("Device Read Error")
             else:
                 trailer = data[-2:]
                 recd_crc, = struct.unpack("<H", data[-4:-2])
@@ -186,12 +207,13 @@
             tries -= 1
             # clear the read buffer
             try:
-                await self.node.read(1024, timeout=.1)
+                ret = await self.node.read(1024, timeout=.25)
             except asyncio.TimeoutError:
                 pass
+            else:
+                logging.info(f"Read Buffer Contents: {ret!r}")
             await asyncio.sleep(.1)
-        raise FlashCanError("Error sending command [%s] to Can Device"
-                            % (cmdname))
+        raise FlashError("Error sending command [%s] to Device" % (cmdname))
 
     async def send_file(self):
         last_percent = 0
@@ -202,6 +224,7 @@
             self.file_size = f.tell()
             f.seek(0)
             flash_address = self.app_start_addr
+            recd_addr = 0
             while True:
                 buf = f.read(self.block_size)
                 if not buf:
@@ -221,7 +244,7 @@
                     )
                     await asyncio.sleep(.1)
                 else:
-                    raise FlashCanError(
+                    raise FlashError(
                         f"Flash write failed, block address 0x{recd_addr:4X}"
                     )
                 flash_address += self.block_size
@@ -255,7 +278,7 @@
                 await asyncio.sleep(.1)
             else:
                 output_line("Error")
-                raise FlashCanError("Block Request Error, block: %d" % (i,))
+                raise FlashError("Block Request Error, block: %d" % (i,))
             ver_sha.update(resp[4:])
             pct = int(i * self.block_size / float(self.file_size) * 100 + .5)
             if pct >= last_percent + 2:
@@ -264,7 +287,7 @@
         ver_hex = ver_sha.hexdigest().upper()
         fw_hex = self.fw_sha.hexdigest().upper()
         if ver_hex != fw_hex:
-            raise FlashCanError("Checksum mismatch: Expected %s, Received %s"
+            raise FlashError("Checksum mismatch: Expected %s, Received %s"
                                 % (fw_hex, ver_hex))
         output_line("]\n\nVerification Complete: SHA = %s" % (ver_hex))
 
@@ -273,23 +296,23 @@
 
 
 class CanNode:
-    def __init__(self, node_id: int, cansocket: CanSocket) -> None:
+    def __init__(self, node_id: int, cansocket: CanSocket | SerialSocket) -> None:
         self.node_id = node_id
         self._reader = asyncio.StreamReader(CAN_READER_LIMIT)
         self._cansocket = cansocket
 
     async def read(
-        self, n: int = -1, timeout: Optional[float] = 2
+        self, n: int = -1, timeout: Optional[float] = 5.
     ) -> bytes:
         return await asyncio.wait_for(self._reader.read(n), timeout)
 
     async def readexactly(
-        self, n: int, timeout: Optional[float] = 2
+        self, n: int, timeout: Optional[float] = 5.
     ) -> bytes:
         return await asyncio.wait_for(self._reader.readexactly(n), timeout)
 
     async def readuntil(
-        self, sep: bytes = b"\x03", timeout: Optional[float] = 2
+        self, sep: bytes = b"\x03", timeout: Optional[float] = 5.
     ) -> bytes:
         return await asyncio.wait_for(self._reader.readuntil(sep), timeout)
 
@@ -453,27 +476,22 @@
         self, intf: str, uuid: int, fw_path: pathlib.Path, req_only: bool
     ) -> None:
         if not req_only and not fw_path.is_file():
-            raise FlashCanError("Invalid firmware path '%s'" % (fw_path))
+            raise FlashError("Invalid firmware path '%s'" % (fw_path))
         try:
             self.cansock.bind((intf,))
         except Exception:
-            raise FlashCanError("Unable to bind socket to can0")
+            raise FlashError("Unable to bind socket to can0")
         self.closed = False
         self.cansock.setblocking(False)
         self._loop.add_reader(
             self.cansock.fileno(), self._handle_can_response)
         self._jump_to_bootloader(uuid)
+        await asyncio.sleep(.5)
         if req_only:
             output_line("Bootloader request command sent")
             return
-        await asyncio.sleep(.5)
         self._reset_nodes()
-        await asyncio.sleep(.5)
-        id_list = await self._query_uuids()
-        if uuid not in id_list:
-            raise FlashCanError(
-                f"Unable to find node matching UUID: {uuid:012x}"
-            )
+        await asyncio.sleep(1.0)
         node = self._set_node_id(uuid)
         flasher = CanFlasher(node, fw_path)
         await asyncio.sleep(.5)
@@ -492,7 +510,7 @@
         try:
             self.cansock.bind((intf,))
         except Exception:
-            raise FlashCanError("Unable to bind socket to can0")
+            raise FlashError("Unable to bind socket to can0")
         self.closed = False
         self.cansock.setblocking(False)
         self._loop.add_reader(
@@ -513,42 +531,92 @@
 class SerialSocket:
     def __init__(self, loop: asyncio.AbstractEventLoop):
         self._loop = loop
-        self.serial = self.serial_error = None
+        self.serial: Optional[Serial] = None
         self.node = CanNode(0, self)
 
     def _handle_response(self) -> None:
+        assert self.serial is not None
         try:
             data = self.serial.read(4096)
-        except self.serial_error as e:
+        except SerialException:
             logging.exception("Error on serial read")
             self.close()
-        self.node.feed_data(data)
+        else:
+            self.node.feed_data(data)
 
     def send(self, can_id: int, payload: bytes = b"") -> None:
+        assert self.serial is not None
         try:
             self.serial.write(payload)
-        except self.serial_error as e:
+        except SerialException:
             logging.exception("Error on serial write")
             self.close()
 
+    async def _lookup_proc_name(self, process_id: str) -> str:
+        has_sysctl = shutil.which("systemctl") is not None
+        if has_sysctl:
+            cmd = shlex.split(f"systemctl status {process_id}")
+            proc = await asyncio.create_subprocess_exec(
+                *cmd,
+                stdout=asyncio.subprocess.PIPE,
+                stderr=asyncio.subprocess.PIPE
+            )
+            stdout, _ = await proc.communicate()
+            resp = stdout.strip().decode(errors="ignore")
+            if resp:
+                unit = resp.split(maxsplit=2)
+                if len(unit) == 3:
+                    return f"Systemd Unit Name: {unit[1]}"
+        cmdline_file = pathlib.Path(f"/proc/{process_id}/cmdline")
+        if cmdline_file.exists():
+            res = cmdline_file.read_text().replace("\x00", " ").strip()
+            return f"Command Line: {res}"
+        exe_file = pathlib.Path(f"/proc/{process_id}/exe")
+        if exe_file.exists():
+            return f"Executable: {exe_file.resolve()})"
+        return "Name Unknown"
+
+    async def validate_device(self, dev_strpath: str) -> None:
+        dev_path = pathlib.Path(dev_strpath)
+        if not dev_path.exists():
+            raise FlashError(f"No Serial Device found at {dev_path}")
+        try:
+            dev_st = dev_path.stat()
+        except PermissionError as e:
+            raise FlashError(f"No permission to access device {dev_path}") from e
+        dev_id = (dev_st.st_dev, dev_st.st_ino)
+        for fd_dir in pathlib.Path("/proc").glob("*/fd"):
+            pid = fd_dir.parent.name
+            if not pid.isdigit():
+                continue
+            with contextlib.suppress(OSError):
+                for item in fd_dir.iterdir():
+                    try:
+                        item_st = item.stat()
+                    except OSError:
+                        continue
+                    item_id = (item_st.st_dev, item_st.st_ino)
+                    if item_id == dev_id:
+                        proc_name = await self._lookup_proc_name(pid)
+                        output_line(
+                            f"Serial device {dev_path} in use by another program.\n"
+                            f"Process ID: {pid}\n"
+                            f"Process {proc_name}"
+                        )
+                        raise FlashError(f"Serial device {dev_path} in use")
+
     async def run(self, intf: str, baud: int, fw_path: pathlib.Path) -> None:
         if not fw_path.is_file():
-            raise FlashCanError("Invalid firmware path '%s'" % (fw_path))
-        try:
-            import serial
-        except ModuleNotFoundError:
-            raise FlashCanError(
-                "The pyserial python package was not found.  To install "
-                "run the following command in a terminal: \n\n"
-                "   pip3 install pyserial\n\n")
-        self.serial_error = serial.SerialException
+            raise FlashError("Invalid firmware path '%s'" % (fw_path))
+        await self.validate_device(intf)
         try:
-            serial_dev = serial.Serial(baudrate=baud, timeout=0,
-                                       exclusive=True)
+            serial_dev = Serial(                            # type: ignore
+                baudrate=baud, timeout=0, exclusive=True
+            )
             serial_dev.port = intf
             serial_dev.open()
-        except (OSError, IOError, self.serial_error) as e:
-            raise FlashCanError("Unable to open serial port: %s" % (e,))
+        except (OSError, IOError, SerialException) as e:
+            raise FlashError("Unable to open serial port: %s" % (e,))
         self.serial = serial_dev
         self._loop.add_reader(self.serial.fileno(), self._handle_response)
         flasher = CanFlasher(self.node, fw_path)
@@ -569,7 +637,59 @@
         self.serial.close()
         self.serial = None
 
-def main():
+async def main(args: argparse.Namespace) -> int:
+    if not args.verbose:
+        logging.getLogger().setLevel(logging.ERROR)
+    intf = args.interface
+    fpath = pathlib.Path(args.firmware).expanduser().resolve()
+    loop = asyncio.get_running_loop()
+    iscan = args.device is None
+    req_only = args.request_bootloader
+    sock: CanSocket | SerialSocket | None = None
+    try:
+        if iscan:
+            sock = CanSocket(loop)
+            if args.query:
+                await sock.run_query(intf)
+            else:
+                if args.uuid is None:
+                    raise FlashError(
+                        "The 'uuid' option must be specified to flash a device"
+                    )
+                output_line(f"Flashing CAN UUID {args.uuid} on interface {intf}")
+                uuid = int(args.uuid, 16)
+                await sock.run(intf, uuid, fpath, req_only)
+        else:
+            if not HAS_SERIAL:
+                ser_inst_cmd = "pip3 install serial"
+                if shutil.which("apt") is not None:
+                    ser_inst_cmd = "sudo apt install python3-serial"
+                raise FlashError(
+                    "The pyserial python package was not found.  To install "
+                    "run the following command in a terminal: \n\n"
+                    f"   {ser_inst_cmd}\n\n"
+                )
+            if args.device is None:
+                raise FlashError(
+                    "The 'device' option must be specified to flash a device"
+                )
+            output_line(f"Flashing Serial Device {args.device}, baud {args.baud}")
+            sock = SerialSocket(loop)
+            await sock.run(args.device, args.baud, fpath)
+    except Exception:
+        logging.exception("Flash Error")
+        return -1
+    finally:
+        if sock is not None:
+            sock.close()
+    if args.query:
+        output_line("Query Complete")
+    else:
+        output_line("Flash Success")
+    return 0
+
+
+if __name__ == '__main__':
     parser = argparse.ArgumentParser(
         description="Katapult Flash Tool")
     parser.add_argument(
@@ -606,44 +726,4 @@
     )
 
     args = parser.parse_args()
-    if not args.verbose:
-        logging.getLogger().setLevel(logging.ERROR)
-    intf = args.interface
-    fpath = pathlib.Path(args.firmware).expanduser().resolve()
-    loop = asyncio.get_event_loop()
-    iscan = args.device is None
-    req_only = args.request_bootloader
-    sock = None
-    try:
-        if iscan:
-            sock = CanSocket(loop)
-            if args.query:
-                loop.run_until_complete(sock.run_query(intf))
-            else:
-                if args.uuid is None:
-                    raise FlashCanError(
-                        "The 'uuid' option must be specified to flash a device"
-                    )
-                uuid = int(args.uuid, 16)
-                loop.run_until_complete(sock.run(intf, uuid, fpath, req_only))
-        else:
-            if args.device is None:
-                raise FlashCanError(
-                    "The 'device' option must be specified to flash a device"
-                )
-            sock = SerialSocket(loop)
-            loop.run_until_complete(sock.run(args.device, args.baud, fpath))
-    except Exception as e:
-        logging.exception("Flash Error")
-        sys.exit(-1)
-    finally:
-        if sock is not None:
-            sock.close()
-    if args.query:
-        output_line("Query Complete")
-    else:
-        output_line("Flash Success")
-
-
-if __name__ == '__main__':
-    main()
+    exit(asyncio.run(main(args)))
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/scripts/make-version.sh /home/mks/firmware_comparison/downloads/CanBoot/scripts/make-version.sh
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/scripts/make-version.sh	1969-12-31 19:00:00.000000000 -0500
+++ /home/mks/firmware_comparison/downloads/CanBoot/scripts/make-version.sh	2024-10-08 17:45:28.585223681 -0400
@@ -0,0 +1,12 @@
+#!/bin/sh
+# Detect the version of Katapult
+
+a="/$0"; a="${a%/*}"; a="${a:-.}"; a="${a##/}/"; SRCDIR=$(cd "$a/.."; pwd)
+
+if [ -e "${SRCDIR}/.git" ]; then
+    git describe --tags --long --always --dirty
+elif [ -f "${SRCDIR}/.version" ]; then
+    cat "${SRCDIR}/.version"
+else
+    echo "?"
+fi
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/command.h /home/mks/firmware_comparison/downloads/CanBoot/src/command.h
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/command.h	2023-08-12 06:18:51.904709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/command.h	2024-10-08 17:45:28.589223696 -0400
@@ -23,7 +23,7 @@
 #define shutdown(msg)     do { } while (1)
 #define try_shutdown(msg) do { } while (0)
 
-#define PROTO_VERSION   0x00010000      // Version 1.0.0
+#define PROTO_VERSION   0x00010100      // Version 1.1.0
 #define CMD_CONNECT       0x11
 #define CMD_RX_BLOCK      0x12
 #define CMD_RX_EOF        0x13
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/flashcmd.c /home/mks/firmware_comparison/downloads/CanBoot/src/flashcmd.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/flashcmd.c	2023-08-12 06:18:51.904709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/flashcmd.c	2024-10-08 17:45:28.589223696 -0400
@@ -19,12 +19,17 @@
 command_connect(uint32_t *data)
 {
     uint32_t mcuwords = DIV_ROUND_UP(strlen(CONFIG_MCU), 4);
-    uint32_t out[6 + mcuwords];
-    memset(out, 0, (6 + mcuwords) * 4);
+    uint32_t version_words = DIV_ROUND_UP(strlen(CONFIG_KATAPULT_VERSION), 4);
+    uint32_t out[7 + mcuwords + version_words];
+    memset(out, 0, (7 + mcuwords + version_words) * 4);
     out[2] = cpu_to_le32(PROTO_VERSION);
     out[3] = cpu_to_le32(CONFIG_LAUNCH_APP_ADDRESS);
     out[4] = cpu_to_le32(CONFIG_BLOCK_SIZE);
     memcpy(&out[5], CONFIG_MCU, strlen(CONFIG_MCU));
+    memcpy(
+        &out[6 + mcuwords], CONFIG_KATAPULT_VERSION,
+        strlen(CONFIG_KATAPULT_VERSION)
+    );
     command_respond_ack(CMD_CONNECT, out, ARRAY_SIZE(out));
 }
 
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/generic/armcm_deployer.lds.S /home/mks/firmware_comparison/downloads/CanBoot/src/generic/armcm_deployer.lds.S
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/generic/armcm_deployer.lds.S	2023-08-12 06:18:51.904709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/generic/armcm_deployer.lds.S	2024-10-08 17:45:28.589223696 -0400
@@ -72,5 +72,8 @@
         // that isn't needed so no need to include them in the binary.
         *(.init)
         *(.fini)
+        // Don't include exception tables
+        *(.ARM.extab)
+        *(.ARM.exidx)
     }
 }
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/generic/armcm_link.lds.S /home/mks/firmware_comparison/downloads/CanBoot/src/generic/armcm_link.lds.S
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/generic/armcm_link.lds.S	2023-08-12 06:18:51.908709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/generic/armcm_link.lds.S	2024-10-08 17:45:28.589223696 -0400
@@ -74,5 +74,8 @@
         // that isn't needed so no need to include them in the binary.
         *(.init)
         *(.fini)
+        // Don't include exception tables
+        *(.ARM.extab)
+        *(.ARM.exidx)
     }
 }
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/Kconfig /home/mks/firmware_comparison/downloads/CanBoot/src/Kconfig
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/Kconfig	2023-08-12 06:18:51.900709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/Kconfig	2024-10-08 17:45:28.585223681 -0400
@@ -1,6 +1,6 @@
 # Main Kconfig settings
 
-VERSION := $(shell, git describe --tags --long --always --dirty 2> /dev/null)
+VERSION := $(shell, ./scripts/make-version.sh 2> /dev/null)
 
 mainmenu "Katapult Configuration $(VERSION)"
 
@@ -73,7 +73,7 @@
     default y if CANSERIAL || USBCANBUS
 config CANBUS_FREQUENCY
     int "CAN bus speed" if LOW_LEVEL_OPTIONS && CANBUS
-    default 500000
+    default 1000000
 config CANBUS_FILTER
     bool
     default y if CANSERIAL
@@ -120,3 +120,7 @@
 config HAVE_CHIPID
     bool
     default n
+
+config KATAPULT_VERSION
+    string
+    default "$(VERSION)"
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/lpc176x/Makefile /home/mks/firmware_comparison/downloads/CanBoot/src/lpc176x/Makefile
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/lpc176x/Makefile	2023-08-12 06:18:51.916709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/lpc176x/Makefile	2024-10-08 17:45:28.589223696 -0400
@@ -8,7 +8,7 @@
 CFLAGS += -mthumb -mcpu=cortex-m3 -Ilib/lpc176x/device -Ilib/cmsis-core
 CFLAGS += -Wno-nonnull
 
-CFLAGS_katapult.elf += --specs=nano.specs --specs=nosys.specs
+CFLAGS_katapult.elf += -nostdlib -lgcc -lc_nano
 CFLAGS_katapult.elf += -T $(OUT)src/generic/armcm_link.ld
 $(OUT)katapult.elf: $(OUT)src/generic/armcm_link.ld
 
@@ -26,6 +26,6 @@
 
 # Deployer build
 deployer-y += generic/armcm_boot.c generic/armcm_reset.c $(mcu-y)
-CFLAGS_deployer.elf += --specs=nano.specs --specs=nosys.specs
+CFLAGS_deployer.elf += -nostdlib -lgcc -lc_nano
 CFLAGS_deployer.elf += -T $(OUT)src/generic/armcm_deployer.ld
 $(OUT)deployer.elf: $(OUT)src/generic/armcm_deployer.ld
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/rp2040/Makefile /home/mks/firmware_comparison/downloads/CanBoot/src/rp2040/Makefile
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/rp2040/Makefile	2023-08-12 06:18:51.920709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/rp2040/Makefile	2024-10-08 17:45:28.589223696 -0400
@@ -8,7 +8,7 @@
 CFLAGS += -mcpu=cortex-m0plus -mthumb -Ilib/cmsis-core
 CFLAGS += -Ilib/rp2040 -Ilib/rp2040/cmsis_include -Ilib/fast-hash -Ilib/can2040 -Ilib/rp2040/pico/flash/ -Ilib/rp2040/pico/bootrom/
 
-CFLAGS_katapult.elf += --specs=nano.specs --specs=nosys.specs
+CFLAGS_katapult.elf += -nostdlib -lgcc -lc_nano
 CFLAGS_katapult.elf += -T $(OUT)src/rp2040/rp2040_link.ld
 
 # Add source files
@@ -62,6 +62,6 @@
 
 # Deployer build
 deployer-y += generic/armcm_boot.c generic/armcm_reset.c $(mcu-y)
-CFLAGS_deployer.elf += --specs=nano.specs --specs=nosys.specs
+CFLAGS_deployer.elf += -nostdlib -lgcc -lc_nano
 CFLAGS_deployer.elf += -T $(OUT)src/generic/armcm_deployer.ld
 $(OUT)deployer.elf: $(OUT)src/generic/armcm_deployer.ld
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/rp2040/rp2040_link.lds.S /home/mks/firmware_comparison/downloads/CanBoot/src/rp2040/rp2040_link.lds.S
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/rp2040/rp2040_link.lds.S	2023-08-12 06:18:51.924709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/rp2040/rp2040_link.lds.S	2024-10-08 17:45:28.589223696 -0400
@@ -63,5 +63,8 @@
         // that isn't needed so no need to include them in the binary.
         *(.init)
         *(.fini)
+        // Don't include exception tables
+        *(.ARM.extab)
+        *(.ARM.exidx)
     }
 }
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/fdcan.c /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/fdcan.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/fdcan.c	2023-08-12 06:18:51.928709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/fdcan.c	2024-10-08 17:45:28.589223696 -0400
@@ -46,21 +46,37 @@
  DECL_CONSTANT_STR("RESERVE_PINS_CAN", "PC2,PC3");
  #define GPIO_Rx GPIO('C', 2)
  #define GPIO_Tx GPIO('C', 3)
+#elif CONFIG_STM32_CANBUS_PB5_PB6
+ DECL_CONSTANT_STR("RESERVE_PINS_CAN", "PB5,PB6");
+ #define GPIO_Rx GPIO('B', 5)
+ #define GPIO_Tx GPIO('B', 6)
+#elif CONFIG_STM32_CANBUS_PB12_PB13
+ DECL_CONSTANT_STR("RESERVE_PINS_CAN", "PB12,PB13");
+ #define GPIO_Rx GPIO('B', 12)
+ #define GPIO_Tx GPIO('B', 13)
 #endif
 
-#if !(CONFIG_STM32_CANBUS_PB0_PB1 || CONFIG_STM32_CANBUS_PC2_PC3)
+#if !(CONFIG_STM32_CANBUS_PB0_PB1 || CONFIG_STM32_CANBUS_PC2_PC3 \
+     || CONFIG_STM32_CANBUS_PB5_PB6 ||CONFIG_STM32_CANBUS_PB12_PB13)
  #define SOC_CAN FDCAN1
  #define MSG_RAM (((struct fdcan_ram_layout*)SRAMCAN_BASE)->fdcan1)
+ #if CONFIG_MACH_STM32H7 || CONFIG_MACH_STM32G4
+  #define CAN_IT0_IRQn  FDCAN1_IT0_IRQn
+ #endif
 #else
  #define SOC_CAN FDCAN2
  #define MSG_RAM (((struct fdcan_ram_layout*)SRAMCAN_BASE)->fdcan2)
+ #if CONFIG_MACH_STM32H7 || CONFIG_MACH_STM32G4
+  #define CAN_IT0_IRQn  FDCAN2_IT0_IRQn
+ #endif
 #endif
 
 #if CONFIG_MACH_STM32G0
  #define CAN_IT0_IRQn  TIM16_FDCAN_IT0_IRQn
  #define CAN_FUNCTION  GPIO_FUNCTION(3) // Alternative function mapping number
-#elif CONFIG_MACH_STM32H7 || CONFIG_MACH_STM32G4
- #define CAN_IT0_IRQn  FDCAN1_IT0_IRQn
+#endif
+
+#if CONFIG_MACH_STM32H7 || CONFIG_MACH_STM32G4
  #define CAN_FUNCTION  GPIO_FUNCTION(9) // Alternative function mapping number
 #endif
 
@@ -153,10 +169,10 @@
     can_filter(1, id);
     can_filter(2, id + 1);
 
-#if CONFIG_MACH_STM32G0
+#if CONFIG_MACH_STM32G0 || CONFIG_MACH_STM32G4
     SOC_CAN->RXGFC = ((id ? 3 : 1) << FDCAN_RXGFC_LSS_Pos
                       | 0x02 << FDCAN_RXGFC_ANFS_Pos);
-#elif CONFIG_MACH_STM32H7 || CONFIG_MAC_STM32G4
+#elif CONFIG_MACH_STM32H7
     uint32_t flssa = (uint32_t)MSG_RAM.FLS - SRAMCAN_BASE;
     SOC_CAN->SIDFC = flssa | ((id ? 3 : 1) << FDCAN_SIDFC_LSS_Pos);
     SOC_CAN->GFC = 0x02 << FDCAN_GFC_ANFS_Pos;
@@ -284,7 +300,7 @@
 
     SOC_CAN->NBTP = btr;
 
-#if CONFIG_MACH_STM32H7 || CONFIG_MAC_STM32G4
+#if CONFIG_MACH_STM32H7
     /* Setup message RAM addresses */
     uint32_t f0sa = (uint32_t)MSG_RAM.RXF0 - SRAMCAN_BASE;
     SOC_CAN->RXF0C = f0sa | (ARRAY_SIZE(MSG_RAM.RXF0) << FDCAN_RXF0C_F0S_Pos);
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/Kconfig /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/Kconfig
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/Kconfig	2023-08-12 06:18:51.924709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/Kconfig	2024-10-08 17:45:28.589223696 -0400
@@ -388,11 +388,11 @@
         select CANSERIAL
     config STM32_MMENU_CANBUS_PB5_PB6
         bool "CAN bus (on PB5/PB6)" if LOW_LEVEL_OPTIONS
-        depends on HAVE_STM32_CANBUS && MACH_STM32F4
+        depends on (HAVE_STM32_CANBUS && MACH_STM32F4) || (HAVE_STM32_FDCANBUS && MACH_STM32G0B1)
         select CANSERIAL
     config STM32_MMENU_CANBUS_PB12_PB13
         bool "CAN bus (on PB12/PB13)" if LOW_LEVEL_OPTIONS
-        depends on HAVE_STM32_CANBUS && MACH_STM32F4
+        depends on (HAVE_STM32_CANBUS && MACH_STM32F4) || HAVE_STM32_FDCANBUS
         select CANSERIAL
     config STM32_MMENU_CANBUS_PD0_PD1
         bool "CAN bus (on PD0/PD1)" if LOW_LEVEL_OPTIONS
@@ -424,10 +424,10 @@
         depends on HAVE_STM32_CANBUS && MACH_STM32F4
     config STM32_CMENU_CANBUS_PB5_PB6
         bool "CAN bus (on PB5/PB6)"
-        depends on HAVE_STM32_CANBUS && MACH_STM32F4
+        depends on (HAVE_STM32_CANBUS && MACH_STM32F4) || (HAVE_STM32_FDCANBUS && MACH_STM32G0B1)
     config STM32_CMENU_CANBUS_PB12_PB13
         bool "CAN bus (on PB12/PB13)"
-        depends on HAVE_STM32_CANBUS && MACH_STM32F4
+        depends on (HAVE_STM32_CANBUS && MACH_STM32F4) || HAVE_STM32_FDCANBUS
     config STM32_CMENU_CANBUS_PD0_PD1
         bool "CAN bus (on PD0/PD1)"
         depends on HAVE_STM32_CANBUS || HAVE_STM32_FDCANBUS
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/Makefile /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/Makefile
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/Makefile	2023-08-12 06:18:51.924709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/Makefile	2024-10-08 17:45:28.589223696 -0400
@@ -22,7 +22,7 @@
 CFLAGS-$(CONFIG_MACH_STM32H7) += -mcpu=cortex-m7 -Ilib/stm32h7/include
 CFLAGS += $(CFLAGS-y) -D$(MCU_UPPER) -mthumb -Ilib/cmsis-core -Ilib/fast-hash
 
-CFLAGS_katapult.elf += --specs=nano.specs --specs=nosys.specs
+CFLAGS_katapult.elf += -nostdlib -lgcc -lc_nano
 CFLAGS_katapult.elf += -T $(OUT)src/generic/armcm_link.ld
 $(OUT)katapult.elf: $(OUT)src/generic/armcm_link.ld
 
@@ -65,8 +65,13 @@
 canbus-src-$(CONFIG_HAVE_STM32_FDCANBUS) += stm32/fdcan.c
 src-$(CONFIG_CANSERIAL) += $(canbus-src-y) generic/canbus.c stm32/chipid.c
 
+# Flash rules
+flash: $(OUT)katapult.bin
+	@echo "  Flashing $< to $(FLASH_DEVICE)"
+	$(Q) $(if $(NOSUDO),,sudo) dfu-util -d "$(FLASH_DEVICE)" -R -a 0 -s "$(CONFIG_FLASH_START)":leave -D $(OUT)katapult.bin
+
 # Deployer build
 deployer-y += generic/armcm_boot.c generic/armcm_reset.c $(mcu-y)
-CFLAGS_deployer.elf += --specs=nano.specs --specs=nosys.specs
+CFLAGS_deployer.elf += -nostdlib -lgcc -lc_nano
 CFLAGS_deployer.elf += -T $(OUT)src/generic/armcm_deployer.ld
 $(OUT)deployer.elf: $(OUT)src/generic/armcm_deployer.ld
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/stm32f0_serial.c /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/stm32f0_serial.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/stm32f0_serial.c	2023-08-12 06:18:51.932709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/stm32f0_serial.c	2024-10-08 17:45:28.589223696 -0400
@@ -68,7 +68,7 @@
   DECL_CONSTANT_STR("RESERVE_PINS_serial", "PD9,PD8");
   #define GPIO_Rx GPIO('D', 9)
   #define GPIO_Tx GPIO('D', 8)
-  #define USARTx_FUNCTION GPIO_FUNCTION(7)
+  #define USARTx_FUNCTION GPIO_FUNCTION(CONFIG_MACH_STM32G0 ? 0 : 7)
   #define USARTx USART3
   #define USARTx_IRQn USART3_IRQn
 #elif CONFIG_STM32_SERIAL_UART4
@@ -78,6 +78,13 @@
   #define USARTx_FUNCTION GPIO_FUNCTION(8)
   #define USARTx UART4
   #define USARTx_IRQn UART4_IRQn
+#elif CONFIG_STM32_SERIAL_USART5
+  DECL_CONSTANT_STR("RESERVE_PINS_serial", "PD2,PD3");
+  #define GPIO_Rx GPIO('D', 2)
+  #define GPIO_Tx GPIO('D', 3)
+  #define USARTx_FUNCTION GPIO_FUNCTION(3)
+  #define USARTx USART5
+  #define USARTx_IRQn USART5_IRQn
 #endif
 
 #if CONFIG_MACH_STM32F031
@@ -90,6 +97,17 @@
   // Some of the stm32g0 MCUs have slightly different register names
   #if CONFIG_MACH_STM32G0B1
     #define USART2_IRQn USART2_LPUART2_IRQn
+    #define USART3_IRQn USART3_4_5_6_LPUART1_IRQn
+    #define USART4_IRQn USART3_4_5_6_LPUART1_IRQn
+    #define USART5_IRQn USART3_4_5_6_LPUART1_IRQn
+    #define USART6_IRQn USART3_4_5_6_LPUART1_IRQn
+  #endif
+  #if CONFIG_MACH_STM32G0B0
+    #define USART2_IRQn USART2_IRQn
+    #define USART3_IRQn USART3_4_5_6_IRQn
+    #define USART4_IRQn USART3_4_5_6_IRQn
+    #define USART5_IRQn USART3_4_5_6_IRQn
+    #define USART6_IRQn USART3_4_5_6_IRQn
   #endif
   #define USART_CR1_RXNEIE USART_CR1_RXNEIE_RXFNEIE
   #define USART_CR1_TXEIE USART_CR1_TXEIE_TXFNFIE
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/stm32g0.c /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/stm32g0.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/stm32g0.c	2023-08-12 06:18:51.932709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/stm32g0.c	2024-10-08 17:45:28.589223696 -0400
@@ -32,18 +32,30 @@
         uint32_t bit = 1 << ((periph_base - AHBPERIPH_BASE) / 0x400);
         return (struct cline){.en=&RCC->AHBENR, .rst=&RCC->AHBRSTR, .bit=bit};
     }
+#ifdef USART5_BASE
+    if (periph_base == USART5_BASE)
+        return (struct cline){.en=&RCC->APBENR1,.rst=&RCC->APBRSTR1,.bit=1<<8};
+#endif
+#ifdef USART6_BASE
+    if (periph_base == USART6_BASE)
+        return (struct cline){.en=&RCC->APBENR1,.rst=&RCC->APBRSTR1,.bit=1<<9};
+#endif
 #if defined(FDCAN1_BASE) || defined(FDCAN2_BASE)
     if ((periph_base == FDCAN1_BASE) || (periph_base == FDCAN2_BASE))
         return (struct cline){.en=&RCC->APBENR1,.rst=&RCC->APBRSTR1,.bit=1<<12};
 #endif
+#ifdef USB_BASE
     if (periph_base == USB_BASE)
         return (struct cline){.en=&RCC->APBENR1,.rst=&RCC->APBRSTR1,.bit=1<<13};
+#endif
 #ifdef CRS_BASE
     if (periph_base == CRS_BASE)
         return (struct cline){.en=&RCC->APBENR1,.rst=&RCC->APBRSTR1,.bit=1<<16};
 #endif
+#ifdef I2C3_BASE
     if (periph_base == I2C3_BASE)
         return (struct cline){.en=&RCC->APBENR1,.rst=&RCC->APBRSTR1,.bit=1<<23};
+#endif
     if (periph_base == TIM1_BASE)
         return (struct cline){.en=&RCC->APBENR2,.rst=&RCC->APBRSTR2,.bit=1<<11};
     if (periph_base == SPI1_BASE)
@@ -106,8 +118,11 @@
     }
     pllcfgr |= (pll_freq/pll_base) << RCC_PLLCFGR_PLLN_Pos;
     pllcfgr |= (pll_freq/CONFIG_CLOCK_FREQ - 1) << RCC_PLLCFGR_PLLR_Pos;
-    pllcfgr |= (pll_freq/FREQ_USB - 1) << RCC_PLLCFGR_PLLQ_Pos;
-    RCC->PLLCFGR = pllcfgr | RCC_PLLCFGR_PLLREN | RCC_PLLCFGR_PLLQEN;
+#ifdef RCC_PLLCFGR_PLLQ
+    pllcfgr |= ((pll_freq/FREQ_USB - 1) << RCC_PLLCFGR_PLLQ_Pos)
+            | RCC_PLLCFGR_PLLQEN;
+#endif
+    RCC->PLLCFGR = pllcfgr | RCC_PLLCFGR_PLLREN;
     RCC->CR |= RCC_CR_PLLON;
 
     // Wait for PLL lock
@@ -119,8 +134,10 @@
     while ((RCC->CFGR & RCC_CFGR_SWS_Msk) != (2 << RCC_CFGR_SWS_Pos))
         ;
 
+#ifdef USB_BASE
     // Use PLLQCLK for USB (setting USBSEL=2 works in practice)
     RCC->CCIPR2 = 2 << RCC_CCIPR2_USBSEL_Pos;
+#endif
 }
 
 
@@ -145,6 +162,8 @@
 void
 armcm_main(void)
 {
+    // Disable internal pull-down resistors on UCPDx CCx pins
+    SYSCFG->CFGR1 |= (SYSCFG_CFGR1_UCPD1_STROBE | SYSCFG_CFGR1_UCPD2_STROBE);
     SCB->VTOR = (uint32_t)VectorTable;
 
     // Reset clock registers (in case bootloader has changed them)
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/stm32h7.c /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/stm32h7.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/stm32h7.c	2023-08-12 06:18:51.932709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/stm32h7.c	2024-10-08 17:45:28.589223696 -0400
@@ -40,6 +40,9 @@
         uint32_t bit = 1 << ((periph_base - D2_AHB2PERIPH_BASE) / 0x400);
         return (struct cline){.en=&RCC->AHB2ENR, .rst=&RCC->AHB2RSTR, .bit=bit};
     } else if (periph_base >= D2_AHB1PERIPH_BASE) {
+        if (periph_base == ADC12_COMMON_BASE)
+            return (struct cline){.en = &RCC->AHB1ENR, .rst = &RCC->AHB1RSTR,
+                                  .bit = RCC_AHB1ENR_ADC12EN};
         uint32_t bit = 1 << ((periph_base - D2_AHB1PERIPH_BASE) / 0x400);
         return (struct cline){.en=&RCC->AHB1ENR, .rst=&RCC->AHB1RSTR, .bit=bit};
     } else if (periph_base >= D2_APB2PERIPH_BASE) {
@@ -231,6 +234,12 @@
     RCC->D2CCIP1R = 0x00000000;
     RCC->D2CCIP2R = 0x00000000;
     RCC->D3CCIPR = 0x00000000;
+    RCC->APB1LENR = 0x00000000;
+    RCC->APB1HENR = 0x00000000;
+    RCC->APB2ENR = 0x00000000;
+    RCC->APB3ENR = 0x00000000;
+    RCC->APB4ENR = 0x00000000;
+
     SCB->VTOR = (uint32_t)VectorTable;
 
     dfu_reboot_check();
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/usbfs.c /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/usbfs.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/usbfs.c	2023-08-12 06:18:51.932709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/usbfs.c	2024-10-08 17:45:28.589223696 -0400
@@ -1,6 +1,6 @@
 // Hardware interface to "fullspeed USB controller"
 //
-// Copyright (C) 2018-2021  Kevin O'Connor <kevin@koconnor.net>
+// Copyright (C) 2018-2023  Kevin O'Connor <kevin@koconnor.net>
 //
 // This file may be distributed under the terms of the GNU GPLv3 license.
 
@@ -15,7 +15,7 @@
 #include "internal.h" // GPIO
 #include "sched.h" // DECL_INIT
 
-#if CONFIG_MACH_STM32F103 || CONFIG_MACH_STM32G4
+#if CONFIG_MACH_STM32F1
   // Transfer memory is accessed with 32bits, but contains only 16bits of data
   typedef volatile uint32_t epmword_t;
   #define WSIZE 2
@@ -25,6 +25,11 @@
   typedef volatile uint16_t epmword_t;
   #define WSIZE 2
   #define USBx_IRQn USB_IRQn
+#elif CONFIG_MACH_STM32G4
+  // Transfer memory is accessed with 16bits and contains 16bits of data
+  typedef volatile uint16_t epmword_t;
+  #define WSIZE 2
+  #define USBx_IRQn USB_LP_IRQn
 #elif CONFIG_MACH_STM32G0
   // Transfer memory is accessed with 32bits and contains 32bits of data
   typedef volatile uint32_t epmword_t;
@@ -48,6 +53,12 @@
   #define USB_CNTR_FRES USB_CNTR_USBRST
 #endif
 
+// Some chip variants do not define these fields
+#ifndef USB_EP_DTOG_TX_Pos
+#define USB_EP_DTOG_TX_Pos 6
+#define USB_EP_DTOG_RX_Pos 14
+#endif
+
 
 /****************************************************************
  * USB transfer memory
@@ -55,52 +66,50 @@
 
 // Layout of the USB transfer memory
 #define EPM ((epmword_t*)USB_PMAADDR)
-#define EPM_EP_DESC(ep) (&EPM[(ep) * (8 / WSIZE)])
+#define EPM_EP_DESC(ep, bufnum) (&EPM[((ep)*2 + (bufnum)) * (4 / WSIZE)])
 #define EPM_BUF_OFFSET 0x10
 #define EPM_EP_BUF_SIZE (64 / WSIZE + 1)
-#define EPM_EP_TX_BUF(ep) (&EPM[EPM_BUF_OFFSET + (ep)*2*EPM_EP_BUF_SIZE])
-#define EPM_EP_RX_BUF(ep) (&EPM[EPM_BUF_OFFSET + (1+(ep)*2)*EPM_EP_BUF_SIZE])
+#define EPM_EP_BUF(ep, bufnum)                                          \
+    (&EPM[EPM_BUF_OFFSET + ((ep)*2 + (bufnum)) * EPM_EP_BUF_SIZE])
+#define BUFTX 0
+#define BUFRX 1
 
 // Configure the usb descriptor for an endpoint
 static void
-epm_ep_desc_setup(int ep, int rx_size)
+epm_ep_desc_setup(int ep, int bufnum, int rx_size)
 {
-    uint32_t addr_tx = (EPM_EP_TX_BUF(ep) - EPM) * WSIZE, count_tx = 0;
-    uint32_t addr_rx = (EPM_EP_RX_BUF(ep) - EPM) * WSIZE;
+    uint32_t addr = (EPM_EP_BUF(ep, bufnum) - EPM) * WSIZE;
     uint32_t count_rx = (rx_size <= 30 ? DIV_ROUND_UP(rx_size, 2) << 10
                          : ((DIV_ROUND_UP(rx_size, 32) - 1) << 10) | 0x8000);
-    epmword_t *desc = EPM_EP_DESC(ep);
+    epmword_t *desc = EPM_EP_DESC(ep, bufnum);
     if (WSIZE == 2) {
-        desc[0] = addr_tx;
-        desc[1] = count_tx;
-        desc[2] = addr_rx;
-        desc[3] = count_rx;
+        desc[0] = addr;
+        desc[1] = count_rx;
     } else {
-        desc[0] = addr_tx | (count_tx << 16);
-        desc[1] = addr_rx | (count_rx << 16);
+        *desc = addr | (count_rx << 16);
     }
 }
 
 // Return number of read bytes on an rx endpoint
 static uint32_t
-epm_get_ep_count_rx(int ep)
+epm_get_ep_count_rx(int ep, int bufnum)
 {
-    epmword_t *desc = EPM_EP_DESC(ep);
+    epmword_t *desc = EPM_EP_DESC(ep, bufnum);
     if (WSIZE == 2)
-        return desc[3] & 0x3ff;
-    return (desc[1] >> 16) & 0x3ff;
+        return desc[1] & 0x3ff;
+    return (*desc >> 16) & 0x3ff;
 }
 
 // Set number of bytes ready to be transmitted on a tx endpoint
 static void
-epm_set_ep_count_tx(int ep, uint32_t count)
+epm_set_ep_count_tx(int ep, int bufnum, uint32_t count)
 {
-    epmword_t *desc = EPM_EP_DESC(ep);
+    epmword_t *desc = EPM_EP_DESC(ep, bufnum);
     if (WSIZE == 2) {
         desc[1] = count;
     } else {
-        uint32_t addr_tx = (EPM_EP_TX_BUF(ep) - EPM) * WSIZE;
-        desc[0] = addr_tx | (count << 16);
+        uint32_t addr_tx = (EPM_EP_BUF(ep, bufnum) - EPM) * WSIZE;
+        *desc = addr_tx | (count << 16);
     }
 }
 
@@ -108,18 +117,22 @@
 static void
 btable_configure(void)
 {
-    epm_ep_desc_setup(0, USB_CDC_EP0_SIZE);
-    epm_ep_desc_setup(USB_CDC_EP_ACM, 0);
-    epm_ep_desc_setup(USB_CDC_EP_BULK_OUT, USB_CDC_EP_BULK_OUT_SIZE);
-    epm_ep_desc_setup(USB_CDC_EP_BULK_IN, 0);
+    epm_ep_desc_setup(0, BUFTX, 0);
+    epm_ep_desc_setup(0, BUFRX, USB_CDC_EP0_SIZE);
+    epm_ep_desc_setup(USB_CDC_EP_ACM, BUFTX, 0);
+    epm_ep_desc_setup(USB_CDC_EP_ACM, BUFRX, 0);
+    epm_ep_desc_setup(USB_CDC_EP_BULK_OUT, 0, USB_CDC_EP_BULK_OUT_SIZE);
+    epm_ep_desc_setup(USB_CDC_EP_BULK_OUT, 1, USB_CDC_EP_BULK_OUT_SIZE);
+    epm_ep_desc_setup(USB_CDC_EP_BULK_IN, 0, 0);
+    epm_ep_desc_setup(USB_CDC_EP_BULK_IN, 1, 0);
 }
 
 // Read a packet stored in dedicated usb memory
 static uint32_t
-btable_read_packet(int ep, uint8_t *dest, int max_len)
+btable_read_packet(int ep, int bufnum, uint8_t *dest, int max_len)
 {
-    epmword_t *src = EPM_EP_RX_BUF(ep);
-    uint32_t count = epm_get_ep_count_rx(ep);
+    epmword_t *src = EPM_EP_BUF(ep, bufnum);
+    uint32_t count = epm_get_ep_count_rx(ep, bufnum);
     if (count > max_len)
         count = max_len;
     int i;
@@ -145,9 +158,9 @@
 
 // Write a packet to dedicated usb memory
 static void
-btable_write_packet(int ep, const uint8_t *src, int count)
+btable_write_packet(int ep, int bufnum, const uint8_t *src, int count)
 {
-    epmword_t *dest = EPM_EP_TX_BUF(ep);
+    epmword_t *dest = EPM_EP_BUF(ep, bufnum);
     int i;
     for (i=0; i<count/WSIZE; i++) {
         uint8_t b1 = *src++, b2 = *src++, b3 = 0, b4 = 0;
@@ -165,7 +178,7 @@
             d |= *src++ << 16;
         *dest = d;
     }
-    epm_set_ep_count_tx(ep, count);
+    epm_set_ep_count_tx(ep, bufnum, count);
 }
 
 
@@ -175,26 +188,27 @@
 
 #define USB_EPR ((volatile uint32_t *)USB_BASE)
 
+#define EPR_TBITS (USB_EP_DTOG_RX | USB_EPRX_STAT       \
+                   | USB_EP_DTOG_TX | USB_EPTX_STAT)
 #define EPR_RWBITS (USB_EPADDR_FIELD | USB_EP_KIND | USB_EP_TYPE_MASK)
 #define EPR_RWCBITS (USB_EP_CTR_RX | USB_EP_CTR_TX)
 
+// Calculate the memory update needed to set the epr register
 static uint32_t
-set_stat_rx_bits(uint32_t epr, uint32_t bits)
-{
-    return ((epr & (EPR_RWBITS | USB_EPRX_STAT)) ^ bits) | EPR_RWCBITS;
-}
-
-static uint32_t
-set_stat_tx_bits(uint32_t epr, uint32_t bits)
+calc_epr_bits(uint32_t epr, uint32_t mask, uint32_t value)
 {
-    return ((epr & (EPR_RWBITS | USB_EPTX_STAT)) ^ bits) | EPR_RWCBITS;
+    uint32_t tmask = mask & EPR_TBITS, tvalue = value & tmask;
+    uint32_t rwmask = mask & EPR_RWBITS, rwbits = value & rwmask;
+    uint32_t cbits = EPR_RWCBITS & ~mask;
+    return (((epr & (EPR_RWBITS | tmask)) ^ tvalue) & ~rwmask) | rwbits | cbits;
 }
 
-static uint32_t
-set_stat_rxtx_bits(uint32_t epr, uint32_t bits)
+// Check if double buffering endpoint hardware can no longer send/receive
+static int
+epr_is_dbuf_blocking(uint32_t epr)
 {
-    uint32_t mask = EPR_RWBITS | USB_EPRX_STAT | USB_EPTX_STAT;
-    return ((epr & mask) ^ bits) | EPR_RWCBITS;
+    return !(((epr >> (USB_EP_DTOG_RX_Pos - USB_EP_DTOG_TX_Pos)) ^ epr)
+             & USB_EP_DTOG_TX);
 }
 
 
@@ -202,39 +216,77 @@
  * USB interface
  ****************************************************************/
 
+static uint32_t bulk_out_pop_count, bulk_out_push_flag;
+
 int_fast8_t
 usb_read_bulk_out(void *data, uint_fast8_t max_len)
 {
-    uint32_t epr = USB_EPR[USB_CDC_EP_BULK_OUT];
-    if ((epr & USB_EPRX_STAT) == USB_EP_RX_VALID)
+    if (readl(&bulk_out_push_flag))
         // No data ready
         return -1;
-    uint32_t count = btable_read_packet(USB_CDC_EP_BULK_OUT, data, max_len);
-    USB_EPR[USB_CDC_EP_BULK_OUT] = set_stat_rx_bits(epr, USB_EP_RX_VALID);
+    uint32_t ep = USB_CDC_EP_BULK_OUT;
+    int bufnum = bulk_out_pop_count & 1;
+    bulk_out_pop_count++;
+    uint32_t count = btable_read_packet(ep, bufnum, data, max_len);
+    writel(&bulk_out_push_flag, USB_EP_DTOG_TX);
+
+    // Check if irq handler pulled another packet before push flag update
+    uint32_t epr = USB_EPR[ep];
+    if (epr_is_dbuf_blocking(epr) && readl(&bulk_out_push_flag)) {
+        // Second packet was already read - must notify hardware
+        writel(&bulk_out_push_flag, 0);
+        USB_EPR[ep] = calc_epr_bits(epr, 0, 0) | USB_EP_DTOG_TX;
+    }
+
     return count;
 }
 
+static uint32_t bulk_in_push_pos, bulk_in_pop_flag;
+#define BI_START 2
+
 int_fast8_t
 usb_send_bulk_in(void *data, uint_fast8_t len)
 {
-    uint32_t epr = USB_EPR[USB_CDC_EP_BULK_IN];
-    if ((epr & USB_EPTX_STAT) != USB_EP_TX_NAK)
+    if (readl(&bulk_in_pop_flag))
         // No buffer space available
         return -1;
-    btable_write_packet(USB_CDC_EP_BULK_IN, data, len);
-    USB_EPR[USB_CDC_EP_BULK_IN] = set_stat_tx_bits(epr, USB_EP_TX_VALID);
+    uint32_t ep = USB_CDC_EP_BULK_IN;
+    uint32_t bipp = bulk_in_push_pos, bufnum = bipp & 1;
+    bulk_in_push_pos = bipp ^ 1;
+    btable_write_packet(ep, bufnum, data, len);
+    writel(&bulk_in_pop_flag, USB_EP_DTOG_RX);
+
+    // Check if hardware needs to be notified
+    uint32_t epr = USB_EPR[ep];
+    if (epr_is_dbuf_blocking(epr) && readl(&bulk_in_pop_flag)) {
+        writel(&bulk_in_pop_flag, 0);
+        if (unlikely(bipp & BI_START)) {
+            // Two packets are always sent when starting in double
+            // buffering mode, so wait for second packet before starting.
+            if (bipp == (BI_START | 1)) {
+                bulk_in_push_pos = 0;
+                writel(&bulk_in_pop_flag, USB_EP_KIND); // Dummy flag
+                USB_EPR[ep] = calc_epr_bits(epr, USB_EPTX_STAT
+                                            , USB_EP_TX_VALID);
+            }
+        } else {
+            USB_EPR[ep] = calc_epr_bits(epr, 0, 0) | USB_EP_DTOG_RX;
+        }
+    }
+
     return len;
 }
 
 int_fast8_t
 usb_read_ep0(void *data, uint_fast8_t max_len)
 {
-    uint32_t epr = USB_EPR[0];
+    uint32_t ep = 0, epr = USB_EPR[ep];
     if ((epr & USB_EPRX_STAT) != USB_EP_RX_NAK)
         // No data ready
         return -1;
-    uint32_t count = btable_read_packet(0, data, max_len);
-    USB_EPR[0] = set_stat_rxtx_bits(epr, USB_EP_RX_VALID | USB_EP_TX_NAK);
+    uint32_t count = btable_read_packet(ep, BUFRX, data, max_len);
+    USB_EPR[ep] = calc_epr_bits(epr, USB_EPRX_STAT | USB_EPTX_STAT
+                                , USB_EP_RX_VALID | USB_EP_TX_NAK);
     return count;
 }
 
@@ -247,23 +299,24 @@
 int_fast8_t
 usb_send_ep0(const void *data, uint_fast8_t len)
 {
-    uint32_t epr = USB_EPR[0];
+    uint32_t ep = 0, epr = USB_EPR[ep];
     if ((epr & USB_EPRX_STAT) != USB_EP_RX_VALID)
         // Transfer interrupted
         return -2;
     if ((epr & USB_EPTX_STAT) != USB_EP_TX_NAK)
         // No buffer space available
         return -1;
-    btable_write_packet(0, data, len);
-    USB_EPR[0] = set_stat_tx_bits(epr, USB_EP_TX_VALID);
+    btable_write_packet(ep, BUFTX, data, len);
+    USB_EPR[ep] = calc_epr_bits(epr, USB_EPTX_STAT, USB_EP_TX_VALID);
     return len;
 }
 
 void
 usb_stall_ep0(void)
 {
-    USB_EPR[0] = set_stat_rxtx_bits(USB_EPR[0]
-                                    , USB_EP_RX_STALL | USB_EP_TX_STALL);
+    uint32_t ep = 0, epr = USB_EPR[ep];
+    USB_EPR[ep] = calc_epr_bits(epr, USB_EPRX_STAT | USB_EPTX_STAT
+                                , USB_EP_RX_STALL | USB_EP_TX_STALL);
 }
 
 static uint8_t set_address;
@@ -278,6 +331,13 @@
 void
 usb_set_configure(void)
 {
+    uint32_t ep = USB_CDC_EP_BULK_OUT;
+    bulk_out_pop_count = 0;
+    USB_EPR[ep] = calc_epr_bits(USB_EPR[ep], USB_EPRX_STAT, USB_EP_RX_VALID);
+
+    ep = USB_CDC_EP_BULK_IN;
+    bulk_in_push_pos = BI_START;
+    writel(&bulk_in_pop_flag, 0);
 }
 
 
@@ -289,13 +349,22 @@
 static void
 usb_reset(void)
 {
-    USB_EPR[0] = 0 | USB_EP_CONTROL | USB_EP_RX_VALID | USB_EP_TX_NAK;
-    USB_EPR[USB_CDC_EP_ACM] = (USB_CDC_EP_ACM | USB_EP_INTERRUPT
-                               | USB_EP_RX_NAK | USB_EP_TX_NAK);
-    USB_EPR[USB_CDC_EP_BULK_OUT] = (USB_CDC_EP_BULK_OUT | USB_EP_BULK
-                                    | USB_EP_RX_VALID | USB_EP_TX_NAK);
-    USB_EPR[USB_CDC_EP_BULK_IN] = (USB_CDC_EP_BULK_IN | USB_EP_BULK
-                                   | USB_EP_RX_NAK | USB_EP_TX_NAK);
+    uint32_t ep = 0;
+    USB_EPR[ep] = 0 | USB_EP_CONTROL | USB_EP_RX_VALID | USB_EP_TX_NAK;
+
+    ep = USB_CDC_EP_ACM;
+    USB_EPR[ep] = (USB_CDC_EP_ACM | USB_EP_INTERRUPT
+                   | USB_EP_RX_NAK | USB_EP_TX_NAK);
+
+    ep = USB_CDC_EP_BULK_OUT;
+    USB_EPR[ep] = (USB_CDC_EP_BULK_OUT | USB_EP_BULK | USB_EP_KIND
+                   | USB_EP_RX_NAK | USB_EP_DTOG_TX);
+    bulk_out_push_flag = USB_EP_DTOG_TX;
+
+    ep = USB_CDC_EP_BULK_IN;
+    USB_EPR[ep] = (USB_CDC_EP_BULK_IN | USB_EP_BULK | USB_EP_KIND
+                   | USB_EP_TX_NAK);
+    bulk_in_pop_flag = USB_EP_DTOG_RX;
 
     USB->CNTR = USB_CNTR_CTRM | USB_CNTR_RESETM;
     USB->DADDR = USB_DADDR_EF;
@@ -308,20 +377,25 @@
     uint32_t istr = USB->ISTR;
     if (istr & USB_ISTR_CTR) {
         // Endpoint activity
-        uint32_t ep = istr & USB_ISTR_EP_ID;
-        uint32_t epr = USB_EPR[ep];
-        USB_EPR[ep] = epr & EPR_RWBITS;
-        if (ep == 0) {
+        uint32_t ep = istr & USB_ISTR_EP_ID, epr = USB_EPR[ep];
+        if (ep == USB_CDC_EP_BULK_OUT) {
+            USB_EPR[ep] = (calc_epr_bits(epr, USB_EP_CTR_RX | USB_EP_CTR_TX, 0)
+                           | bulk_out_push_flag);
+            bulk_out_push_flag = 0;
+            usb_notify_bulk_out();
+        } else if (ep == USB_CDC_EP_BULK_IN) {
+            USB_EPR[ep] = (calc_epr_bits(epr, USB_EP_CTR_RX | USB_EP_CTR_TX, 0)
+                           | bulk_in_pop_flag);
+            bulk_in_pop_flag = 0;
+            usb_notify_bulk_in();
+        } else if (ep == 0) {
+            USB_EPR[ep] = calc_epr_bits(epr, USB_EP_CTR_RX | USB_EP_CTR_TX, 0);
             usb_notify_ep0();
             if (epr & USB_EP_CTR_TX && set_address) {
                 // Apply address after last "in" message transmitted
                 USB->DADDR = set_address;
                 set_address = 0;
             }
-        } else if (ep == USB_CDC_EP_BULK_OUT) {
-            usb_notify_bulk_out();
-        } else if (ep == USB_CDC_EP_BULK_IN) {
-            usb_notify_bulk_in();
         }
     }
     if (istr & USB_ISTR_RESET) {
diff -urN /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/usbotg.c /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/usbotg.c
--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/home/mks/CanBoot/src/stm32/usbotg.c	2023-08-12 06:18:51.936709110 -0400
+++ /home/mks/firmware_comparison/downloads/CanBoot/src/stm32/usbotg.c	2024-10-08 17:45:28.589223696 -0400
@@ -397,11 +397,11 @@
     }
     if (sts & USB_OTG_GINTSTS_IEPINT) {
         // Can transmit data - disable irq and notify endpoint
-        uint32_t daint = OTGD->DAINT;
-        OTGD->DAINTMSK &= ~daint;
-        if (daint & (1 << 0))
+        uint32_t daint = OTGD->DAINT, msk = OTGD->DAINTMSK, pend = daint & msk;
+        OTGD->DAINTMSK = msk & ~daint;
+        if (pend & (1 << 0))
             usb_notify_ep0();
-        if (daint & (1 << USB_CDC_EP_BULK_IN))
+        if (pend & (1 << USB_CDC_EP_BULK_IN))
             usb_notify_bulk_in();
     }
 }
@@ -426,7 +426,7 @@
     OTG->GUSBCFG = (USB_OTG_GUSBCFG_FDMOD | USB_OTG_GUSBCFG_PHYSEL
                     | (6 << USB_OTG_GUSBCFG_TRDT_Pos));
     OTGD->DCFG |= (3 << USB_OTG_DCFG_DSPD_Pos);
-#if CONFIG_MACH_STM32F446 || CONFIG_MACH_STM32H7
+#if CONFIG_MACH_STM32F446 || CONFIG_MACH_STM32H7 || CONFIG_MACH_STM32F7
     OTG->GOTGCTL = USB_OTG_GOTGCTL_BVALOEN | USB_OTG_GOTGCTL_BVALOVAL;
 #else
     OTG->GCCFG |= USB_OTG_GCCFG_NOVBUSSENS;
