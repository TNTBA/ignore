--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/var/lib/dpkg/info/sudo.prerm	2021-01-20 07:26:17.000000000 -0500
+++ /media/mks/armbi_root/var/lib/dpkg/info/sudo.prerm	2023-06-27 07:45:00.000000000 -0400
@@ -10,6 +10,12 @@
 	passwd1=$(echo "$passwd" |cut -c1)
 	# Note: we do need the 'xfoo' syntax here, since POSIX special-cases
 	# the $passwd value '!' as negation.
+	# bug #1001858 causes trouble here. In autopkgtest, the system
+	# might be switching back and forth between sudo and sudo-ldap
+	# without having a root password set. 
+	# autopkgtest environment is not under our control, so we cannot
+	# disable this test just for autopkgtest (it's autopkgtest itself
+	# installing packages).
 	if [ "x$passwd" = "x*" ] || [ "x$passwd1" = "x!" ]; then
 	    # yup, password is locked
 	    echo "You have asked that the sudo package be removed,"
@@ -39,9 +45,9 @@
 		;;
 esac
 
-# Automatically added by dh_installinit/12.1.1
-if [ -x "/etc/init.d/sudo" ] && [ "$1" = remove ]; then
-	invoke-rc.d sudo stop || exit 1
+# Automatically added by dh_installinit/13.11.4
+if [ -z "${DPKG_ROOT:-}" ] && [ "$1" = remove ] && [ -x "/etc/init.d/sudo" ] ; then
+	invoke-rc.d --skip-systemd-native sudo stop || exit 1
 fi
 # End automatically added section
 
