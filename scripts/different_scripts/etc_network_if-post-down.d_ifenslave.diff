--- /media/mks/5dcae443-0796-4029-ae6c-bf5bd2a37067/etc/network/if-post-down.d/ifenslave	2016-09-27 08:23:58.000000000 -0400
+++ /media/mks/armbi_root/etc/network/if-post-down.d/ifenslave	2021-10-17 00:02:24.000000000 -0400
@@ -20,8 +20,8 @@
 {
 	# Called with:
 	# $1 = target filename
-	read values < "/sys/class/net/$IFACE/bonding/$1"
-	for value in $values ; do 
+	read -r values < "/sys/class/net/$IFACE/bonding/$1"
+	for value in $values ; do
 		echo "-$value" > "/sys/class/net/$IFACE/bonding/$1"
 	done
 }
@@ -35,7 +35,8 @@
 	# The first slave in bond-primary found in current slaves becomes the primary.
 	# If no slave in bond-primary is found, then the primary does not change and might be undefined if just removed.
 	for slave in $IF_BOND_PRIMARY ; do
-		if grep -sq "\\<$slave\\>" "/sys/class/net/$IFACE/master/bonding/slaves" ; then
+		slaves="/sys/class/net/$IFACE/master/bonding/slaves"
+		if grep -sq "\\<$slave\\>" "$slaves" ; then
 			sysfs primary "$slave"
 			break
 		fi
@@ -52,13 +53,16 @@
 # Remove any slaves of $IFACE.
 
 [ "$VERBOSITY" = 1 ] && v=-v
-read slaves < "$BOND_PARAMS/slaves"
+read -r slaves < "$BOND_PARAMS/slaves"
 for slave in $slaves ; do
 	# This is supposed to have the side effect of freeing the interface.
-	ifquery --state $slave && ifdown $v $slave
+	ifquery --state "$slave" >/dev/null 2>&1 && ifdown $v "$slave"
 
 	# Anyway, ensure $slave is free.
 	if [ -f "/sys/class/net/$slave/master/bonding/slaves" ] ; then
 		echo "-$slave" > "$BOND_PARAMS/slaves" 2> /dev/null
 	fi
 done
+
+# Delete the bond interface
+ip link del dev "$IFACE"
